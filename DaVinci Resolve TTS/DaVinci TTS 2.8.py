infomsg_cn = """
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            color: #ffffff;
            padding: 20px;
        }
        h3 {
            font-weight: bold;
            font-size: 1.5em;
            margin-top: 15px;
            margin-bottom: 0px; /* è°ƒæ•´æ­¤å¤„ä»¥å‡å°‘é—´éš” */
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 5px;
            color: #c7a364; /* é»„è‰² */
        }
        p {
            font-size: 1.2em;
            margin-top: 5px;
            margin-bottom: 20px; /* è°ƒæ•´æ­¤å¤„ä»¥å‡å°‘é—´éš” */
            color: #a3a3a3; /* ç™½è‰² */
        }
        a {
            color: #1e90ff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h3>æ›´æ–°[2.8] 2025-03-16</h3>
    
        <li>-å¾®è½¯è¯­éŸ³</li>
        <ul>
            <li>æ–°å¢13ç§HDé«˜æ¸…è¯­éŸ³</li> 
        </ul>
        <li>-æµ·èºè¯­éŸ³</li>
        <ul>
            <li>æ–°å¢è¯­ç§é€‰é¡¹ï¼Œå¢å¼ºå¯¹æŒ‡å®šçš„å°è¯­ç§å’Œæ–¹è¨€çš„è¯†åˆ«èƒ½åŠ›ï¼</li> 
            <li>æ–°å¢å­—å¹•åŠŸèƒ½ï¼Œç”ŸæˆéŸ³é¢‘æ–‡ä»¶å¯¹åº”çš„æ—¶é—´æˆ³å­—å¹•ï¼</li> 
        </ul>
        
    <h3>æ›´æ–°[2.7] 2025-01-18</h3>
    
        <li>-æ–°å¢MiniMax è¯­éŸ³æ¨¡å‹ï¼</li>
        <ul>
            <li>æ”¯æŒ100+ç³»ç»ŸéŸ³è‰²è‡ªä¸»é€‰æ‹©ï¼›</li> 
            <li>æ”¯æŒéŸ³é‡ã€è¯­è°ƒã€è¯­é€Ÿã€è¾“å‡ºæ ¼å¼è°ƒæ•´ï¼›</li>    
            <li>æ”¯æŒå›ºå®šé—´éš”æ—¶é—´æ§åˆ¶ï¼›</li>   
            <li>æ”¯æŒé¢„è§ˆéŸ³è‰²ï¼›</li>  
        </ul>
        
    <h3>æ›´æ–°[2.6] 2025-01-16</h3>
    
        <li>-ä¿®å¤Windowç³»ç»Ÿä¿å­˜æ–‡ä»¶å‡ºé”™é—®é¢˜ï¼</li>

    <h3>æ›´æ–°[2.5] 2024-10-21</h3>
    
        <li>-æ–°å¢æœ€æ–°çš„HDé«˜æ¸…è¯­éŸ³æ¨¡å‹ï¼</li>
        <li>-ä¿®å¤ä½¿ç”¨ä¸¢å¸§æ—¶é—´ç æ— æ³•åŠ è½½éŸ³é¢‘é—®é¢˜ï¼</li>
    <h3>æ›´æ–°[2.4] 2024-09-21</h3>
        <li>-ä¿®å¤é”®ç›˜ä¸Šä¸‹é”®è°ƒæ•´å‚æ•°å¡æ­»é—®é¢˜ï¼</li>
        
    <h3>æ–°å¢åŠŸèƒ½ 2024-08-13</h3>
    
        <li>-æ— éœ€API KEYï¼Œå…è´¹ä½¿ç”¨è¶…è¿‡300+ç§è¯­éŸ³å’Œ100+ç§è¯­è¨€ï¼</li>
        <li>-ä¿®å¤è¯­éŸ³åç§°æ˜¾ç¤ºé—®é¢˜</li>
        <li>-æ–°å¢åŠŸèƒ½ï¼š</li>
        <ul>
            <li>åŠ è½½éŸ³é¢‘åˆ°æ—¶é—´çº¿ï¼šåˆæˆéŸ³é¢‘åè‡ªåŠ¨åŠ è½½åˆ°æ—¶é—´çº¿ã€‚</li> 
            <li>æœ—è¯»å½“å‰å­—å¹•ï¼šåˆæˆå¹¶åŠ è½½æ’­æ”¾å¤´ä½ç½®çš„å­—å¹•å—ã€‚</li>    

        </ul>

    <h3>æ–°å¢åŠŸèƒ½ 2024-07-10</h3>
    
        <li>-å…¨æ–°UIè®¾è®¡ï¼Œæ›´å¤§çš„å­—å¹•è¾“å…¥æ¡†ä»¥åŠå­—ä½“</li>
        <li>-æ–°å¢è‡ªå®šä¹‰åŠŸèƒ½ï¼š</li>
        <ul>
            <li>å‘éŸ³ï¼šæ›´æ”¹æ–‡å­—çš„å‘éŸ³ï¼</li>
            <li>æ–‡ç¨¿çŸ«æ­£ï¼šä½¿ç”¨è¾“å…¥æ¡†çš„æ–‡æœ¬å¯¹ç”Ÿæˆçš„å­—å¹•ä¸€é”®ä¿®æ­£ï¼</li>       
        </ul>

    <h3>æ–°å¢åŠŸèƒ½ 2024-07-01</h3>
    
        <li>-å¯ç”¨APIï¼šéœ€è¦å¡«å…¥Azure APIï¼Œèƒ½å¤Ÿä½“éªŒåˆ°è½¯ä»¶çš„å®Œæ•´åŠŸèƒ½ï¼</li>
        <li>-åœç”¨APIï¼šä¸éœ€è¦å¡«å…¥Azure APIï¼Œä½†æŸäº›åŠŸèƒ½å°†è¢«æš‚åœä½¿ç”¨ï¼</li>
        <li>-æ–°å¢æ›´å¤šè‡ªå®šä¹‰åŠŸèƒ½ï¼š</li>
        <ul>
            <li>åœé¡¿ï¼šæ’å…¥æœ—è¯»åœé¡¿ã€‚</li>
            <li>è¯­é€Ÿï¼šè°ƒæ•´è¯´è¯è¯­é€Ÿã€‚</li>
            <li>éŸ³é«˜ï¼šè°ƒæ•´å£°éŸ³çš„é«˜ä½ã€‚</li>
            <li>éŸ³é‡ï¼šè°ƒæ•´éŸ³é‡çš„å¤§å°ã€‚</li>  
            <li>è¯­è¨€æŠ€èƒ½ï¼šä½¿ç”¨Multilingualäººç‰©æ—¶ï¼Œå¯åˆ‡æ¢ä¸ºå…¶ä»–è¯­è¨€ã€‚</li>             
        </ul>


    <h3>ä»‹ç»</h3>
    <p>æ­¤è„šæœ¬ä½¿ç”¨Azureçš„TTSåŠŸèƒ½å°†æ–‡å­—è½¬æ¢ä¸ºè¯­éŸ³ã€‚</p>

    <h3>ä¿å­˜è·¯å¾„</h3>
    <p>æŒ‡å®šç”Ÿæˆæ–‡ä»¶çš„ä¿å­˜è·¯å¾„ã€‚</p>

    <h3>åŒºåŸŸã€APIå¯†é’¥</h3>
    <p>ä»<a href="https://speech.microsoft.com/">Microsoft Speech Studio</a>è·å–æ‚¨çš„APIå¯†é’¥ã€‚</p>
</body>
</html>

"""
infomsg_en = """
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            font-family: Arial, sans-serif;
            color: #ffffff;
            padding: 20px;
        }
        h3 {
            font-weight: bold;
            font-size: 1.5em;
            margin-top: 15px;
            margin-bottom: 0px; /* Adjust spacing */
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 5px;
            color: #c7a364; /* Yellow */
        }
        p {
            font-size: 1.2em;
            margin-top: 5px;
            margin-bottom: 20px; /* Adjust spacing */
            color: #a3a3a3; /* White */
        }
        a {
            color: #1e90ff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h3>Update [2.8] 2025-03-16</h3>
        <li>-Microsoft TTS</li>
        <ul>
            <li>Added 13 new HD voices.</li>
        </ul>
        <li>-Minimax TTS</li>
        <ul>
            <li>Introduced new language options, improving recognition of specific lesser-known languages and dialects.</li>
            <li>Added a subtitle generation feature, allowing the creation of subtitles with timestamps for audio files.</li>
        </ul>
    <h3>Update [2.7 beta] 2025-01-18</h3>
    
        <li>- Added MiniMax voice model!</li>
        <ul>
            <li>Supports 100+ system voice options;</li> 
            <li>Supports volume, pitch, speech rate, and output format adjustments;</li>    
            <li>Supports fixed interval time control;</li>   
            <li>Supports voice preview;</li>  
        </ul>
        
    <h3>Update [2.6] 2025-01-16</h3>
    
        <li>- Fixed file saving issue on Windows systems!</li>

    <h3>Update [2.5] 2024-10-21</h3>
    
        <li>- Added the latest HD high-definition voice model!</li>
        <li>- Fixed an issue where audio could not be loaded when using dropped frame timecodes!</li>
    
    <h3>Update [2.4] 2024-09-21</h3>
        <li>- Fixed an issue where adjusting parameters with the keyboard up and down keys would freeze!</li>
        
    <h3>New Features 2024-08-13</h3>
    
        <li>- No API KEY required, free access to over 300+ voices and 100+ languages!</li>
        <li>- Fixed an issue with voice name display.</li>
        <li>- New Features:</li>
        <ul>
            <li>Load audio to the timeline: Automatically load synthesized audio into the timeline.</li> 
            <li>Read current subtitle: Synthesize and load the subtitle block at the playhead position.</li>    
        </ul>

    <h3>New Features 2024-07-10</h3>
    
        <li>- Brand new UI design with a larger subtitle input box and font size.</li>
        <li>- Added customization features:</li>
        <ul>
            <li>Pronunciation: Modify the pronunciation of text!</li>
            <li>Transcript correction: Use text from the input box to correct generated subtitles with one click!</li>       
        </ul>

    <h3>New Features 2024-07-01</h3>
    
        <li>- Enable API: Requires Azure API key to experience the full functionality of the software.</li>
        <li>- Disable API: No need for an Azure API key, but some features will be temporarily unavailable.</li>
        <li>- Added more customization features:</li>
        <ul>
            <li>Pause: Insert reading pauses.</li>
            <li>Speech rate: Adjust the speaking speed.</li>
            <li>Pitch: Adjust the pitch of the voice.</li>
            <li>Volume: Adjust the volume level.</li>  
            <li>Language Skills: When using Multilingual voices, switch to other languages.</li>             
        </ul>

    <h3>Introduction</h3>
    <p>This script uses Azure's TTS feature to convert text to speech.</p>

    <h3>Save Path</h3>
    <p>Specifies the save path for the generated files.</p>

    <h3>Region, API Key</h3>
    <p>Obtain your API key from <a href="https://speech.microsoft.com/">Microsoft Speech Studio</a>.</p>
</body>
</html>
"""
import platform
from xml.dom import minidom
import xml.etree.ElementTree as ET
import sys
import os
import requests
import time
import webbrowser
import re
import wave
import subprocess
import json
import edge_tts
import azure.cognitiveservices.speech as speechsdk
try:
    import DaVinciResolveScript as dvr_script
    from python_get_resolve import GetResolve
    print("DaVinciResolveScript from Python")
except ImportError:
    
    if platform.system() == "Darwin": 
        resolve_script_path1 = "/Library/Application Support/Blackmagic Design/DaVinci Resolve/Developer/Scripting/Examples"
        resolve_script_path2 = "/Library/Application Support/Blackmagic Design/DaVinci Resolve/Developer/Scripting/Modules"
    elif platform.system() == "Windows": 
        resolve_script_path1 = os.path.join(os.environ['PROGRAMDATA'], "Blackmagic Design", "DaVinci Resolve", "Support", "Developer", "Scripting", "Examples")
        resolve_script_path2 = os.path.join(os.environ['PROGRAMDATA'], "Blackmagic Design", "DaVinci Resolve", "Support", "Developer", "Scripting", "Modules")
    else:
        raise EnvironmentError("Unsupported operating system")

    sys.path.append(resolve_script_path1)
    sys.path.append(resolve_script_path2)

    try:
        import DaVinciResolveScript as dvr_script
        from python_get_resolve import GetResolve
        print("DaVinciResolveScript from DaVinci")
    except ImportError as e:
        raise ImportError("Unable to import DaVinciResolveScript or python_get_resolve after adding paths") from e

class STATUS_MESSAGES:
    synthesis_failed    = ("Synthesis failed!", "åˆæˆå¤±è´¥ï¼")
    loaded_to_timeline  = ("Successfully loaded to timeline!", "æˆåŠŸåŠ è½½åˆ°æ—¶é—´çº¿ï¼")
    synthesizing        = ("Synthesizing...", "åˆæˆä¸­...")
    media_clip_exists   = ("The media pool already contains this clip.", "åª’ä½“æ± å·²å­˜åœ¨è¯¥ç‰‡æ®µ")
    playing             = ("Playing...", "æ’­æ”¾ä¸­...")
    audio_save_failed   = ("Failed to save audio file.", "éŸ³é¢‘æ–‡ä»¶ä¿å­˜å¤±è´¥")
    # æ–°å¢çŠ¶æ€ä¿¡æ¯
    enter_api_key       = ("Enter API key in the configuration panel.", "å‰å¾€é…ç½®æ å¡«å†™APIå¯†é’¥.")
    download_json       = ("Move minimax_voice_data.json to the plugin directory.", "è¯·ä¸‹è½½minimax_voice_data.jsonæ–‡ä»¶åˆ°æ’ä»¶ç›®å½•")
    download_pcm        = ("Move minimax_voice_data.pcm to the plugin directory.", "è¯·ä¸‹è½½minimax_voice_data.pcmæ–‡ä»¶åˆ°æ’ä»¶ç›®å½•")
    select_save_path    = ("Select a save path in the configuration panel.", "å‰å¾€é…ç½®æ é€‰æ‹©ä¿å­˜è·¯å¾„.")
    unsupported_audio   = ("Unsupported audio format selected.", "ä¸æ”¯æŒçš„éŸ³é¢‘æ ¼å¼.")
    create_timeline     = ("Please create a timeline first!", "è¯·å…ˆåˆ›å»ºæ—¶é—´çº¿ï¼")
    reset_status        = ("", "")

def check_or_create_file(file_path):
    if os.path.exists(file_path):
        pass
    else:
        try:
            with open(file_path, 'w') as file:
                json.dump({}, file)  
        except IOError:
            raise Exception(f"Cannot create file: {file_path}")

def get_script_path():
    if len(sys.argv) > 0:
        return os.path.dirname(os.path.abspath(sys.argv[0]))
    else:
        return os.getcwd()

script_path = get_script_path()

settings_file = os.path.join(script_path, 'TTS_settings.json')

check_or_create_file(settings_file)

def load_settings(settings_file):
    if os.path.exists(settings_file):
        with open(settings_file, 'r') as file:
            content = file.read()
            if content:
                try:
                    settings = json.loads(content)
                    return settings
                except json.JSONDecodeError as err:
                    print('Error decoding settings:', err)
                    return None
    return None

def save_settings(settings, settings_file):
    with open(settings_file, 'w') as file:
        content = json.dumps(settings, indent=4)
        file.write(content)

saved_settings = load_settings(settings_file) 

default_settings = {
    "UNUSE_API":False,
    "API_KEY": '',
    "OUTPUT_DIRECTORY": '',
    "REGION": '',
    "LANGUAGE": 0,
    "TYPE": 0,
    "NAME": 0,
    "RATE": 1.0,
    "PITCH": 1.0,
    "VOLUME": 1.0,
    "STYLE": 0,
    "BREAKTIME":50,
    "STYLEDEGREE": 1.0,
    "OUTPUT_FORMATS":2,

    "minimax_API_KEY": "",
    "minimax_GROUP_ID": "",
    "minimax_intlCheckBox":False,
    "Path": "",
    "minimax_Model": 0,
    #"Text": "",
    "minimax_Voice": 0,
    "minimax_Language": 0,
    "minimax_SubtitleCheckBox":False,
    "minimax_Emotion": 0,
    "minimax_Rate": 1.0,
    "minimax_Volume": 1.0,
    "minimax_Pitch": 0,
    "minimax_Format": "mp3",
    "minimax_Break":50,

    "CN":True,
    "EN":False,


}

current_manager = resolve.GetProjectManager()
current_project = current_manager.GetCurrentProject()
current_timeline = current_project.GetCurrentTimeline()

def get_first_empty_track(timeline, start_frame, end_frame, media_type):
    """è·å–å½“å‰æ’­æ”¾å¤´ä½ç½®çš„ç¬¬ä¸€ä¸ªç©ºè½¨é“ç´¢å¼•"""
    track_index = 1
    while True:
        items = timeline.GetItemListInTrack(media_type, track_index)
        if not items:
            return track_index
        
        # æ£€æŸ¥è½¨é“ä¸Šæ˜¯å¦æœ‰ç‰‡æ®µä¸ç»™å®šçš„start_frameå’Œend_frameé‡å 
        is_empty = True
        for item in items:
            if item.GetStart() <= end_frame and start_frame <= item.GetEnd():
                is_empty = False
                break
        
        if is_empty:
            return track_index
        
        track_index += 1

def add_to_media_pool_and_timeline(start_frame, end_frame, filename):
    project_manager = resolve.GetProjectManager()
    current_project = project_manager.GetCurrentProject()
    media_pool = current_project.GetMediaPool()
    root_folder = media_pool.GetRootFolder()
    tts_folder = None

    # æŸ¥æ‰¾æˆ–åˆ›å»º"TTS"æ–‡ä»¶å¤¹
    folders = root_folder.GetSubFolderList()
    for folder in folders:
        if folder.GetName() == "TTS":
            tts_folder = folder
            break

    if not tts_folder:
        tts_folder = media_pool.AddSubFolder(root_folder, "TTS")

    if tts_folder:
        print(f"TTS folder is available: {tts_folder.GetName()}")
    else:
        print("Failed to create or find TTS folder.")
        return False

    # åŠ è½½éŸ³é¢‘åˆ°åª’ä½“æ± 
    media_pool.SetCurrentFolder(tts_folder)
    imported_items = media_pool.ImportMedia([filename])
    
    if not imported_items:
        print(f"Failed to import media: {filename}")
        return False

    selected_clip = imported_items[0]
    print(f"Imported clip: {selected_clip.GetName()}")

    # è·å–å½“å‰æ—¶é—´çº¿
    current_timeline = current_project.GetCurrentTimeline()
    frame_rate = float(current_timeline.GetSetting("timelineFrameRate"))
    clip_duration_frames = timecode_to_frames(selected_clip.GetClipProperty("Duration"), frame_rate)

    # æŸ¥æ‰¾å½“å‰æ’­æ”¾å¤´ä½ç½®çš„ç¬¬ä¸€ä¸ªç©ºè½¨é“
    track_index = get_first_empty_track(current_timeline, start_frame, end_frame, "audio")

    # åˆ›å»ºclipInfoå­—å…¸
    clip_info = {
        "mediaPoolItem": selected_clip,
        "startFrame": 0,
        "endFrame": clip_duration_frames - 1,
        "trackIndex": track_index,
        "recordFrame": start_frame,  # åœ¨å­—å¹•çš„èµ·å§‹ä½ç½®æ·»åŠ 
        "stereoEye": "both"  # è®¾ç½®ä¸ºç«‹ä½“å£°
    }

    # å°†å‰ªè¾‘æ·»åŠ åˆ°æ—¶é—´çº¿
    timeline_item = media_pool.AppendToTimeline([clip_info])
    if timeline_item:
        print(f"Appended clip: {selected_clip.GetName()} to timeline at frame {start_frame} on track {track_index}.")
        update_status(STATUS_MESSAGES.loaded_to_timeline)
    else:
        print("Failed to append clip to timeline.")

ui = fusion.UIManager
dispatcher = bmd.UIDispatcher(ui)
screen_width = 1920
screen_height = 1080
window_width = 800
window_height = 400
x_center = (screen_width - window_width) // 2
y_center = (screen_height - window_height) // 2
win = dispatcher.AddWindow({
    "ID": "MainWin", 
    "WindowTitle": "DaVinci TTS 2.8", 
    "Geometry": [x_center, y_center, window_width, window_height],
    "Spacing": 10,
    "StyleSheet": """
        * {
            font-size: 14px; /* å…¨å±€å­—ä½“å¤§å° */
        }
    """
    },
    [
        ui.VGroup([
            ui.TabBar({"Weight": 0.0, "ID": "MyTabs"}), 
            ui.Stack({"Weight": 1.0, "ID": "MyStack"}, [
                ui.VGroup({"ID": "Tab1", "Weight": 1}, [
                    ui.HGroup({"Weight": 0.7}, [
                        ui.VGroup({"Weight": 1}, [
                            ui.TextEdit({"ID": "AzureTxt", "Text": "","PlaceholderText": "", "Weight": 0.9, "Font": ui.Font({"PixelSize": 15})}),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Button({"ID": "GetSubButton", "Text": "ä»æ—¶é—´çº¿è·å–å­—å¹•", "Weight": 0.7}),
                                ui.SpinBox({"ID": "BreakSpinBox", "Value": 50, "Minimum": 0, "Maximum": 5000, "SingleStep": 50, "Weight": 0.1}),
                                ui.Label({"ID": "BreakLabel", "Text": "ms", "Weight": 0.1}),
                                ui.Button({"ID": "BreakButton", "Text": "åœé¡¿", "Weight": 0.1}),
                                
                            ])
                        ]),
                        ui.VGroup({"Weight": 0.1}, [
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Button({"ID": "AlphabetButton", "Text": "å‘éŸ³", "Weight": 1}),
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "LanguageLabel", "Text": "è¯­è¨€", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.ComboBox({"ID": "LanguageCombo", "Text": "", "Weight": 0.8}),
                                ui.Label({"ID": "NameTypeLabel", "Text": "ç±»å‹", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.ComboBox({"ID": "NameTypeCombo", "Text": "", "Weight": 0.8})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "NameLabel", "Text": "åç§°", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.ComboBox({"ID": "NameCombo", "Text": "", "Weight": 0.8}),
                                ui.Label({"ID": "MultilingualLabel", "Text": "è¯­è¨€æŠ€èƒ½", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.ComboBox({"ID": "MultilingualCombo", "Text": "", "Weight": 0.2})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "StyleLabel", "Text": "é£æ ¼", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.ComboBox({"ID": "StyleCombo", "Text": "", "Weight": 0.8})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "StyleDegreeLabel", "Text": "é£æ ¼å¼ºåº¦", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.Slider({"ID": "StyleDegreeSlider", "Value": 100, "Minimum": 0, "Maximum": 200, "Orientation": "Horizontal", "Weight": 0.5}),
                                ui.DoubleSpinBox({"ID": "StyleDegreeSpinBox", "Value": 1.0, "Minimum": 0.0, "Maximum": 2.0, "SingleStep": 0.01, "Weight": 0.3})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "RateLabel", "Text": "è¯­é€Ÿ", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.Slider({"ID": "RateSlider", "Value": 100, "Minimum": 0, "Maximum": 300, "Orientation": "Horizontal", "Weight": 0.5}),
                                ui.DoubleSpinBox({"ID": "RateSpinBox", "Value": 1.0, "Minimum": 0.0, "Maximum": 3.0, "SingleStep": 0.01, "Weight": 0.3})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "PitchLabel", "Text": "éŸ³é«˜", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.Slider({"ID": "PitchSlider", "Value": 100, "Minimum": 50, "Maximum": 150, "Orientation": "Horizontal", "Weight": 0.5}),
                                ui.DoubleSpinBox({"ID": "PitchSpinBox", "Value": 1.0, "Minimum": 0.5, "Maximum": 1.5, "SingleStep": 0.01, "Weight": 0.3})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "VolumeLabel", "Text": "éŸ³é‡", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.Slider({"ID": "VolumeSlider", "Value": 100, "Minimum": 0, "Maximum": 150, "Orientation": "Horizontal", "Weight": 0.5}),
                                ui.DoubleSpinBox({"ID": "VolumeSpinBox", "Value": 1.0, "Minimum": 0, "Maximum": 1.5, "SingleStep": 0.01, "Weight": 0.3})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "OutputFormatLabel", "Text": "è¾“å‡ºæ ¼å¼", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                                ui.ComboBox({"ID": "OutputFormatCombo", "Text": "Output_Format", "Weight": 0.8})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Button({"ID": "PlayButton", "Text": "æ’­æ”¾é¢„è§ˆ"}),
                                ui.Button({"ID": "FromSubButton", "Text": "æœ—è¯»å½“å‰å­—å¹•"}),
                                ui.Button({"ID": "FromTxtButton", "Text": "æœ—è¯»æ–‡æœ¬æ¡†"}),
                                ui.Button({"ID": "ResetButton", "Text": "é‡ç½®"})
                            ]),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Label({"ID": "StatusLabel", "Text": " ", "Alignment": {"AlignHCenter": True, "AlignVCenter": True}})
                            ])
                        ])
                    ])
                ]),
                ui.VGroup({"ID": "Tab2", "Weight": 1}, [
                    ui.HGroup({"Weight": 0.7}, [
                        ui.VGroup({"Weight": 0.5}, [
                            ui.TextEdit({"ID": "minimaxText", "PlaceholderText": ""}),
                            ui.HGroup({"Weight": 0.1}, [
                                ui.Button({"ID": "minimaxGetSubButton", "Text": "ä»æ—¶é—´çº¿è·å–å­—å¹•", "Weight": 0.7}),
                                ui.SpinBox({"ID": "minimaxBreakSpinBox", "Value": 50, "Minimum": 1, "Maximum": 9999, "SingleStep": 50, "Weight": 0.1}),
                                ui.Label({"ID": "minimaxBreakLabel", "Text": "ms", "Weight": 0.1}),
                                ui.Button({"ID": "minimaxBreakButton", "Text": "åœé¡¿", "Weight": 0.1})
                            ])
                        ]),
                        ui.VGroup({"Weight": 0.5}, [
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxModelLabel","Text": "æ¨¡å‹:", "Weight": 0}),
                                ui.ComboBox({"ID": "minimaxModelCombo", "Text": "é€‰æ‹©æ¨¡å‹"}),
                                ui.Label({"ID": "minimaxLanguageLabel","Text": "è¯­è¨€:", "Weight": 0}),
                                ui.ComboBox({"ID": "minimaxLanguageCombo", "Text": "é€‰æ‹©è¯­è¨€"})
                            ]),
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxVoiceLabel","Text": "äººå£°:", "Weight": 0}),
                                ui.ComboBox({"ID": "minimaxVoiceCombo", "Text": "é€‰æ‹©äººå£°"}),
                                ui.Button({"ID": "minimaxPreviewButton", "Text": "è¯•å¬"}),
                            ]),
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxEmotionLabel","Text": "æƒ…ç»ª:", "Weight": 0}),
                                ui.ComboBox({"ID": "minimaxEmotionCombo", "Text": "é€‰æ‹©æƒ…ç»ª"})
                            ]),
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxRateLabel","Text": "é€Ÿåº¦:", "Weight": 0.2}),
                                ui.Slider({"ID": "minimaxRateSlider", "Minimum": 50, "Maximum": 200, "Value": 100, "SingleStep": 1, "Weight": 0.6}),
                                ui.DoubleSpinBox({"ID": "minimaxRateSpinBox", "Minimum": 0.50, "Maximum": 2.00, "Value": 1.00, "SingleStep": 0.01, "Decimals": 2, "Weight": 0.2})
                            ]),
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxVolumeLabel","Text": "éŸ³é‡:", "Weight": 0.2}),
                                ui.Slider({"ID": "minimaxVolumeSlider", "Minimum": 10, "Maximum": 1000, "Value": 100, "SingleStep": 1, "Weight": 0.6}),
                                ui.DoubleSpinBox({"ID": "minimaxVolumeSpinBox", "Minimum": 0.10, "Maximum": 10.00, "Value": 1.00, "SingleStep": 0.01, "Decimals": 2, "Weight": 0.2})
                            ]),
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxPitchLabel","Text": "éŸ³è°ƒ:", "Weight": 0.2}),
                                ui.Slider({"ID": "minimaxPitchSlider", "Minimum": -1200, "Maximum": 1200, "SingleStep": 1, "Weight": 0.6}),
                                ui.SpinBox({"ID": "minimaxPitchSpinBox", "Minimum": -12, "Maximum": 12, "Value": 0, "SingleStep": 1, "Weight": 0.2})
                            ]),
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxFormatLabel","Text": "æ ¼å¼:", "Weight": 0}),
                                ui.ComboBox({"ID": "minimaxFormatCombo", "Text": "é€‰æ‹©æ ¼å¼"}),
                                ui.CheckBox({"ID": "minimaxSubtitleCheckBox", "Text": "ç”Ÿæˆå­—å¹•", "Checked": False, "Alignment": {"AlignLeft": True}, "Weight": 0.1}),
                            ]),
                            ui.HGroup({}, [
                                ui.Button({"ID": "minimaxFromSubButton", "Text": "æœ—è¯»å½“å‰å­—å¹•"}),
                                ui.Button({"ID": "minimaxFromTxtButton", "Text": "æœ—è¯»æ–‡æœ¬æ¡†"}),
                                ui.Button({"ID": "minimaxResetButton", "Text": "é‡ç½®"})
                            ]),
                            ui.HGroup({}, [
                                ui.Label({"ID": "minimaxStatusLabel", "Text": " ", "Alignment": {"AlignHCenter": True, "AlignVCenter": True}})
                            ])
                        ])
                    ])
                ]),
                ui.HGroup({"ID": "Tab3", "Weight": 1}, [
                    ui.VGroup({"Weight": 0.5, "Spacing": 10}, [
                        ui.HGroup({"Weight": 1}, [
                            ui.TextEdit({"ID": "infoTxt", "Text": infomsg_cn, "ReadOnly": True, "Font": ui.Font({"PixelSize": 14})})
                        ])
                    ]),
                    ui.VGroup({"Weight": 0.5, "Spacing": 10,}, [
                        ui.HGroup({"Weight": 0.1}, [
                            ui.Label({"ID": "PathLabel", "Text": "ä¿å­˜è·¯å¾„", "Alignment": {"AlignLeft": True}, "Weight": 0.2}),
                            ui.LineEdit({"ID": "Path", "Text": "", "PlaceholderText": "", "ReadOnly": False, "Weight": 0.6}),
                            ui.Button({"ID": "Browse", "Text": "æµè§ˆ", "Weight": 0.2}),
                        ]),
                        
                        ui.HGroup({"Weight": 0.1}, [
                            ui.Label({"Text": "Azure API", "Alignment": {"AlignLeft": True}, "Weight": 0.1}),
                            ui.Button({"ID": "ShowAzure", "Text": "é…ç½®","Weight": 0.1,}),
                            #ui.CheckBox({"ID": "UnuseAPICheckBox", "Text": "åœç”¨ API", "Checked": False, "Alignment": {"AlignLeft": True}, "Weight": 0.1})
                        ]),
                        ui.HGroup({"Weight": 0.1}, [
                            ui.Label({"Text": "MiniMax API", "Alignment": {"AlignLeft": True}, "Weight": 0.1}),
                            ui.Button({"ID": "ShowMiniMax", "Text": "é…ç½®","Weight": 0.1}),
                            
                        ]),
                        ui.HGroup({"Weight": 0.1}, [
                            ui.CheckBox({"ID": "LangEnCheckBox", "Text": "EN", "Checked": True, "Alignment": {"AlignRight": True}, "Weight": 0}),
                            ui.CheckBox({"ID": "LangCnCheckBox", "Text": "ç®€ä½“ä¸­æ–‡", "Checked": False, "Alignment": {"AlignRight": True}, "Weight": 1}),
                        ]),
                        ui.Button({
                            "ID": "OpenLinkButton", 
                            "Text": "å…³æ³¨å…¬ä¼—å·ï¼šæ¸¸è‰ºæ‰€\n\n>>>ç‚¹å‡»æŸ¥çœ‹æ›´å¤šä¿¡æ¯<<<\n\nÂ© 2024, Copyright by HB.",
                            "Alignment": {"AlignHCenter": True, "AlignVCenter": True},
                            "Font": ui.Font({"PixelSize": 12, "StyleName": "Bold"}),
                            "Flat": True,
                            "TextColor": [0.1, 0.3, 0.9, 1],
                            "BackgroundColor": [1, 1, 1, 0],
                            "Weight": 0.8
                        })
                    ])
                ])
            ])
        ])
    ]
)

# é…ç½®çª—å£1
azure_config_window = dispatcher.AddWindow(
    {
        "ID": "AzureConfigWin",
        "WindowTitle": "Azure API",
        "Geometry": [900, 400, 400, 200],
        "Hidden": True,
        "StyleSheet": """
        * {
            font-size: 14px; /* å…¨å±€å­—ä½“å¤§å° */
        }
    """
    },
    [
        ui.VGroup(
            [
                ui.Label({"ID": "AzureLabel","Text": "å¡«å†™Azure APIä¿¡æ¯", "Alignment": {"AlignHCenter": True, "AlignVCenter": True}}),
                ui.HGroup({"Weight": 1}, [
                    ui.Label({"ID": "RegionLabel", "Text": "åŒºåŸŸ", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                    ui.LineEdit({"ID": "Region", "Text": "", "Weight": 0.8}),
                ]),
                ui.HGroup({"Weight": 1}, [
                    ui.Label({"ID": "ApiKeyLabel", "Text": "å¯†é’¥", "Alignment": {"AlignRight": False}, "Weight": 0.2}),
                    ui.LineEdit({"ID": "ApiKey", "Text": "", "EchoMode": "Password", "Weight": 0.8}),
                    
                ]),
                ui.CheckBox({"ID": "UnuseAPICheckBox", "Text": "åœç”¨ API", "Checked": False, "Alignment": {"AlignLeft": True}, "Weight": 0.1}),
                ui.HGroup({"Weight": 1}, [
                    ui.Button({"ID": "AzureConfirm", "Text": "ç¡®å®š","Weight": 1}),
                    ui.Button({"ID": "AzureRegisterButton", "Text": "æ³¨å†Œ","Weight": 1}),
                ]),
                
            ]
        )
    ]
)

# é…ç½®çª—å£2
minimax_config_window = dispatcher.AddWindow(
    {
        "ID": "MiniMaxConfigWin",
        "WindowTitle": "MiniMax API",
        "Geometry": [900, 400, 400, 200],
        "Hidden": True,
        "StyleSheet": """
        * {
            font-size: 14px; /* å…¨å±€å­—ä½“å¤§å° */
        }
    """
    },
    [
        ui.VGroup(
            [
                ui.Label({"ID": "minimaxLabel","Text": "å¡«å†™MiniMax APIä¿¡æ¯", "Alignment": {"AlignHCenter": True, "AlignVCenter": True}}),
                ui.HGroup({"Weight": 1}, [
                    ui.Label({"Text": "GroupID", "Weight": 0.2}),
                    ui.LineEdit({"ID": "minimaxGroupID", "Weight": 0.8}),
                ]),
                ui.HGroup({"Weight": 1}, [
                    ui.Label({"ID": "minimaxApiKeyLabel","Text": "å¯†é’¥", "Weight": 0.2}),
                    ui.LineEdit({"ID": "minimaxApiKey", "EchoMode": "Password", "Weight": 0.8})
                ]),
                ui.CheckBox({"ID": "intlCheckBox", "Text": "æµ·å¤–", "Checked": False, "Alignment": {"AlignLeft": True}, "Weight": 0.1}),
                ui.HGroup({"Weight": 1}, [
                    ui.Button({"ID": "MiniMaxConfirm", "Text": "ç¡®å®š","Weight": 1}),
                    ui.Button({"ID": "minimaxRegisterButton", "Text": "æ³¨å†Œ","Weight": 1}),
                ]),
                
            ]
        )
    ]
)
translations = {
    "cn": {
        "Tabs": ["å¾®è½¯è¯­éŸ³", "æµ·èºè¯­éŸ³", "é…ç½®"],
        "GetSubButton": "ä»æ—¶é—´çº¿è·å–å­—å¹•",
        "minimaxGetSubButton": "ä»æ—¶é—´çº¿è·å–å­—å¹•",
        "BreakLabel": "ms",
        "minimaxBreakLabel": "ms",
        "BreakButton": "åœé¡¿",
        "minimaxBreakButton": "åœé¡¿",
        "AlphabetButton": "å‘éŸ³",
        "minimaxModelLabel": "æ¨¡å‹",
        "minimaxLanguageLabel": "è¯­è¨€",
        "minimaxVoiceLabel": "äººå£°",
        "minimaxPreviewButton":"è¯•å¬",
        "LanguageLabel": "è¯­è¨€",
        "NameTypeLabel": "ç±»å‹",
        "NameLabel": "åç§°",
        "MultilingualLabel": "è¯­è¨€æŠ€èƒ½",
        "StyleLabel": "é£æ ¼",
        "minimaxEmotionLabel": "æƒ…ç»ª",
        "StyleDegreeLabel": "é£æ ¼å¼ºåº¦",
        "RateLabel": "è¯­é€Ÿ",
        "minimaxRateLabel": "è¯­é€Ÿ",
        "PitchLabel": "éŸ³è°ƒ",
        "minimaxPitchLabel": "éŸ³è°ƒ",
        "VolumeLabel": "éŸ³é‡",
        "minimaxVolumeLabel": "éŸ³é‡",
        "OutputFormatLabel": "æ ¼å¼",
        "minimaxFormatLabel": "æ ¼å¼",
        "PlayButton": "æ’­æ”¾é¢„è§ˆ",
        "FromSubButton": "æœ—è¯»å½“å‰å­—å¹•",
        "minimaxFromSubButton": "æœ—è¯»å½“å‰å­—å¹•",
        "FromTxtButton": "æœ—è¯»æ–‡æœ¬æ¡†",
        "minimaxFromTxtButton": "æœ—è¯»æ–‡æœ¬æ¡†",
        "ResetButton": "é‡ç½®",
        "minimaxResetButton": "é‡ç½®",
        "PathLabel":"ä¿å­˜è·¯å¾„",
        "Browse":"æµè§ˆ", 
        "ShowAzure":"é…ç½®",
        "ShowMiniMax": "é…ç½®",
        "OpenLinkButton":"å…³æ³¨å…¬ä¼—å·ï¼šæ¸¸è‰ºæ‰€\n\n>>>ç‚¹å‡»æŸ¥çœ‹æ›´å¤šä¿¡æ¯<<<\n\nÂ© 2025, Copyright by HB.",
        "infoTxt":infomsg_cn,
        "AzureLabel":"å¡«å†™Azure APIä¿¡æ¯",
        "RegionLabel":"åŒºåŸŸ",
        "ApiKeyLabel":"å¯†é’¥",
        "UnuseAPICheckBox":"åœç”¨ API",
        "minimaxSubtitleCheckBox":"ç”Ÿæˆå­—å¹•",
        "AzureConfirm":"ç¡®å®š",
        "AzureRegisterButton":"æ³¨å†Œ",
        "minimaxLabel":"å¡«å†™MiniMax APIä¿¡æ¯",
        "minimaxApiKeyLabel":"å¯†é’¥",
        "intlCheckBox": "æµ·å¤–",
        "MiniMaxConfirm":"ç¡®å®š",
        "minimaxRegisterButton":"æ³¨å†Œ",
    },

    "en": {
        "Tabs": ["Azure TTS", "MiniMax TTS", "Configuration"],
        "GetSubButton": "Timeline Subs",
        "minimaxGetSubButton": "Timeline Subs",
        "BreakLabel": "ms",
        "minimaxBreakLabel": "ms",
        "BreakButton": "Break",
        "minimaxBreakButton": "Break",
        "AlphabetButton": "Pronunciation",
        "minimaxModelLabel": "Model",
        "minimaxLanguageLabel": "Language",
        "minimaxVoiceLabel": "Voice",
        "minimaxPreviewButton":"Preview",
        "LanguageLabel": "Language",
        "NameTypeLabel": "Type",
        "NameLabel": "Name",
        "MultilingualLabel": "Multilingual",
        "StyleLabel": "Style",
        "minimaxEmotionLabel": "Emotion",
        "StyleDegreeLabel": "Style Degree",
        "RateLabel": "Rate",
        "minimaxRateLabel": "Rate",
        "PitchLabel": "Pitch",
        "minimaxPitchLabel": "Pitch",
        "VolumeLabel": "Volume",
        "minimaxVolumeLabel": "Volume",
        "OutputFormatLabel": "Format",
        "minimaxFormatLabel": "Format",
        "PlayButton": "Preview",
        "FromSubButton": "Read Subs",
        "minimaxFromSubButton": "Read Subs",
        "FromTxtButton": "Read Textbox",
        "minimaxFromTxtButton": "Read Textbox",
        "ResetButton": "Reset",
        "minimaxResetButton": "Reset",
        "PathLabel":"Path",
        "Browse":"Browse", 
        "ShowAzure":"Config",
        "ShowMiniMax": "Config",
        "OpenLinkButton":"ğŸ˜ŠBuy Me A CoffeğŸ˜Š\n\nÂ© 2025, Copyright by HB.",
        "infoTxt":infomsg_en,
        "AzureLabel":"Azure API",
        "RegionLabel":"Region",
        "ApiKeyLabel":"Key",
        "UnuseAPICheckBox":"Unuse API",
        "minimaxSubtitleCheckBox":"Subtitle Enable",
        "AzureConfirm":"OK",
        "AzureRegisterButton":"Register",
        "minimaxLabel":"MiniMax API",
        "minimaxApiKeyLabel":"Key",
        "intlCheckBox": "intl",
        "MiniMaxConfirm":"OK",
        "minimaxRegisterButton":"Register",
    }
}
items = win.GetItems()
azure_items = azure_config_window.GetItems()
minimax_items = minimax_config_window.GetItems()
items["StatusLabel"].Text = ""
items["MyStack"].CurrentIndex = 0

for tab_name in translations["cn"]["Tabs"]:
    items["MyTabs"].AddTab(tab_name)

def toggle_api_checkboxes(unuse_api_checked):
    azure_items["ApiKey"].Enabled = unuse_api_checked
    azure_items["Region"].Enabled = unuse_api_checked
    items["StyleCombo"].Enabled = unuse_api_checked
    items["MultilingualCombo"].Enabled = unuse_api_checked
    items["PlayButton"].Enabled = unuse_api_checked
    items["BreakButton"].Enabled = unuse_api_checked
    items["AlphabetButton"].Enabled = unuse_api_checked
    items["StyleDegreeSpinBox"].Enabled = unuse_api_checked
    items["StyleDegreeSlider"].Enabled = unuse_api_checked
    items["OutputFormatCombo"].Enabled = unuse_api_checked
    print("Using API" if unuse_api_checked else "Not Using API")


subtitle = ""
lang = ""
multilingual='Default'
ssml = ''
flag = True
voice_name = ""
style = None
rate = None
pitch = None
volume = None
style_degree = None
stream = None

# å¡«å……ComboBox
models = ["speech-01-turbo", "speech-01-240228","speech-01-turbo-240228","speech-01-hd"]
for model in models:
    items["minimaxModelCombo"].AddItem(model)

minimax_voices = [
    ("é’æ¶©é’å¹´", "male-qn-qingse"),
    ("ç²¾è‹±é’å¹´", "male-qn-jingying"),
    ("éœ¸é“é’å¹´", "male-qn-badao"),
    ("é’å¹´å¤§å­¦ç”Ÿ", "male-qn-daxuesheng"),
    ("å°‘å¥³", "female-shaonv"),
    ("å¾¡å§", "female-yujie"),
    ("æˆç†Ÿå¥³æ€§", "female-chengshu"),
    ("ç”œç¾å¥³æ€§", "female-tianmei"),
    ("ç”·æ€§ä¸»æŒäºº", "presenter_male"),
    ("å¥³æ€§ä¸»æŒäºº", "presenter_female"),
    ("ç”·æ€§æœ‰å£°ä¹¦1", "audiobook_male_1"),
    ("ç”·æ€§æœ‰å£°ä¹¦2", "audiobook_male_2"),
    ("å¥³æ€§æœ‰å£°ä¹¦1", "audiobook_female_1"),
    ("å¥³æ€§æœ‰å£°ä¹¦2", "audiobook_female_2"),
    ("é’æ¶©é’å¹´-beta", "male-qn-qingse-jingpin"),
    ("ç²¾è‹±é’å¹´-beta", "male-qn-jingying-jingpin"),
    ("éœ¸é“é’å¹´-beta", "male-qn-badao-jingpin"),
    ("é’å¹´å¤§å­¦ç”Ÿ-beta", "male-qn-daxuesheng-jingpin"),
    ("å°‘å¥³-beta", "female-shaonv-jingpin"),
    ("å¾¡å§-beta", "female-yujie-jingpin"),
    ("æˆç†Ÿå¥³æ€§-beta", "female-chengshu-jingpin"),
    ("ç”œç¾å¥³æ€§-beta", "female-tianmei-jingpin"),
    ("èªæ˜ç”·ç«¥", "clever_boy"),
    ("å¯çˆ±ç”·ç«¥", "cute_boy"),
    ("èŒèŒå¥³ç«¥", "lovely_girl"),
    ("å¡é€šçŒªå°çª", "cartoon_pig"),
    ("ç—…å¨‡å¼Ÿå¼Ÿ", "bingjiao_didi"),
    ("ä¿Šæœ—ç”·å‹", "junlang_nanyou"),
    ("çº¯çœŸå­¦å¼Ÿ", "chunzhen_xuedi"),
    ("å†·æ·¡å­¦é•¿", "lengdan_xiongzhang"),
    ("éœ¸é“å°‘çˆ·", "badao_shaoye"),
    ("ç”œå¿ƒå°ç²", "tianxin_xiaoling"),
    ("ä¿çš®èŒå¦¹", "qiaopi_mengmei"),
    ("å¦©åªšå¾¡å§", "wumei_yujie"),
    ("å—²å—²å­¦å¦¹", "diadia_xuemei"),
    ("æ·¡é›…å­¦å§", "danya_xuejie"),
    ("Santa Claus", "Santa_Claus"),
    ("Grinch", "Grinch"),
    ("Rudolph", "Rudolph"),
    ("Arnold", "Arnold"),
    ("Charming Santa", "Charming_Santa"),
    ("Charming Lady", "Charming_Lady"),
    ("Sweet Girl", "Sweet_Girl"),
    ("Cute Elf", "Cute_Elf"),
    ("Attractive Girl", "Attractive_Girl"),
    ("Serene Woman", "Serene_Woman"),
    # æµ·å¤–ä¸“ç”¨éŸ³è‰²
    ("Wise Womanï¼ˆæµ·å¤–ï¼‰", "Wise_Woman"),
    ("Friendly Personï¼ˆæµ·å¤–ï¼‰", "Friendly_Person"),
    ("Inspirational Girlï¼ˆæµ·å¤–ï¼‰", "Inspirational_girl"),
    ("Deep Voice Manï¼ˆæµ·å¤–ï¼‰", "Deep_Voice_Man"),
    ("Calm Womanï¼ˆæµ·å¤–ï¼‰", "Calm_Woman"),
    ("Casual Guyï¼ˆæµ·å¤–ï¼‰", "Casual_Guy"),
    ("Lively Girlï¼ˆæµ·å¤–ï¼‰", "Lively_Girl"),
    ("Patient Manï¼ˆæµ·å¤–ï¼‰", "Patient_Man"),
    ("Young Knightï¼ˆæµ·å¤–ï¼‰", "Young_Knight"),
    ("Determined Manï¼ˆæµ·å¤–ï¼‰", "Determined_Man"),
    ("Lovely Girlï¼ˆæµ·å¤–ï¼‰", "Lovely_Girl"),
    ("Decent Boyï¼ˆæµ·å¤–ï¼‰", "Decent_Boy"),
    ("Imposing Mannerï¼ˆæµ·å¤–ï¼‰", "Imposing_Manner"),
    ("Elegant Manï¼ˆæµ·å¤–ï¼‰", "Elegant_Man"),
    ("Abbessï¼ˆæµ·å¤–ï¼‰", "Abbess"),
    ("Sweet Girl 2ï¼ˆæµ·å¤–ï¼‰", "Sweet_Girl_2"),
    ("Exuberant Girlï¼ˆæµ·å¤–ï¼‰", "Exuberant_Girl"),
]
minimax_language = [
    ("è‡ªåŠ¨", "auto"),
    ("ä¸­æ–‡", "Chinese"),
    ("ç²¤è¯­", "Chinese,Yue"),
    ("è‹±è¯­", "English"),
    ("é˜¿æ‹‰ä¼¯è¯­", "Arabic"),
    ("ä¿„è¯­", "Russian"),
    ("è¥¿ç­ç‰™è¯­", "Spanish"),
    ("æ³•è¯­", "French"),
    ("è‘¡è„ç‰™è¯­", "Portuguese"),
    ("å¾·è¯­", "German"),
    ("åœŸè€³å…¶è¯­", "Turkish"),
    ("è·å…°è¯­", "Dutch"),
    ("ä¹Œå…‹å…°è¯­", "Ukrainian"),
    ("è¶Šå—è¯­", "Vietnamese"),
    ("å°å°¼è¯­", "Indonesian"),
    ("æ—¥è¯­", "Japanese"),
    ("æ„å¤§åˆ©è¯­", "Italian"),
    ("éŸ©è¯­", "Korean"),

]
# å°†å£°éŸ³é€‰é¡¹æ·»åŠ åˆ° minimaxVoiceCombo
for cn, en in minimax_voices:
    if items["LangEnCheckBox"].Checked:
        items["minimaxVoiceCombo"].AddItem(en)  # é€‰ä¸­æ—¶æ·»åŠ è‹±æ–‡
    else:
        items["minimaxVoiceCombo"].AddItem(cn)  # æœªé€‰ä¸­æ—¶æ·»åŠ ä¸­æ–‡
   

# å°†è¯­è¨€é€‰é¡¹æ·»åŠ åˆ° minimaxLanguageCombo
for cn, en in minimax_language:
    if items["LangEnCheckBox"].Checked:
        items["minimaxLanguageCombo"].AddItem(en)  
    else:
        items["minimaxLanguageCombo"].AddItem(cn)  
   
# å®šä¹‰æƒ…ç»ªé€‰é¡¹
emotions = [
    ("é»˜è®¤", "Default"),
    ("é«˜å…´", "happy"),
    ("æ‚²ä¼¤", "sad"),
    ("æ„¤æ€’", "angry"),
    ("å®³æ€•", "fearful"),
    ("åŒæ¶", "disgusted"),
    ("æƒŠè®¶", "surprised"),
    ("ä¸­æ€§", "neutral")
]


# å°†æƒ…ç»ªé€‰é¡¹æ·»åŠ åˆ° minimaxEmotionCombo
for cn, en in emotions:
    if items["LangEnCheckBox"].Checked:
        items["minimaxEmotionCombo"].AddItem(en)  # é€‰ä¸­æ—¶æ·»åŠ è‹±æ–‡
    else:
        items["minimaxEmotionCombo"].AddItem(cn)  # æœªé€‰ä¸­æ—¶æ·»åŠ ä¸­æ–‡

# å¡«å……æ ¼å¼é€‰é¡¹
items["minimaxFormatCombo"].AddItem("mp3")
items["minimaxFormatCombo"].AddItem("wav")
#items["minimaxFormatCombo"].AddItem("pcm")

# æ¨¡å‹é€‰é¡¹åˆ‡æ¢é€»è¾‘
def on_model_combo_changed(event):
    selected_model = items["minimaxModelCombo"].CurrentText
    if selected_model not in ["speech-01-turbo", "speech-01-hd"]:
        items["minimaxEmotionCombo"].CurrentIndex = 0
        items["minimaxEmotionCombo"].Enabled = False  # å¯ç”¨æƒ…ç»ªé€‰æ‹©
    else:
        items["minimaxEmotionCombo"].Enabled = True  # ç¦ç”¨æƒ…ç»ªé€‰æ‹©

# ç»‘å®šäº‹ä»¶
win.On["minimaxModelCombo"].CurrentIndexChanged = on_model_combo_changed

# åœ¨å¯åŠ¨æ—¶æ£€æŸ¥æ¨¡å‹çŠ¶æ€
on_model_combo_changed({"Index": items["minimaxModelCombo"].CurrentIndex})

voices = {
    "zh-CN": {
        "language": "Chinese (æ™®é€šè¯)",
        "voices": [
            {
                "zh-CN-XiaoxiaoNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ™“",
                    "Styles": [
                        "assistant",
                        "chat",
                        "customerservice",
                        "newscast",
                        "affectionate",
                        "angry",
                        "calm",
                        "cheerful",
                        "disgruntled",
                        "fearful",
                        "gentle",
                        "lyrical",
                        "sad",
                        "serious",
                        "poetry-reading",
                        "friendly",
                        "chat-casual",
                        "whispering",
                        "sorry",
                        "excited"
                    ]
                }
            },
            {
                "zh-CN-XiaoxiaoDialectsNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ™“ æ–¹è¨€",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-XiaoxiaoMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ™“ å¤šè¯­è¨€",
                    "Styles": [
                        "affectionate",
                        "cheerful",
                        "empathetic",
                        "excited",
                        "poetry-reading",
                        "sorry",
                        "story"
                    ]
                }
            },
            {
                "zh-CN-Xiaoxiao:DragonHDFlashLatestNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ™“ HD Flash",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-Xiaoxiao2:DragonHDFlashLatestNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ™“2 HD Flash",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-YunxiNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å¸Œ",
                    "Styles": [
                        "narration-relaxed",
                        "embarrassed",
                        "fearful",
                        "cheerful",
                        "disgruntled",
                        "serious",
                        "angry",
                        "sad",
                        "depressed",
                        "chat",
                        "assistant",
                        "newscast"
                    ]
                }
            },
            {
                "zh-CN-YunjianNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å¥",
                    "Styles": [
                        "narration-relaxed",
                        "sports-commentary",
                        "sports-commentary-excited",
                        "angry",
                        "disgruntled",
                        "cheerful",
                        "sad",
                        "serious",
                        "depressed",
                        "documentary-narration"
                    ]
                }
            },
            {
                "zh-CN-XiaoyiNeural": {
                    "Gender": "Female",
                    "Name": "æ™“ä¼Š",
                    "Styles": [
                        "angry",
                        "disgruntled",
                        "affectionate",
                        "cheerful",
                        "fearful",
                        "sad",
                        "embarrassed",
                        "serious",
                        "gentle"
                    ]
                }
            },
            {
                "zh-CN-YunyangNeural": {
                    "Gender": "Male",
                    "Name": "äº‘æ‰¬",
                    "Styles": [
                        "customerservice",
                        "narration-professional",
                        "newscast-casual"
                    ]
                }
            },
            {
                "zh-CN-XiaochenNeural": {
                    "Gender": "Female",
                    "Name": "æ™“è¾°",
                    "Styles": [
                        "livecommercial"
                    ]
                }
            },
            {
                "zh-CN-XiaochenMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "æ™“è¾° å¤šè¯­è¨€",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-Xiaochen:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "æ™“è¾° HD",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-Xiaochen:DragonHDFlashLatestNeural": {
                    "Gender": "Female",
                    "Name": "æ™“è¾° HD Flash",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-XiaohanNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ¶µ",
                    "Styles": [
                        "calm",
                        "fearful",
                        "cheerful",
                        "disgruntled",
                        "serious",
                        "angry",
                        "sad",
                        "gentle",
                        "affectionate",
                        "embarrassed"
                    ]
                }
            },
            {
                "zh-CN-XiaomengNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ¢¦",
                    "Styles": [
                        "chat"
                    ]
                }
            },
            {
                "zh-CN-XiaomoNeural": {
                    "Gender": "Female",
                    "Name": "æ™“å¢¨",
                    "Styles": [
                        "embarrassed",
                        "calm",
                        "fearful",
                        "cheerful",
                        "disgruntled",
                        "serious",
                        "angry",
                        "sad",
                        "depressed",
                        "affectionate",
                        "gentle",
                        "envious"
                    ]
                }
            },
            {
                "zh-CN-XiaoqiuNeural": {
                    "Gender": "Female",
                    "Name": "æ™“ç§‹",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-XiaorouNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æŸ”",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-XiaoruiNeural": {
                    "Gender": "Female",
                    "Name": "æ™“ç¿",
                    "Styles": [
                        "calm",
                        "fearful",
                        "angry",
                        "sad"
                    ]
                }
            },
            {
                "zh-CN-XiaoshuangNeural": {
                    "Gender": "Female, Child",
                    "Name": "æ™“åŒ",
                    "Styles": [
                        "chat"
                    ]
                }
            },
            {
                "zh-CN-XiaoyanNeural": {
                    "Gender": "Female",
                    "Name": "æ™“é¢œ",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-XiaoyouNeural": {
                    "Gender": "Female, Child",
                    "Name": "æ™“æ‚ ",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-XiaozhenNeural": {
                    "Gender": "Female",
                    "Name": "æ™“ç”„",
                    "Styles": [
                        "angry",
                        "disgruntled",
                        "cheerful",
                        "fearful",
                        "sad",
                        "serious"
                    ]
                }
            },
            
            {
                "zh-CN-XiaoyuMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "æ™“å®‡ å¤šè¯­è¨€",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-YunfengNeural": {
                    "Gender": "Male",
                    "Name": "äº‘æ«",
                    "Styles": [
                        "angry",
                        "disgruntled",
                        "cheerful",
                        "fearful",
                        "sad",
                        "serious",
                        "depressed"
                    ]
                }
            },
            {
                "zh-CN-YunhaoNeural": {
                    "Gender": "Male",
                    "Name": "äº‘çš“",
                    "Styles": [
                        "advertisement-upbeat"
                    ]
                }
            },
            {
                "zh-CN-YunjieNeural": {
                    "Gender": "Male",
                    "Name": "äº‘æ°",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-YunxiaNeural": {
                    "Gender": "Male,Child",
                    "Name": "äº‘å¤",
                    "Styles": [
                        "calm",
                        "fearful",
                        "cheerful",
                        "angry",
                        "sad"
                    ]
                }
            },
            {
                "zh-CN-YunyeNeural": {
                    "Gender": "Male",
                    "Name": "äº‘é‡",
                    "Styles": [
                        "embarrassed",
                        "calm",
                        "fearful",
                        "cheerful",
                        "disgruntled",
                        "serious",
                        "angry",
                        "sad"
                    ]
                }
            },
            {
                "zh-CN-YunzeNeural": {
                    "Gender": "Male",
                    "Name": "äº‘æ³½",
                    "Styles": [
                        "calm",
                        "fearful",
                        "cheerful",
                        "disgruntled",
                        "serious",
                        "angry",
                        "sad",
                        "depressed",
                        "documentary-narration"
                    ]
                }
            },
            {
                "zh-CN-YunyiMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "äº‘é€¸ å¤šè¯­è¨€",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-Yunyi:DragonHDFlashLatestNeural": {
                    "Gender": "Male",
                    "Name": "äº‘é€¸ HD Flash",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-YunfanMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å‡¡ å¤šè¯­è¨€",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-Yunfan:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å‡¡ HD",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-YunxiaoMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "äº‘éœ„ å¤šè¯­è¨€",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-Yunxiao:DragonHDFlashLatestNeural": {
                    "Gender": "Male",
                    "Name": "äº‘éœ„ HD Flash",
                    "Styles": [
                        ""
                    ]
                }
            },
            
            
        ]
    },
    "yue-CN": {
        "language": "Chinese (ç²¤è¯­ï¼Œç®€ä½“)",
        "voices": [
            {
                "yue-CN-XiaoMinNeural": {
                    "Gender": "Female",
                    "Name": "æ™“æ•",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "yue-CN-YunSongNeural": {
                    "Gender": "Male",
                    "Name": "äº‘æ¾",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-HK": {
        "language": "Chinese (ç²¤è¯­ï¼Œç¹ä½“)",
        "voices": [
            {
                "zh-HK-HiuMaanNeural": {
                    "Gender": "Female",
                    "Name": "æ›‰æ›¼",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-HK-WanLungNeural": {
                    "Gender": "Male",
                    "Name": "é›²é¾",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-HK-HiuGaaiNeural": {
                    "Gender": "Female",
                    "Name": "æ›‰ä½³",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-TW": {
        "language": "Chinese (å°æ¹¾ï¼Œç¹ä½“)",
        "voices": [
            {
                "zh-TW-HsiaoChenNeural": {
                    "Gender": "Female",
                    "Name": "æ›‰è‡»",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-TW-YunJheNeural": {
                    "Gender": "Male",
                    "Name": "é›²å“²",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-TW-HsiaoYuNeural": {
                    "Gender": "Female",
                    "Name": "æ›‰é›¨",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-CN-guangxi": {
        "language": "Chinese (å¹¿è¥¿å£éŸ³æ™®é€šè¯ï¼Œç®€ä½“)",
        "voices": [
            {
                "zh-CN-guangxi-YunqiNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å¥‡ å¹¿è¥¿",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-CN-henan": {
        "language": "Chinese (ä¸­åŸå®˜è¯æ²³å—ï¼Œç®€ä½“)",
        "voices": [
            {
                "zh-CN-henan-YundengNeural": {
                    "Gender": "Male",
                    "Name": "äº‘ç™»",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-CN-liaoning": {
        "language": "Chinese (ä¸œåŒ—å®˜è¯ï¼Œç®€ä½“)",
        "voices": [
            {
                "zh-CN-liaoning-XiaobeiNeural": {
                    "Gender": "Female",
                    "Name": "æ™“åŒ— è¾½å®",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "zh-CN-liaoning-YunbiaoNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å½ª è¾½å®",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-CN-shaanxi": {
        "language": "Chinese (ä¸­åŸå®˜è¯é™•è¥¿ï¼Œç®€ä½“)",
        "voices": [
            {
                "zh-CN-shaanxi-XiaoniNeural": {
                    "Gender": "Female",
                    "Name": "æ™“å¦®",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-CN-shandong": {
        "language": "Chinese (å†€é²å®˜è¯ï¼Œç®€ä½“)",
        "voices": [
            {
                "zh-CN-shandong-YunxiangNeural": {
                    "Gender": "Male",
                    "Name": "äº‘ç¿”",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "zh-CN-sichuan": {
        "language": "Chinese (è¥¿å—å®˜è¯ï¼Œç®€ä½“)",
        "voices": [
            {
                "zh-CN-sichuan-YunxiNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å¸Œ å››å·",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "wuu-CN": {
        "language": "Chinese (å´è¯­ï¼Œç®€ä½“)",
        "voices": [
            {
                "wuu-CN-XiaotongNeural": {
                    "Gender": "Female",
                    "Name": "æ™“å½¤",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "wuu-CN-YunzheNeural": {
                    "Gender": "Male",
                    "Name": "äº‘å“²",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-AU": {
        "language": "English (Australia)",
        "voices": [
            {
                "en-AU-NatashaNeural": {
                    "Gender": "Female",
                    "Name": "Natasha",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-WilliamNeural": {
                    "Gender": "Male",
                    "Name": "William",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-AnnetteNeural": {
                    "Gender": "Female",
                    "Name": "Annette",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-CarlyNeural": {
                    "Gender": "Female",
                    "Name": "Carly",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-DarrenNeural": {
                    "Gender": "Male",
                    "Name": "Darren",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-DuncanNeural": {
                    "Gender": "Male",
                    "Name": "Duncan",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-ElsieNeural": {
                    "Gender": "Female",
                    "Name": "Elsie",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-FreyaNeural": {
                    "Gender": "Female",
                    "Name": "Freya",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-JoanneNeural": {
                    "Gender": "Female",
                    "Name": "Joanne",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-KenNeural": {
                    "Gender": "Male",
                    "Name": "Ken",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-KimNeural": {
                    "Gender": "Female",
                    "Name": "Kim",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-NeilNeural": {
                    "Gender": "Male",
                    "Name": "Neil",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-TimNeural": {
                    "Gender": "Male",
                    "Name": "Tim",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-AU-TinaNeural": {
                    "Gender": "Female",
                    "Name": "Tina",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-CA": {
        "language": "English (Canada)",
        "voices": [
            {
                "en-CA-ClaraNeural": {
                    "Gender": "Female",
                    "Name": "Clara",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-CA-LiamNeural": {
                    "Gender": "Male",
                    "Name": "Liam",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-GB": {
        "language": "English (United Kingdom)",
        "voices": [
            {
                "en-GB-SoniaNeural": {
                    "Gender": "Female",
                    "Name": "Sonia",
                    "Styles": [
                        "cheerful",
                        "sad"
                    ]
                }
            },
            {
                "en-GB-RyanNeural": {
                    "Gender": "Male",
                    "Name": "Ryan",
                    "Styles": [
                        "cheerful",
                        "chat",
                        "whispering",
                        "sad"
                    ]
                }
            },
            {
                "en-GB-LibbyNeural": {
                    "Gender": "Female",
                    "Name": "Libby",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-AdaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Ada Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-OllieMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Ollie Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-AbbiNeural": {
                    "Gender": "Female",
                    "Name": "Abbi",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-AlfieNeural": {
                    "Gender": "Male",
                    "Name": "Alfie",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-BellaNeural": {
                    "Gender": "Female",
                    "Name": "Bella",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-ElliotNeural": {
                    "Gender": "Male",
                    "Name": "Elliot",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-EthanNeural": {
                    "Gender": "Male",
                    "Name": "Ethan",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-HollieNeural": {
                    "Gender": "Female",
                    "Name": "Hollie",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-MaisieNeural": {
                    "Gender": "Female",
                    "Name": "Maisie",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-NoahNeural": {
                    "Gender": "Male",
                    "Name": "Noah",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-OliverNeural": {
                    "Gender": "Male",
                    "Name": "Oliver",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-OliviaNeural": {
                    "Gender": "Female",
                    "Name": "Olivia",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-ThomasNeural": {
                    "Gender": "Male",
                    "Name": "Thomas",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-GB-MiaNeural": {
                    "Gender": "Female",
                    "Name": "Mia",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-HK": {
        "language": "English (Hong Kong SAR)",
        "voices": [
            {
                "en-HK-YanNeural": {
                    "Gender": "Female",
                    "Name": "Yan",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-HK-SamNeural": {
                    "Gender": "Male",
                    "Name": "Sam",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-IE": {
        "language": "English (Ireland)",
        "voices": [
            {
                "en-IE-EmilyNeural": {
                    "Gender": "Female",
                    "Name": "Emily",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IE-ConnorNeural": {
                    "Gender": "Male",
                    "Name": "Connor",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-IN": {
        "language": "English (India)",
        "voices": [
            {
                "en-IN-AaravNeural": {
                    "Gender": "Male",
                    "Name": "Aarav",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-AashiNeural": {
                    "Gender": "Female",
                    "Name": "Aashi",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-AartiNeural": {
                    "Gender": "Female",
                    "Name": "Aarti",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-ArjunNeural": {
                    "Gender": "Male",
                    "Name": "Arjun",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-AnanyaNeural": {
                    "Gender": "Female",
                    "Name": "Ananya",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-KavyaNeural": {
                    "Gender": "Female",
                    "Name": "Kavya",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-KunalNeural": {
                    "Gender": "Male",
                    "Name": "Kunal",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-NeerjaNeural": {
                    "Gender": "Female",
                    "Name": "Neerja",
                    "Styles": [
                        "newscast",
                        "cheerful",
                        "empathetic"
                    ]
                }
            },
            {
                "en-IN-PrabhatNeural": {
                    "Gender": "Male",
                    "Name": "Prabhat",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-IN-RehaanNeural": {
                    "Gender": "Male",
                    "Name": "Rehaan",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-KE": {
        "language": "English (Kenya)",
        "voices": [
            {
                "en-KE-AsiliaNeural": {
                    "Gender": "Female",
                    "Name": "Asilia",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-KE-ChilembaNeural": {
                    "Gender": "Male",
                    "Name": "Chilemba",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-NG": {
        "language": "English (Nigeria)",
        "voices": [
            {
                "en-NG-EzinneNeural": {
                    "Gender": "Female",
                    "Name": "Ezinne",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-NG-AbeoNeural": {
                    "Gender": "Male",
                    "Name": "Abeo",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-NZ": {
        "language": "English (New Zealand)",
        "voices": [
            {
                "en-NZ-MollyNeural": {
                    "Gender": "Female",
                    "Name": "Molly",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-NZ-MitchellNeural": {
                    "Gender": "Male",
                    "Name": "Mitchell",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-PH": {
        "language": "English (Philippines)",
        "voices": [
            {
                "en-PH-RosaNeural": {
                    "Gender": "Female",
                    "Name": "Rosa",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-PH-JamesNeural": {
                    "Gender": "Male",
                    "Name": "James",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-SG": {
        "language": "English (Singapore)",
        "voices": [
            {
                "en-SG-LunaNeural": {
                    "Gender": "Female",
                    "Name": "Luna",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-SG-WayneNeural": {
                    "Gender": "Male",
                    "Name": "Wayne",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-TZ": {
        "language": "English (Tanzania)",
        "voices": [
            {
                "en-TZ-ImaniNeural": {
                    "Gender": "Female",
                    "Name": "Imani",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-TZ-ElimuNeural": {
                    "Gender": "Male",
                    "Name": "Elimu",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-US": {
        "language": "English (United States)",
        "voices": [
            {
                "en-US-AvaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Ava Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AndrewMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Andrew Multilingual",
                    "Styles": [
                        "empathetic",
                        "relieved"
                    ]
                }
            },
            {
                "en-US-EmmaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Emma Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AlloyTurboMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Alloy Turbo Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-EchoTurboMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Echo Turbo Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-FableTurboMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Fable Turbo Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-OnyxTurboMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Onyx Turbo Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-NovaTurboMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Nova Turbo Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-ShimmerTurboMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Shimmer Turbo Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-BrianMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Brian Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AvaNeural": {
                    "Gender": "Female",
                    "Name": "Ava",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AndrewNeural": {
                    "Gender": "Male",
                    "Name": "Andrew",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-EmmaNeural": {
                    "Gender": "Female",
                    "Name": "Emma",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-BrianNeural": {
                    "Gender": "Male",
                    "Name": "Brian",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-JennyNeural": {
                    "Gender": "Female",
                    "Name": "Jenny",
                    "Styles": [
                        "assistant",
                        "chat",
                        "customerservice",
                        "newscast",
                        "angry",
                        "cheerful",
                        "sad",
                        "excited",
                        "friendly",
                        "terrified",
                        "shouting",
                        "unfriendly",
                        "whispering",
                        "hopeful"
                    ]
                }
            },
            {
                "en-US-GuyNeural": {
                    "Gender": "Male",
                    "Name": "Guy",
                    "Styles": [
                        "newscast",
                        "angry",
                        "cheerful",
                        "sad",
                        "excited",
                        "friendly",
                        "terrified",
                        "shouting",
                        "unfriendly",
                        "whispering",
                        "hopeful"
                    ]
                }
            },
            {
                "en-US-AriaNeural": {
                    "Gender": "Female",
                    "Name": "Aria",
                    "Styles": [
                        "chat",
                        "customerservice",
                        "narration-professional",
                        "newscast-casual",
                        "newscast-formal",
                        "cheerful",
                        "empathetic",
                        "angry",
                        "sad",
                        "excited",
                        "friendly",
                        "terrified",
                        "shouting",
                        "unfriendly",
                        "whispering",
                        "hopeful"
                    ]
                }
            },
            {
                "en-US-DavisNeural": {
                    "Gender": "Male",
                    "Name": "Davis",
                    "Styles": [
                        "chat",
                        "angry",
                        "cheerful",
                        "excited",
                        "friendly",
                        "hopeful",
                        "sad",
                        "shouting",
                        "terrified",
                        "unfriendly",
                        "whispering"
                    ]
                }
            },
            {
                "en-US-JaneNeural": {
                    "Gender": "Female",
                    "Name": "Jane",
                    "Styles": [
                        "angry",
                        "cheerful",
                        "excited",
                        "friendly",
                        "hopeful",
                        "sad",
                        "shouting",
                        "terrified",
                        "unfriendly",
                        "whispering"
                    ]
                }
            },
            {
                "en-US-JasonNeural": {
                    "Gender": "Male",
                    "Name": "Jason",
                    "Styles": [
                        "angry",
                        "cheerful",
                        "excited",
                        "friendly",
                        "hopeful",
                        "sad",
                        "shouting",
                        "terrified",
                        "unfriendly",
                        "whispering"
                    ]
                }
            },
            {
                "en-US-KaiNeural": {
                    "Gender": "Male",
                    "Name": "Kai",
                    "Styles": [
                        "conversation"
                    ]
                }
            },
            {
                "en-US-LunaNeural": {
                    "Gender": "Female",
                    "Name": "Luna",
                    "Styles": [
                        "conversation"
                    ]
                }
            },
            {
                "en-US-SaraNeural": {
                    "Gender": "Female",
                    "Name": "Sara",
                    "Styles": [
                        "angry",
                        "cheerful",
                        "excited",
                        "friendly",
                        "hopeful",
                        "sad",
                        "shouting",
                        "terrified",
                        "unfriendly",
                        "whispering"
                    ]
                }
            },
            {
                "en-US-TonyNeural": {
                    "Gender": "Male",
                    "Name": "Tony",
                    "Styles": [
                        "angry",
                        "cheerful",
                        "excited",
                        "friendly",
                        "hopeful",
                        "sad",
                        "shouting",
                        "terrified",
                        "unfriendly",
                        "whispering"
                    ]
                }
            },
            {
                "en-US-NancyNeural": {
                    "Gender": "Female",
                    "Name": "Nancy",
                    "Styles": [
                        "angry",
                        "cheerful",
                        "excited",
                        "friendly",
                        "hopeful",
                        "sad",
                        "shouting",
                        "terrified",
                        "unfriendly",
                        "whispering"
                    ]
                }
            },
            {
                "en-US-CoraMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Cora Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-ChristopherMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Christopher Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-BrandonMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Brandon Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AmberNeural": {
                    "Gender": "Female",
                    "Name": "Amber",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AnaNeural": {
                    "Gender": "Female",
                    "Name": "Ana",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AshleyNeural": {
                    "Gender": "Female",
                    "Name": "Ashley",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-BrandonNeural": {
                    "Gender": "Male",
                    "Name": "Brandon",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-ChristopherNeural": {
                    "Gender": "Male",
                    "Name": "Christopher",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-CoraNeural": {
                    "Gender": "Female",
                    "Name": "Cora",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-ElizabethNeural": {
                    "Gender": "Female",
                    "Name": "Elizabeth",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-EricNeural": {
                    "Gender": "Male",
                    "Name": "Eric",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-JacobNeural": {
                    "Gender": "Male",
                    "Name": "Jacob",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-JennyMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Jenny Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-MichelleNeural": {
                    "Gender": "Female",
                    "Name": "Michelle",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-MonicaNeural": {
                    "Gender": "Female",
                    "Name": "Monica",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-RogerNeural": {
                    "Gender": "Male",
                    "Name": "Roger",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-RyanMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Ryan Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-SteffanNeural": {
                    "Gender": "Male",
                    "Name": "Steffan",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AdamMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Adam Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AIGenerate1Neural": {
                    "Gender": "Male",
                    "Name": "AIGenerate1",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AIGenerate2Neural": {
                    "Gender": "Female",
                    "Name": "AIGenerate2",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-AmandaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Amanda Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-BlueNeural": {
                    "Gender": "Male",
                    "Name": "Blue",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-DavisMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Davis Multilingual",
                    "Styles": [
                        "empathetic",
                        "funny",
                        "relieved"
                    ]
                }
            },
            {
                "en-US-DerekMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Derek Multilingual",
                    "Styles": [
                        "empathetic",
                        "excited",
                        "relieved",
                        "shy"
                    ]
                }
            },
            {
                "en-US-DustinMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Dustin Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-EvelynMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Evelyn Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-LewisMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Lewis Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-LolaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Lola Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-NancyMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Nancy Multilingual",
                    "Styles": [
                        "excited",
                        "friendly",
                        "funny",
                        "relieved",
                        "shy"
                    ]
                }
            },
            {
                "en-US-PhoebeMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Phoebe Multilingual",
                    "Styles": [
                        "empathetic",
                        "sad",
                        "serious"
                    ]
                }
            },
            {
                "en-US-SamuelMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Samuel Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-SerenaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Serena Multilingual",
                    "Styles": [
                        "empathetic",
                        "excited",
                        "friendly",
                        "shy",
                        "serious",
                        "relieved",
                        "sad"
                    ]
                }
            },
            {
                "en-US-SteffanMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Steffan Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Adam:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Adam Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Alloy:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Alloy Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Andrew:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Andrew Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Andrew2:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Andrew2 Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Andrew3:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Andrew3 Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Aria:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Aria Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Ava:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Ava Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Ava3:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Ava3 Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Brian:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Brian Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Davis:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Davis Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Emma:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Emma Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Emma2:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Emma2 Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Jenny:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Jenny Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-MultiTalker-Ava-Andrew:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "MultiTalker Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Nova:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Nova Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Phoebe:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Phoebe Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Serena:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Serena Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-US-Steffan:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Steffan Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "en-ZA": {
        "language": "English (South Africa)",
        "voices": [
            {
                "en-ZA-LeahNeural": {
                    "Gender": "Female",
                    "Name": "Leah",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "en-ZA-LukeNeural": {
                    "Gender": "Male",
                    "Name": "Luke",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-AR": {
        "language": "Spanish (Argentina)",
        "voices": [
            {
                "es-AR-ElenaNeural": {
                    "Gender": "Female",
                    "Name": "Elena",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-AR-TomasNeural": {
                    "Gender": "Male",
                    "Name": "Tomas",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-BO": {
        "language": "Spanish (Bolivia)",
        "voices": [
            {
                "es-BO-SofiaNeural": {
                    "Gender": "Female",
                    "Name": "Sofia",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-BO-MarceloNeural": {
                    "Gender": "Male",
                    "Name": "Marcelo",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-CL": {
        "language": "Spanish (Chile)",
        "voices": [
            {
                "es-CL-CatalinaNeural": {
                    "Gender": "Female",
                    "Name": "Catalina",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-CL-LorenzoNeural": {
                    "Gender": "Male",
                    "Name": "Lorenzo",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-CO": {
        "language": "Spanish (Colombia)",
        "voices": [
            {
                "es-CO-SalomeNeural": {
                    "Gender": "Female",
                    "Name": "Salome",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-CO-GonzaloNeural": {
                    "Gender": "Male",
                    "Name": "Gonzalo",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-CR": {
        "language": "Spanish (Costa Rica)",
        "voices": [
            {
                "es-CR-MariaNeural": {
                    "Gender": "Female",
                    "Name": "MarÃ­a",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-CR-JuanNeural": {
                    "Gender": "Male",
                    "Name": "Juan",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-CU": {
        "language": "Spanish (Cuba)",
        "voices": [
            {
                "es-CU-BelkysNeural": {
                    "Gender": "Female",
                    "Name": "Belkys",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-CU-ManuelNeural": {
                    "Gender": "Male",
                    "Name": "Manuel",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-DO": {
        "language": "Spanish (Dominican Republic)",
        "voices": [
            {
                "es-DO-RamonaNeural": {
                    "Gender": "Female",
                    "Name": "Ramona",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-DO-EmilioNeural": {
                    "Gender": "Male",
                    "Name": "Emilio",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-EC": {
        "language": "Spanish (Ecuador)",
        "voices": [
            {
                "es-EC-AndreaNeural": {
                    "Gender": "Female",
                    "Name": "Andrea",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-EC-LuisNeural": {
                    "Gender": "Male",
                    "Name": "Luis",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-ES": {
        "language": "Spanish (Spain)",
        "voices": [
            {
                "es-ES-ElviraNeural": {
                    "Gender": "Female",
                    "Name": "Elvira",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-AlvaroNeural": {
                    "Gender": "Male",
                    "Name": "Ãlvaro",
                    "Styles": [
                        "cheerful",
                        "sad"
                    ]
                }
            },
            {
                "es-ES-ArabellaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Arabella Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-IsidoraMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Isidora Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-TristanMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Tristan Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-XimenaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Ximena Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-AbrilNeural": {
                    "Gender": "Female",
                    "Name": "Abril",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-ArnauNeural": {
                    "Gender": "Male",
                    "Name": "Arnau",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-DarioNeural": {
                    "Gender": "Male",
                    "Name": "Dario",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-EliasNeural": {
                    "Gender": "Male",
                    "Name": "Elias",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-EstrellaNeural": {
                    "Gender": "Female",
                    "Name": "Estrella",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-IreneNeural": {
                    "Gender": "Female",
                    "Name": "Irene",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-LaiaNeural": {
                    "Gender": "Female",
                    "Name": "Laia",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-LiaNeural": {
                    "Gender": "Female",
                    "Name": "Lia",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-NilNeural": {
                    "Gender": "Male",
                    "Name": "Nil",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-SaulNeural": {
                    "Gender": "Male",
                    "Name": "Saul",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-TeoNeural": {
                    "Gender": "Male",
                    "Name": "Teo",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-TrianaNeural": {
                    "Gender": "Female",
                    "Name": "Triana",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-VeraNeural": {
                    "Gender": "Female",
                    "Name": "Vera",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-XimenaNeural": {
                    "Gender": "Female",
                    "Name": "Ximena",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-Tristan:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Tristan Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-ES-Ximena:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Ximena Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-GQ": {
        "language": "Spanish (Equatorial Guinea)",
        "voices": [
            {
                "es-GQ-TeresaNeural": {
                    "Gender": "Female",
                    "Name": "Teresa",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-GQ-JavierNeural": {
                    "Gender": "Male",
                    "Name": "Javier",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-GT": {
        "language": "Spanish (Guatemala)",
        "voices": [
            {
                "es-GT-MartaNeural": {
                    "Gender": "Female",
                    "Name": "Marta",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-GT-AndresNeural": {
                    "Gender": "Male",
                    "Name": "AndrÃ©s",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-HN": {
        "language": "Spanish (Honduras)",
        "voices": [
            {
                "es-HN-KarlaNeural": {
                    "Gender": "Female",
                    "Name": "Karla",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-HN-CarlosNeural": {
                    "Gender": "Male",
                    "Name": "Carlos",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-MX": {
        "language": "Spanish (Mexico)",
        "voices": [
            {
                "es-MX-DaliaNeural": {
                    "Gender": "Female",
                    "Name": "Dalia",
                    "Styles": [
                        "cheerful",
                        "sad",
                        "whispering"
                    ]
                }
            },
            {
                "es-MX-JorgeNeural": {
                    "Gender": "Male",
                    "Name": "Jorge",
                    "Styles": [
                        "cheerful",
                        "chat",
                        "whispering",
                        "sad",
                        "excited"
                    ]
                }
            },
            {
                "es-MX-BeatrizNeural": {
                    "Gender": "Female",
                    "Name": "Beatriz",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-CandelaNeural": {
                    "Gender": "Female",
                    "Name": "Candela",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-CarlotaNeural": {
                    "Gender": "Female",
                    "Name": "Carlota",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-CecilioNeural": {
                    "Gender": "Male",
                    "Name": "Cecilio",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-GerardoNeural": {
                    "Gender": "Male",
                    "Name": "Gerardo",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-LarissaNeural": {
                    "Gender": "Female",
                    "Name": "Larissa",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-LibertoNeural": {
                    "Gender": "Male",
                    "Name": "Liberto",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-LucianoNeural": {
                    "Gender": "Male",
                    "Name": "Luciano",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-MarinaNeural": {
                    "Gender": "Female",
                    "Name": "Marina",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-NuriaNeural": {
                    "Gender": "Female",
                    "Name": "Nuria",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-PelayoNeural": {
                    "Gender": "Male",
                    "Name": "Pelayo",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-RenataNeural": {
                    "Gender": "Female",
                    "Name": "Renata",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-MX-YagoNeural": {
                    "Gender": "Male",
                    "Name": "Yago",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-NI": {
        "language": "Spanish (Nicaragua)",
        "voices": [
            {
                "es-NI-YolandaNeural": {
                    "Gender": "Female",
                    "Name": "Yolanda",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-NI-FedericoNeural": {
                    "Gender": "Male",
                    "Name": "Federico",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-PA": {
        "language": "Spanish (Panama)",
        "voices": [
            {
                "es-PA-MargaritaNeural": {
                    "Gender": "Female",
                    "Name": "Margarita",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-PA-RobertoNeural": {
                    "Gender": "Male",
                    "Name": "Roberto",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-PE": {
        "language": "Spanish (Peru)",
        "voices": [
            {
                "es-PE-CamilaNeural": {
                    "Gender": "Female",
                    "Name": "Camila",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-PE-AlexNeural": {
                    "Gender": "Male",
                    "Name": "Alex",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-PR": {
        "language": "Spanish (Puerto Rico)",
        "voices": [
            {
                "es-PR-KarinaNeural": {
                    "Gender": "Female",
                    "Name": "Karina",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-PR-VictorNeural": {
                    "Gender": "Male",
                    "Name": "VÃ­ctor",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-PY": {
        "language": "Spanish (Paraguay)",
        "voices": [
            {
                "es-PY-TaniaNeural": {
                    "Gender": "Female",
                    "Name": "Tania",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-PY-MarioNeural": {
                    "Gender": "Male",
                    "Name": "Mario",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-SV": {
        "language": "Spanish (El Salvador)",
        "voices": [
            {
                "es-SV-LorenaNeural": {
                    "Gender": "Female",
                    "Name": "Lorena",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-SV-RodrigoNeural": {
                    "Gender": "Male",
                    "Name": "Rodrigo",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-US": {
        "language": "Spanish (United States)",
        "voices": [
            {
                "es-US-PalomaNeural": {
                    "Gender": "Female",
                    "Name": "Paloma",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-US-AlonsoNeural": {
                    "Gender": "Male",
                    "Name": "Alonso",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-UY": {
        "language": "Spanish (Uruguay)",
        "voices": [
            {
                "es-UY-ValentinaNeural": {
                    "Gender": "Female",
                    "Name": "Valentina",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-UY-MateoNeural": {
                    "Gender": "Male",
                    "Name": "Mateo",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "es-VE": {
        "language": "Spanish (Venezuela)",
        "voices": [
            {
                "es-VE-PaolaNeural": {
                    "Gender": "Female",
                    "Name": "Paola",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "es-VE-SebastianNeural": {
                    "Gender": "Male",
                    "Name": "SebastiÃ¡n",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "de-AT": {
        "language": "German (Austria)",
        "voices": [
            {
                "de-AT-IngridNeural": {
                    "Gender": "Female",
                    "Name": "Ingrid",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-AT-JonasNeural": {
                    "Gender": "Male",
                    "Name": "Jonas",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "de-CH": {
        "language": "German (Switzerland)",
        "voices": [
            {
                "de-CH-LeniNeural": {
                    "Gender": "Female",
                    "Name": "Leni",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-CH-JanNeural": {
                    "Gender": "Male",
                    "Name": "Jan",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "de-DE": {
        "language": "German (Germany)",
        "voices": [
            {
                "de-DE-KatjaNeural": {
                    "Gender": "Female",
                    "Name": "Katja",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-ConradNeural": {
                    "Gender": "Male",
                    "Name": "Conrad",
                    "Styles": [
                        "cheerful",
                        "sad"
                    ]
                }
            },
            {
                "de-DE-SeraphinaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Seraphina Mehrsprachig",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-FlorianMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Florian Mehrsprachig",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-AmalaNeural": {
                    "Gender": "Female",
                    "Name": "Amala",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-BerndNeural": {
                    "Gender": "Male",
                    "Name": "Bernd",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-ChristophNeural": {
                    "Gender": "Male",
                    "Name": "Christoph",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-ElkeNeural": {
                    "Gender": "Female",
                    "Name": "Elke",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-GiselaNeural": {
                    "Gender": "Female",
                    "Name": "Gisela",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-KasperNeural": {
                    "Gender": "Male",
                    "Name": "Kasper",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-KillianNeural": {
                    "Gender": "Male",
                    "Name": "Killian",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-KlarissaNeural": {
                    "Gender": "Female",
                    "Name": "Klarissa",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-KlausNeural": {
                    "Gender": "Male",
                    "Name": "Klaus",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-LouisaNeural": {
                    "Gender": "Female",
                    "Name": "Louisa",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-MajaNeural": {
                    "Gender": "Female",
                    "Name": "Maja",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-RalfNeural": {
                    "Gender": "Male",
                    "Name": "Ralf",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-TanjaNeural": {
                    "Gender": "Female",
                    "Name": "Tanja",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-Florian:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Florian Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "de-DE-Seraphina:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Seraphina Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "fr-BE": {
        "language": "French (Belgium)",
        "voices": [
            {
                "fr-BE-CharlineNeural": {
                    "Gender": "Female",
                    "Name": "Charline",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-BE-GerardNeural": {
                    "Gender": "Male",
                    "Name": "Gerard",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "fr-CA": {
        "language": "French (Canada)",
        "voices": [
            {
                "fr-CA-SylvieNeural": {
                    "Gender": "Female",
                    "Name": "Sylvie",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-CA-JeanNeural": {
                    "Gender": "Male",
                    "Name": "Jean",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-CA-AntoineNeural": {
                    "Gender": "Male",
                    "Name": "Antoine",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-CA-ThierryNeural": {
                    "Gender": "Male",
                    "Name": "Thierry",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "fr-CH": {
        "language": "French (Switzerland)",
        "voices": [
            {
                "fr-CH-ArianeNeural": {
                    "Gender": "Female",
                    "Name": "Ariane",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-CH-FabriceNeural": {
                    "Gender": "Male",
                    "Name": "Fabrice",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "fr-FR": {
        "language": "French (France)",
        "voices": [
            {
                "fr-FR-DeniseNeural": {
                    "Gender": "Female",
                    "Name": "Denise",
                    "Styles": [
                        "cheerful",
                        "sad",
                        "whispering",
                        "excited"
                    ]
                }
            },
            {
                "fr-FR-HenriNeural": {
                    "Gender": "Male",
                    "Name": "Henri",
                    "Styles": [
                        "cheerful",
                        "sad",
                        "whispering",
                        "excited"
                    ]
                }
            },
            {
                "fr-FR-VivienneMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Vivienne Multilingue",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-RemyMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "RÃ©my Multilingue",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-LucienMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Lucien Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-AlainNeural": {
                    "Gender": "Male",
                    "Name": "Alain",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-BrigitteNeural": {
                    "Gender": "Female",
                    "Name": "Brigitte",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-CelesteNeural": {
                    "Gender": "Female",
                    "Name": "Celeste",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-ClaudeNeural": {
                    "Gender": "Male",
                    "Name": "Claude",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-CoralieNeural": {
                    "Gender": "Female",
                    "Name": "Coralie",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-EloiseNeural": {
                    "Gender": "Female",
                    "Name": "Eloise",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-JacquelineNeural": {
                    "Gender": "Female",
                    "Name": "Jacqueline",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-JeromeNeural": {
                    "Gender": "Male",
                    "Name": "Jerome",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-JosephineNeural": {
                    "Gender": "Female",
                    "Name": "Josephine",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-MauriceNeural": {
                    "Gender": "Male",
                    "Name": "Maurice",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-YvesNeural": {
                    "Gender": "Male",
                    "Name": "Yves",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-YvetteNeural": {
                    "Gender": "Female",
                    "Name": "Yvette",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-Remy:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Remy Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "fr-FR-Vivienne:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Vivienne Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "ru-RU": {
        "language": "Russian (Russia)",
        "voices": [
            {
                "ru-RU-SvetlanaNeural": {
                    "Gender": "Female",
                    "Name": "Ğ¡Ğ²ĞµÑ‚Ğ»Ğ°Ğ½Ğ°",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ru-RU-DmitryNeural": {
                    "Gender": "Male",
                    "Name": "Ğ”Ğ¼Ğ¸Ñ‚Ñ€Ğ¸Ğ¹",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ru-RU-DariyaNeural": {
                    "Gender": "Female",
                    "Name": "Ğ”Ğ°Ñ€Ğ¸Ñ",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "it-IT": {
        "language": "Italian (Italy)",
        "voices": [
            {
                "it-IT-ElsaNeural": {
                    "Gender": "Female",
                    "Name": "Elsa",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-IsabellaNeural": {
                    "Gender": "Female",
                    "Name": "Isabella",
                    "Styles": [
                        "cheerful",
                        "chat",
                        "whispering",
                        "sad",
                        "excited"
                    ]
                }
            },
            {
                "it-IT-DiegoNeural": {
                    "Gender": "Male",
                    "Name": "Diego",
                    "Styles": [
                        "cheerful",
                        "sad",
                        "excited"
                    ]
                }
            },
            {
                "it-IT-AlessioMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Alessio Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-IsabellaMultilingualNeural": {
                    "Gender": "Female",
                    "Name": "Isabella Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-GiuseppeMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Giuseppe Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-MarcelloMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Marcello Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-BenignoNeural": {
                    "Gender": "Male",
                    "Name": "Benigno",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-CalimeroNeural": {
                    "Gender": "Male",
                    "Name": "Calimero",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-CataldoNeural": {
                    "Gender": "Male",
                    "Name": "Cataldo",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-FabiolaNeural": {
                    "Gender": "Female",
                    "Name": "Fabiola",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-FiammaNeural": {
                    "Gender": "Female",
                    "Name": "Fiamma",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-GianniNeural": {
                    "Gender": "Male",
                    "Name": "Gianni",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-GiuseppeNeural": {
                    "Gender": "Male",
                    "Name": "Giuseppe",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-ImeldaNeural": {
                    "Gender": "Female",
                    "Name": "Imelda",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-IrmaNeural": {
                    "Gender": "Female",
                    "Name": "Irma",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-LisandroNeural": {
                    "Gender": "Male",
                    "Name": "Lisandro",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-PalmiraNeural": {
                    "Gender": "Female",
                    "Name": "Palmira",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-PierinaNeural": {
                    "Gender": "Female",
                    "Name": "Pierina",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "it-IT-RinaldoNeural": {
                    "Gender": "Male",
                    "Name": "Rinaldo",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "ja-JP": {
        "language": "Japanese (Japan)",
        "voices": [
            {
                "ja-JP-NanamiNeural": {
                    "Gender": "Female",
                    "Name": "ä¸ƒæµ·",
                    "Styles": [
                        "chat",
                        "customerservice",
                        "cheerful"
                    ]
                }
            },
            {
                "ja-JP-KeitaNeural": {
                    "Gender": "Male",
                    "Name": "åœ­å¤ª",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-AoiNeural": {
                    "Gender": "Female",
                    "Name": "ç¢§è¡£",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-DaichiNeural": {
                    "Gender": "Male",
                    "Name": "å¤§æ™º",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-MayuNeural": {
                    "Gender": "Female",
                    "Name": "çœŸå¤•",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-NaokiNeural": {
                    "Gender": "Male",
                    "Name": "ç›´ç´€",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-ShioriNeural": {
                    "Gender": "Female",
                    "Name": "å¿—ç¹”",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-MasaruMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "å‹ å¤šè¨€èª",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-Masaru:DragonHDLatestNeural": {
                    "Gender": "Male",
                    "Name": "Masaru Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ja-JP-Nanami:DragonHDLatestNeural": {
                    "Gender": "Female",
                    "Name": "Nanami Dragon HD Latest",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
    "ko-KR": {
        "language": "Korean (Korea)",
        "voices": [
            {
                "ko-KR-SunHiNeural": {
                    "Gender": "Female",
                    "Name": "ì„ íˆ",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-InJoonNeural": {
                    "Gender": "Male",
                    "Name": "ì¸ì¤€",
                    "Styles": [
                        "sad"
                    ]
                }
            },
            {
                "ko-KR-HyunsuMultilingualNeural": {
                    "Gender": "Male",
                    "Name": "Hyunsu Multilingual",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-BongJinNeural": {
                    "Gender": "Male",
                    "Name": "ë´‰ì§„",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-GookMinNeural": {
                    "Gender": "Male",
                    "Name": "êµ­ë¯¼",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-HyunsuNeural": {
                    "Gender": "Male",
                    "Name": "í˜„ìˆ˜",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-JiMinNeural": {
                    "Gender": "Female",
                    "Name": "ì§€ë¯¼",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-SeoHyeonNeural": {
                    "Gender": "Female",
                    "Name": "ì„œí˜„",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-SoonBokNeural": {
                    "Gender": "Female",
                    "Name": "ìˆœë³µ",
                    "Styles": [
                        ""
                    ]
                }
            },
            {
                "ko-KR-YuJinNeural": {
                    "Gender": "Female",
                    "Name": "ìœ ì§„",
                    "Styles": [
                        ""
                    ]
                }
            }
        ]
    },
}

edgeTTS_voices = {
    "zh-CN": {
        "language": "Chinese (æ™®é€šè¯)",
        "voices": [
            {"zh-CN-XiaoxiaoNeural": {"Gender": "Female", "Name": "æ™“æ™“"}},
            {"zh-CN-XiaoyiNeural": {"Gender": "Female", "Name": "æ™“ä¼Š"}},
            {"zh-CN-YunjianNeural": {"Gender": "Male", "Name": "äº‘å¥"}},
            {"zh-CN-YunxiNeural": {"Gender": "Male", "Name": "äº‘å¸Œ"}},
            {"zh-CN-YunxiaNeural": {"Gender": "Male", "Name": "äº‘å¤"}},
            {"zh-CN-YunyangNeural": {"Gender": "Male", "Name": "äº‘æ‰¬"}},
        ]
    },
    "zh-CN-shaanxi": {
        "language": "Chinese (ä¸­åŸå®˜è¯é™•è¥¿ï¼Œç®€ä½“)",
        "voices": [
            {"zh-CN-shaanxi-XiaoniNeural": {"Gender": "Female", "Name": "æ™“å¦®"}}
        ]
    },
    "zh-CN-liaoning": {
        "language": "Chinese (ä¸œåŒ—å®˜è¯ï¼Œç®€ä½“)",
        "voices": [
            {"zh-CN-liaoning-XiaobeiNeural": {"Gender": "Female", "Name": "æ™“åŒ— è¾½å®"}},
        ]
    },
    "zh-HK": {
        "language": "Chinese (ç²¤è¯­ï¼Œç¹ä½“)",
        "voices": [
            {"zh-HK-HiuMaanNeural": {"Gender": "Female", "Name": "æ›‰æ›¼"}},
            {"zh-HK-WanLungNeural": {"Gender": "Male", "Name": "é›²é¾"}},
            {"zh-HK-HiuGaaiNeural": {"Gender": "Female", "Name": "æ›‰ä½³"}}
        ]
    },
    "zh-TW": {
        "language": "Chinese (å°æ¹¾ï¼Œç¹ä½“)",
        "voices": [
            {"zh-TW-HsiaoChenNeural": {"Gender": "Female", "Name": "æ›‰è‡»"}},
            {"zh-TW-YunJheNeural": {"Gender": "Male", "Name": "é›²å“²"}},
            {"zh-TW-HsiaoYuNeural": {"Gender": "Female", "Name": "æ›‰é›¨"}}
        ]
    },
    "af-ZA": {
        "language": "Afrikaans (South Africa)",
        "voices": [
            {"af-ZA-AdriNeural": {"Gender": "Female", "Name": "Adri"}},
            {"af-ZA-WillemNeural": {"Gender": "Male", "Name": "Willem"}}
        ]
    },
    "am-ET": {
        "language": "Amharic (Ethiopia)",
        "voices": [
            {"am-ET-AmehaNeural": {"Gender": "Male", "Name": "Ameha"}},
            {"am-ET-MekdesNeural": {"Gender": "Female", "Name": "Mekdes"}}
        ]
    },
    "ar-AE": {
        "language": "Arabic (United Arab Emirates)",
        "voices": [
            {"ar-AE-FatimaNeural": {"Gender": "Female", "Name": "Fatima"}},
            {"ar-AE-HamdanNeural": {"Gender": "Male", "Name": "Hamdan"}}
        ]
    },
    "ar-BH": {
        "language": "Arabic (Bahrain)",
        "voices": [
            {"ar-BH-AliNeural": {"Gender": "Male", "Name": "Ali"}},
            {"ar-BH-LailaNeural": {"Gender": "Female", "Name": "Laila"}}
        ]
    },
    "ar-DZ": {
        "language": "Arabic (Algeria)",
        "voices": [
            {"ar-DZ-AminaNeural": {"Gender": "Female", "Name": "Amina"}},
            {"ar-DZ-IsmaelNeural": {"Gender": "Male", "Name": "Ismael"}}
        ]
    },
    "ar-EG": {
        "language": "Arabic (Egypt)",
        "voices": [
            {"ar-EG-SalmaNeural": {"Gender": "Female", "Name": "Salma"}},
            {"ar-EG-ShakirNeural": {"Gender": "Male", "Name": "Shakir"}}
        ]
    },
    "ar-IQ": {
        "language": "Arabic (Iraq)",
        "voices": [
            {"ar-IQ-BasselNeural": {"Gender": "Male", "Name": "Bassel"}},
            {"ar-IQ-RanaNeural": {"Gender": "Female", "Name": "Rana"}}
        ]
    },
    "ar-JO": {
        "language": "Arabic (Jordan)",
        "voices": [
            {"ar-JO-SanaNeural": {"Gender": "Female", "Name": "Sana"}},
            {"ar-JO-TaimNeural": {"Gender": "Male", "Name": "Taim"}}
        ]
    },
    "ar-KW": {
        "language": "Arabic (Kuwait)",
        "voices": [
            {"ar-KW-FahedNeural": {"Gender": "Male", "Name": "Fahed"}},
            {"ar-KW-NouraNeural": {"Gender": "Female", "Name": "Noura"}}
        ]
    },
    "ar-LB": {
        "language": "Arabic (Lebanon)",
        "voices": [
            {"ar-LB-LaylaNeural": {"Gender": "Female", "Name": "Layla"}},
            {"ar-LB-RamiNeural": {"Gender": "Male", "Name": "Rami"}}
        ]
    },
    "ar-LY": {
        "language": "Arabic (Libya)",
        "voices": [
            {"ar-LY-ImanNeural": {"Gender": "Female", "Name": "Iman"}},
            {"ar-LY-OmarNeural": {"Gender": "Male", "Name": "Omar"}}
        ]
    },
    "ar-MA": {
        "language": "Arabic (Morocco)",
        "voices": [
            {"ar-MA-JamalNeural": {"Gender": "Male", "Name": "Jamal"}},
            {"ar-MA-MounaNeural": {"Gender": "Female", "Name": "Mouna"}}
        ]
    },
    "ar-OM": {
        "language": "Arabic (Oman)",
        "voices": [
            {"ar-OM-AbdullahNeural": {"Gender": "Male", "Name": "Abdullah"}},
            {"ar-OM-AyshaNeural": {"Gender": "Female", "Name": "Aysha"}}
        ]
    },
    "ar-QA": {
        "language": "Arabic (Qatar)",
        "voices": [
            {"ar-QA-AmalNeural": {"Gender": "Female", "Name": "Amal"}},
            {"ar-QA-MoazNeural": {"Gender": "Male", "Name": "Moaz"}}
        ]
    },
    "ar-SA": {
        "language": "Arabic (Saudi Arabia)",
        "voices": [
            {"ar-SA-HamedNeural": {"Gender": "Male", "Name": "Hamed"}},
            {"ar-SA-ZariyahNeural": {"Gender": "Female", "Name": "Zariyah"}}
        ]
    },
    "ar-SY": {
        "language": "Arabic (Syria)",
        "voices": [
            {"ar-SY-AmanyNeural": {"Gender": "Female", "Name": "Amany"}},
            {"ar-SY-LaithNeural": {"Gender": "Male", "Name": "Laith"}}
        ]
    },
    "ar-TN": {
        "language": "Arabic (Tunisia)",
        "voices": [
            {"ar-TN-HediNeural": {"Gender": "Male", "Name": "Hedi"}},
            {"ar-TN-ReemNeural": {"Gender": "Female", "Name": "Reem"}}
        ]
    },
    "ar-YE": {
        "language": "Arabic (Yemen)",
        "voices": [
            {"ar-YE-MaryamNeural": {"Gender": "Female", "Name": "Maryam"}},
            {"ar-YE-SalehNeural": {"Gender": "Male", "Name": "Saleh"}}
        ]
    },
    "az-AZ": {
        "language": "Azerbaijani (Azerbaijan)",
        "voices": [
            {"az-AZ-BabekNeural": {"Gender": "Male", "Name": "Babek"}},
            {"az-AZ-BanuNeural": {"Gender": "Female", "Name": "Banu"}}
        ]
    },
    "bg-BG": {
        "language": "Bulgarian (Bulgaria)",
        "voices": [
            {"bg-BG-BorislavNeural": {"Gender": "Male", "Name": "Borislav"}},
            {"bg-BG-KalinaNeural": {"Gender": "Female", "Name": "Kalina"}}
        ]
    },
    "bn-BD": {
        "language": "Bengali (Bangladesh)",
        "voices": [
            {"bn-BD-NabanitaNeural": {"Gender": "Female", "Name": "Nabanita"}},
            {"bn-BD-PradeepNeural": {"Gender": "Male", "Name": "Pradeep"}}
        ]
    },
    "bn-IN": {
        "language": "Bengali (India)",
        "voices": [
            {"bn-IN-BashkarNeural": {"Gender": "Male", "Name": "Bashkar"}},
            {"bn-IN-TanishaaNeural": {"Gender": "Female", "Name": "Tanishaa"}}
        ]
    },
    "bs-BA": {
        "language": "Bosnian (Bosnia and Herzegovina)",
        "voices": [
            {"bs-BA-GoranNeural": {"Gender": "Male", "Name": "Goran"}},
            {"bs-BA-VesnaNeural": {"Gender": "Female", "Name": "Vesna"}}
        ]
    },
    "ca-ES": {
        "language": "Catalan (Spain)",
        "voices": [
            {"ca-ES-EnricNeural": {"Gender": "Male", "Name": "Enric"}},
            {"ca-ES-JoanaNeural": {"Gender": "Female", "Name": "Joana"}}
        ]
    },
    "cs-CZ": {
        "language": "Czech (Czech Republic)",
        "voices": [
            {"cs-CZ-AntoninNeural": {"Gender": "Male", "Name": "Antonin"}},
            {"cs-CZ-VlastaNeural": {"Gender": "Female", "Name": "Vlasta"}}
        ]
    },
    "cy-GB": {
        "language": "Welsh (United Kingdom)",
        "voices": [
            {"cy-GB-AledNeural": {"Gender": "Male", "Name": "Aled"}},
            {"cy-GB-NiaNeural": {"Gender": "Female", "Name": "Nia"}}
        ]
    },
    "da-DK": {
        "language": "Danish (Denmark)",
        "voices": [
            {"da-DK-ChristelNeural": {"Gender": "Female", "Name": "Christel"}},
            {"da-DK-JeppeNeural": {"Gender": "Male", "Name": "Jeppe"}}
        ]
    },
    "de-AT": {
        "language": "German (Austria)",
        "voices": [
            {"de-AT-IngridNeural": {"Gender": "Female", "Name": "Ingrid"}},
            {"de-AT-JonasNeural": {"Gender": "Male", "Name": "Jonas"}}
        ]
    },
    "de-CH": {
        "language": "German (Switzerland)",
        "voices": [
            {"de-CH-JanNeural": {"Gender": "Male", "Name": "Jan"}},
            {"de-CH-LeniNeural": {"Gender": "Female", "Name": "Leni"}}
        ]
    },
    "de-DE": {
        "language": "German (Germany)",
        "voices": [
            {"de-DE-AmalaNeural": {"Gender": "Female", "Name": "Amala"}},
            {"de-DE-ConradNeural": {"Gender": "Male", "Name": "Conrad"}},
            {"de-DE-FlorianMultilingualNeural": {"Gender": "Male", "Name": "Florian"}},
            {"de-DE-KatjaNeural": {"Gender": "Female", "Name": "Katja"}},
            {"de-DE-KillianNeural": {"Gender": "Male", "Name": "Killian"}},
            {"de-DE-SeraphinaMultilingualNeural": {"Gender": "Female", "Name": "Seraphina"}}
        ]
    },
    "el-GR": {
        "language": "Greek (Greece)",
        "voices": [
            {"el-GR-AthinaNeural": {"Gender": "Female", "Name": "Athina"}},
            {"el-GR-NestorasNeural": {"Gender": "Male", "Name": "Nestoras"}}
        ]
    },
    "en-AU": {
        "language": "English (Australia)",
        "voices": [
            {"en-AU-NatashaNeural": {"Gender": "Female", "Name": "Natasha"}},
            {"en-AU-WilliamNeural": {"Gender": "Male", "Name": "William"}}
        ]
    },
    "en-CA": {
        "language": "English (Canada)",
        "voices": [
            {"en-CA-ClaraNeural": {"Gender": "Female", "Name": "Clara"}},
            {"en-CA-LiamNeural": {"Gender": "Male", "Name": "Liam"}}
        ]
    },
    "en-GB": {
        "language": "English (United Kingdom)",
        "voices": [
            {"en-GB-LibbyNeural": {"Gender": "Female", "Name": "Libby"}},
            {"en-GB-MaisieNeural": {"Gender": "Female", "Name": "Maisie"}},
            {"en-GB-RyanNeural": {"Gender": "Male", "Name": "Ryan"}},
            {"en-GB-SoniaNeural": {"Gender": "Female", "Name": "Sonia"}},
            {"en-GB-ThomasNeural": {"Gender": "Male", "Name": "Thomas"}}
        ]
    },
    "en-HK": {
        "language": "English (Hong Kong)",
        "voices": [
            {"en-HK-SamNeural": {"Gender": "Male", "Name": "Sam"}},
            {"en-HK-YanNeural": {"Gender": "Female", "Name": "Yan"}}
        ]
    },
    "en-IE": {
        "language": "English (Ireland)",
        "voices": [
            {"en-IE-ConnorNeural": {"Gender": "Male", "Name": "Connor"}},
            {"en-IE-EmilyNeural": {"Gender": "Female", "Name": "Emily"}}
        ]
    },
    "en-IN": {
        "language": "English (India)",
        "voices": [
            {"en-IN-NeerjaExpressiveNeural": {"Gender": "Female", "Name": "Neerja Expressive"}},
            {"en-IN-NeerjaNeural": {"Gender": "Female", "Name": "Neerja"}},
            {"en-IN-PrabhatNeural": {"Gender": "Male", "Name": "Prabhat"}}
        ]
    },
    "en-KE": {
        "language": "English (Kenya)",
        "voices": [
            {"en-KE-AsiliaNeural": {"Gender": "Female", "Name": "Asilia"}},
            {"en-KE-ChilembaNeural": {"Gender": "Male", "Name": "Chilemba"}}
        ]
    },
    "en-NG": {
        "language": "English (Nigeria)",
        "voices": [
            {"en-NG-AbeoNeural": {"Gender": "Male", "Name": "Abeo"}},
            {"en-NG-EzinneNeural": {"Gender": "Female", "Name": "Ezinne"}}
        ]
    },
    "en-NZ": {
        "language": "English (New Zealand)",
        "voices": [
            {"en-NZ-MitchellNeural": {"Gender": "Male", "Name": "Mitchell"}},
            {"en-NZ-MollyNeural": {"Gender": "Female", "Name": "Molly"}}
        ]
    },
    "en-PH": {
        "language": "English (Philippines)",
        "voices": [
            {"en-PH-JamesNeural": {"Gender": "Male", "Name": "James"}},
            {"en-PH-RosaNeural": {"Gender": "Female", "Name": "Rosa"}}
        ]
    },
    "en-SG": {
        "language": "English (Singapore)",
        "voices": [
            {"en-SG-LunaNeural": {"Gender": "Female", "Name": "Luna"}},
            {"en-SG-WayneNeural": {"Gender": "Male", "Name": "Wayne"}}
        ]
    },
    "en-TZ": {
        "language": "English (Tanzania)",
        "voices": [
            {"en-TZ-ElimuNeural": {"Gender": "Male", "Name": "Elimu"}},
            {"en-TZ-ImaniNeural": {"Gender": "Female", "Name": "Imani"}}
        ]
    },
    "en-US": {
        "language": "English (United States)",
        "voices": [
            {"en-US-AnaNeural": {"Gender": "Female", "Name": "Ana"}},
            {"en-US-AndrewMultilingualNeural": {"Gender": "Male", "Name": "Andrew Multilingual"}},
            {"en-US-AndrewNeural": {"Gender": "Male", "Name": "Andrew"}},
            {"en-US-AriaNeural": {"Gender": "Female", "Name": "Aria"}},
            {"en-US-AvaMultilingualNeural": {"Gender": "Female", "Name": "Ava Multilingual"}},
            {"en-US-AvaNeural": {"Gender": "Female", "Name": "Ava"}},
            {"en-US-BrianMultilingualNeural": {"Gender": "Male", "Name": "Brian Multilingual"}},
            {"en-US-BrianNeural": {"Gender": "Male", "Name": "Brian"}},
            {"en-US-ChristopherNeural": {"Gender": "Male", "Name": "Christopher"}},
            {"en-US-EmmaMultilingualNeural": {"Gender": "Female", "Name": "Emma Multilingual"}},
            {"en-US-EmmaNeural": {"Gender": "Female", "Name": "Emma"}},
            {"en-US-EricNeural": {"Gender": "Male", "Name": "Eric"}},
            {"en-US-GuyNeural": {"Gender": "Male", "Name": "Guy"}},
            {"en-US-JennyNeural": {"Gender": "Female", "Name": "Jenny"}},
            {"en-US-MichelleNeural": {"Gender": "Female", "Name": "Michelle"}},
            {"en-US-RogerNeural": {"Gender": "Male", "Name": "Roger"}},
            {"en-US-SteffanNeural": {"Gender": "Male", "Name": "Steffan"}}
        ]
    },
    "en-ZA": {
        "language": "English (South Africa)",
        "voices": [
            {"en-ZA-LeahNeural": {"Gender": "Female", "Name": "Leah"}},
            {"en-ZA-LukeNeural": {"Gender": "Male", "Name": "Luke"}}
        ]
    },
    "es-AR": {
        "language": "Spanish (Argentina)",
        "voices": [
            {"es-AR-ElenaNeural": {"Gender": "Female", "Name": "Elena"}},
            {"es-AR-TomasNeural": {"Gender": "Male", "Name": "Tomas"}}
        ]
    },
    "es-BO": {
        "language": "Spanish (Bolivia)",
        "voices": [
            {"es-BO-SofiaNeural": {"Gender": "Female", "Name": "Sofia"}},
            {"es-BO-MarceloNeural": {"Gender": "Male", "Name": "Marcelo"}}
        ]
    },
    "es-CL": {
        "language": "Spanish (Chile)",
        "voices": [
            {"es-CL-CatalinaNeural": {"Gender": "Female", "Name": "Catalina"}},
            {"es-CL-LorenzoNeural": {"Gender": "Male", "Name": "Lorenzo"}}
        ]
    },
    "es-CO": {
        "language": "Spanish (Colombia)",
        "voices": [
            {"es-CO-GonzaloNeural": {"Gender": "Male", "Name": "Gonzalo"}},
            {"es-CO-SalomeNeural": {"Gender": "Female", "Name": "Salome"}}
        ]
    },
    "es-CR": {
        "language": "Spanish (Costa Rica)",
        "voices": [
            {"es-CR-JuanNeural": {"Gender": "Male", "Name": "Juan"}},
            {"es-CR-MariaNeural": {"Gender": "Female", "Name": "Maria"}}
        ]
    },
    "es-CU": {
        "language": "Spanish (Cuba)",
        "voices": [
            {"es-CU-BelkysNeural": {"Gender": "Female", "Name": "Belkys"}},
            {"es-CU-ManuelNeural": {"Gender": "Male", "Name": "Manuel"}}
        ]
    },
    "es-DO": {
        "language": "Spanish (Dominican Republic)",
        "voices": [
            {"es-DO-EmilioNeural": {"Gender": "Male", "Name": "Emilio"}},
            {"es-DO-RamonaNeural": {"Gender": "Female", "Name": "Ramona"}}
        ]
    },
    "es-EC": {
        "language": "Spanish (Ecuador)",
        "voices": [
            {"es-EC-AndreaNeural": {"Gender": "Female", "Name": "Andrea"}},
            {"es-EC-LuisNeural": {"Gender": "Male", "Name": "Luis"}}
        ]
    },
    "es-ES": {
        "language": "Spanish (Spain)",
        "voices": [
            {"es-ES-AlvaroNeural": {"Gender": "Male", "Name": "Alvaro"}},
            {"es-ES-ElviraNeural": {"Gender": "Female", "Name": "Elvira"}},
            {"es-ES-XimenaNeural": {"Gender": "Female", "Name": "Ximena"}}
        ]
    },
    "es-GQ": {
        "language": "Spanish (Equatorial Guinea)",
        "voices": [
            {"es-GQ-JavierNeural": {"Gender": "Male", "Name": "Javier"}},
            {"es-GQ-TeresaNeural": {"Gender": "Female", "Name": "Teresa"}}
        ]
    },
    "es-GT": {
        "language": "Spanish (Guatemala)",
        "voices": [
            {"es-GT-AndresNeural": {"Gender": "Male", "Name": "Andres"}},
            {"es-GT-MartaNeural": {"Gender": "Female", "Name": "Marta"}}
        ]
    },
    "es-HN": {
        "language": "Spanish (Honduras)",
        "voices": [
            {"es-HN-CarlosNeural": {"Gender": "Male", "Name": "Carlos"}},
            {"es-HN-KarlaNeural": {"Gender": "Female", "Name": "Karla"}}
        ]
    },
    "es-MX": {
        "language": "Spanish (Mexico)",
        "voices": [
            {"es-MX-DaliaNeural": {"Gender": "Female", "Name": "Dalia"}},
            {"es-MX-JorgeNeural": {"Gender": "Male", "Name": "Jorge"}}
        ]
    },
    "es-NI": {
        "language": "Spanish (Nicaragua)",
        "voices": [
            {"es-NI-FedericoNeural": {"Gender": "Male", "Name": "Federico"}},
            {"es-NI-YolandaNeural": {"Gender": "Female", "Name": "Yolanda"}}
        ]
    },
    "es-PA": {
        "language": "Spanish (Panama)",
        "voices": [
            {"es-PA-MargaritaNeural": {"Gender": "Female", "Name": "Margarita"}},
            {"es-PA-RobertoNeural": {"Gender": "Male", "Name": "Roberto"}}
        ]
    },
    "es-PE": {
        "language": "Spanish (Peru)",
        "voices": [
            {"es-PE-AlexNeural": {"Gender": "Male", "Name": "Alex"}},
            {"es-PE-CamilaNeural": {"Gender": "Female", "Name": "Camila"}}
        ]
    },
    "es-PR": {
        "language": "Spanish (Puerto Rico)",
        "voices": [
            {"es-PR-KarinaNeural": {"Gender": "Female", "Name": "Karina"}},
            {"es-PR-VictorNeural": {"Gender": "Male", "Name": "Victor"}}
        ]
    },
    "es-PY": {
        "language": "Spanish (Paraguay)",
        "voices": [
            {"es-PY-MarioNeural": {"Gender": "Male", "Name": "Mario"}},
            {"es-PY-TaniaNeural": {"Gender": "Female", "Name": "Tania"}}
        ]
    },
    "es-SV": {
        "language": "Spanish (El Salvador)",
        "voices": [
            {"es-SV-LorenaNeural": {"Gender": "Female", "Name": "Lorena"}},
            {"es-SV-RodrigoNeural": {"Gender": "Male", "Name": "Rodrigo"}}
        ]
    },
    "es-US": {
        "language": "Spanish (United States)",
        "voices": [
            {"es-US-AlonsoNeural": {"Gender": "Male", "Name": "Alonso"}},
            {"es-US-PalomaNeural": {"Gender": "Female", "Name": "Paloma"}}
        ]
    },
    "es-UY": {
        "language": "Spanish (Uruguay)",
        "voices": [
            {"es-UY-MateoNeural": {"Gender": "Male", "Name": "Mateo"}},
            {"es-UY-ValentinaNeural": {"Gender": "Female", "Name": "Valentina"}}
        ]
    },
    "es-VE": {
        "language": "Spanish (Venezuela)",
        "voices": [
            {"es-VE-PaolaNeural": {"Gender": "Female", "Name": "Paola"}},
            {"es-VE-SebastianNeural": {"Gender": "Male", "Name": "Sebastian"}}
        ]
    },
    "et-EE": {
        "language": "Estonian (Estonia)",
        "voices": [
            {"et-EE-AnuNeural": {"Gender": "Female", "Name": "Anu"}},
            {"et-EE-KertNeural": {"Gender": "Male", "Name": "Kert"}}
        ]
    },
    "fa-IR": {
        "language": "Persian (Iran)",
        "voices": [
            {"fa-IR-DilaraNeural": {"Gender": "Female", "Name": "Dilara"}},
            {"fa-IR-FaridNeural": {"Gender": "Male", "Name": "Farid"}}
        ]
    },
    "fi-FI": {
        "language": "Finnish (Finland)",
        "voices": [
            {"fi-FI-HarriNeural": {"Gender": "Male", "Name": "Harri"}},
            {"fi-FI-NooraNeural": {"Gender": "Female", "Name": "Noora"}}
        ]
    },
    "fil-PH": {
        "language": "Filipino (Philippines)",
        "voices": [
            {"fil-PH-AngeloNeural": {"Gender": "Male", "Name": "Angelo"}},
            {"fil-PH-BlessicaNeural": {"Gender": "Female", "Name": "Blessica"}}
        ]
    },
    "fr-BE": {
        "language": "French (Belgium)",
        "voices": [
            {"fr-BE-CharlineNeural": {"Gender": "Female", "Name": "Charline"}},
            {"fr-BE-GerardNeural": {"Gender": "Male", "Name": "Gerard"}}
        ]
    },
    "fr-CA": {
        "language": "French (Canada)",
        "voices": [
            {"fr-CA-AntoineNeural": {"Gender": "Male", "Name": "Antoine"}},
            {"fr-CA-JeanNeural": {"Gender": "Male", "Name": "Jean"}},
            {"fr-CA-SylvieNeural": {"Gender": "Female", "Name": "Sylvie"}},
            {"fr-CA-ThierryNeural": {"Gender": "Male", "Name": "Thierry"}}
        ]
    },
    "fr-CH": {
        "language": "French (Switzerland)",
        "voices": [
            {"fr-CH-ArianeNeural": {"Gender": "Female", "Name": "Ariane"}},
            {"fr-CH-FabriceNeural": {"Gender": "Male", "Name": "Fabrice"}}
        ]
    },
    "fr-FR": {
        "language": "French (France)",
        "voices": [
            {"fr-FR-DeniseNeural": {"Gender": "Female", "Name": "Denise"}},
            {"fr-FR-EloiseNeural": {"Gender": "Female", "Name": "Eloise"}},
            {"fr-FR-HenriNeural": {"Gender": "Male", "Name": "Henri"}},
            {"fr-FR-RemyMultilingualNeural": {"Gender": "Male", "Name": "Remy Multilingual"}},
            {"fr-FR-VivienneMultilingualNeural": {"Gender": "Female", "Name": "Vivienne Multilingual"}}
        ]
    },
    "ga-IE": {
        "language": "Irish (Ireland)",
        "voices": [
            {"ga-IE-ColmNeural": {"Gender": "Male", "Name": "Colm"}},
            {"ga-IE-OrlaNeural": {"Gender": "Female", "Name": "Orla"}}
        ]
    },
    "gl-ES": {
        "language": "Galician (Spain)",
        "voices": [
            {"gl-ES-RoiNeural": {"Gender": "Male", "Name": "Roi"}},
            {"gl-ES-SabelaNeural": {"Gender": "Female", "Name": "Sabela"}}
        ]
    },
    "gu-IN": {
        "language": "Gujarati (India)",
        "voices": [
            {"gu-IN-DhwaniNeural": {"Gender": "Female", "Name": "Dhwani"}},
            {"gu-IN-NiranjanNeural": {"Gender": "Male", "Name": "Niranjan"}}
        ]
    },
    "he-IL": {
        "language": "Hebrew (Israel)",
        "voices": [
            {"he-IL-AvriNeural": {"Gender": "Male", "Name": "Avri"}},
            {"he-IL-HilaNeural": {"Gender": "Female", "Name": "Hila"}}
        ]
    },
    "hi-IN": {
        "language": "Hindi (India)",
        "voices": [
            {"hi-IN-MadhurNeural": {"Gender": "Male", "Name": "Madhur"}},
            {"hi-IN-SwaraNeural": {"Gender": "Female", "Name": "Swara"}}
        ]
    },
    "hr-HR": {
        "language": "Croatian (Croatia)",
        "voices": [
            {"hr-HR-GabrijelaNeural": {"Gender": "Female", "Name": "Gabrijela"}},
            {"hr-HR-SreckoNeural": {"Gender": "Male", "Name": "Srecko"}}
        ]
    },
    "hu-HU": {
        "language": "Hungarian (Hungary)",
        "voices": [
            {"hu-HU-NoemiNeural": {"Gender": "Female", "Name": "Noemi"}},
            {"hu-HU-TamasNeural": {"Gender": "Male", "Name": "Tamas"}}
        ]
    },
    "id-ID": {
        "language": "Indonesian (Indonesia)",
        "voices": [
            {"id-ID-ArdiNeural": {"Gender": "Male", "Name": "Ardi"}},
            {"id-ID-GadisNeural": {"Gender": "Female", "Name": "Gadis"}}
        ]
    },
    "is-IS": {
        "language": "Icelandic (Iceland)",
        "voices": [
            {"is-IS-GudrunNeural": {"Gender": "Female", "Name": "Gudrun"}},
            {"is-IS-GunnarNeural": {"Gender": "Male", "Name": "Gunnar"}}
        ]
    },
    "it-IT": {
        "language": "Italian (Italy)",
        "voices": [
            {"it-IT-DiegoNeural": {"Gender": "Male", "Name": "Diego"}},
            {"it-IT-ElsaNeural": {"Gender": "Female", "Name": "Elsa"}},
            {"it-IT-GiuseppeNeural": {"Gender": "Male", "Name": "Giuseppe"}},
            {"it-IT-IsabellaNeural": {"Gender": "Female", "Name": "Isabella"}}
        ]
    },
    "ja-JP": {
        "language": "Japanese (Japan)",
        "voices": [
            {"ja-JP-KeitaNeural": {"Gender": "Male", "Name": "Keita"}},
            {"ja-JP-NanamiNeural": {"Gender": "Female", "Name": "Nanami"}}
        ]
    },
    "jv-ID": {
        "language": "Javanese (Indonesia)",
        "voices": [
            {"jv-ID-DimasNeural": {"Gender": "Male", "Name": "Dimas"}},
            {"jv-ID-SitiNeural": {"Gender": "Female", "Name": "Siti"}}
        ]
    },
    "ka-GE": {
        "language": "Georgian (Georgia)",
        "voices": [
            {"ka-GE-EkaNeural": {"Gender": "Female", "Name": "Eka"}},
            {"ka-GE-GiorgiNeural": {"Gender": "Male", "Name": "Giorgi"}}
        ]
    },
    "kk-KZ": {
        "language": "Kazakh (Kazakhstan)",
        "voices": [
            {"kk-KZ-AigulNeural": {"Gender": "Female", "Name": "Aigul"}},
            {"kk-KZ-DauletNeural": {"Gender": "Male", "Name": "Daulet"}}
        ]
    },
    "km-KH": {
        "language": "Khmer (Cambodia)",
        "voices": [
            {"km-KH-PisethNeural": {"Gender": "Male", "Name": "Piseth"}},
            {"km-KH-SreymomNeural": {"Gender": "Female", "Name": "Sreymom"}}
        ]
    },
    "kn-IN": {
        "language": "Kannada (India)",
        "voices": [
            {"kn-IN-GaganNeural": {"Gender": "Male", "Name": "Gagan"}},
            {"kn-IN-SapnaNeural": {"Gender": "Female", "Name": "Sapna"}}
        ]
    },
    "ko-KR": {
        "language": "Korean (South Korea)",
        "voices": [
            {"ko-KR-HyunsuNeural": {"Gender": "Male", "Name": "Hyunsu"}},
            {"ko-KR-InJoonNeural": {"Gender": "Male", "Name": "InJoon"}},
            {"ko-KR-SunHiNeural": {"Gender": "Female", "Name": "SunHi"}}
        ]
    },
    "lo-LA": {
        "language": "Lao (Laos)",
        "voices": [
            {"lo-LA-ChanthavongNeural": {"Gender": "Male", "Name": "Chanthavong"}},
            {"lo-LA-KeomanyNeural": {"Gender": "Female", "Name": "Keomany"}}
        ]
    },
    "lt-LT": {
        "language": "Lithuanian (Lithuania)",
        "voices": [
            {"lt-LT-LeonasNeural": {"Gender": "Male", "Name": "Leonas"}},
            {"lt-LT-OnaNeural": {"Gender": "Female", "Name": "Ona"}}
        ]
    },
    "lv-LV": {
        "language": "Latvian (Latvia)",
        "voices": [
            {"lv-LV-EveritaNeural": {"Gender": "Female", "Name": "Everita"}},
            {"lv-LV-NilsNeural": {"Gender": "Male", "Name": "Nils"}}
        ]
    },
    "mk-MK": {
        "language": "Macedonian (North Macedonia)",
        "voices": [
            {"mk-MK-AleksandarNeural": {"Gender": "Male", "Name": "Aleksandar"}},
            {"mk-MK-MarijaNeural": {"Gender": "Female", "Name": "Marija"}}
        ]
    },
    "ml-IN": {
        "language": "Malayalam (India)",
        "voices": [
            {"ml-IN-MidhunNeural": {"Gender": "Male", "Name": "Midhun"}},
            {"ml-IN-SobhanaNeural": {"Gender": "Female", "Name": "Sobhana"}}
        ]
    },
    "mn-MN": {
        "language": "Mongolian (Mongolia)",
        "voices": [
            {"mn-MN-BataaNeural": {"Gender": "Male", "Name": "Bataa"}},
            {"mn-MN-YesuiNeural": {"Gender": "Female", "Name": "Yesui"}}
        ]
    },
    "mr-IN": {
        "language": "Marathi (India)",
        "voices": [
            {"mr-IN-AarohiNeural": {"Gender": "Female", "Name": "Aarohi"}},
            {"mr-IN-ManoharNeural": {"Gender": "Male", "Name": "Manohar"}}
        ]
    },
    "ms-MY": {
        "language": "Malay (Malaysia)",
        "voices": [
            {"ms-MY-OsmanNeural": {"Gender": "Male", "Name": "Osman"}},
            {"ms-MY-YasminNeural": {"Gender": "Female", "Name": "Yasmin"}}
        ]
    },
    "mt-MT": {
        "language": "Maltese (Malta)",
        "voices": [
            {"mt-MT-GraceNeural": {"Gender": "Female", "Name": "Grace"}},
            {"mt-MT-JosephNeural": {"Gender": "Male", "Name": "Joseph"}}
        ]
    },
    "my-MM": {
        "language": "Burmese (Myanmar)",
        "voices": [
            {"my-MM-NilarNeural": {"Gender": "Female", "Name": "Nilar"}},
            {"my-MM-ThihaNeural": {"Gender": "Male", "Name": "Thiha"}}
        ]
    },
    "nb-NO": {
        "language": "Norwegian (Norway)",
        "voices": [
            {"nb-NO-FinnNeural": {"Gender": "Male", "Name": "Finn"}},
            {"nb-NO-PernilleNeural": {"Gender": "Female", "Name": "Pernille"}}
        ]
    },
    "ne-NP": {
        "language": "Nepali (Nepal)",
        "voices": [
            {"ne-NP-HemkalaNeural": {"Gender": "Female", "Name": "Hemkala"}},
            {"ne-NP-SagarNeural": {"Gender": "Male", "Name": "Sagar"}}
        ]
    },
    "nl-BE": {
        "language": "Dutch (Belgium)",
        "voices": [
            {"nl-BE-ArnaudNeural": {"Gender": "Male", "Name": "Arnaud"}},
            {"nl-BE-DenaNeural": {"Gender": "Female", "Name": "Dena"}}
        ]
    },
    "nl-NL": {
        "language": "Dutch (Netherlands)",
        "voices": [
            {"nl-NL-ColetteNeural": {"Gender": "Female", "Name": "Colette"}},
            {"nl-NL-FennaNeural": {"Gender": "Female", "Name": "Fenna"}},
            {"nl-NL-MaartenNeural": {"Gender": "Male", "Name": "Maarten"}}
        ]
    },
    "pl-PL": {
        "language": "Polish (Poland)",
        "voices": [
            {"pl-PL-MarekNeural": {"Gender": "Male", "Name": "Marek"}},
            {"pl-PL-ZofiaNeural": {"Gender": "Female", "Name": "Zofia"}}
        ]
    },
    "ps-AF": {
        "language": "Pashto (Afghanistan)",
        "voices": [
            {"ps-AF-GulNawazNeural": {"Gender": "Male", "Name": "GulNawaz"}},
            {"ps-AF-LatifaNeural": {"Gender": "Female", "Name": "Latifa"}}
        ]
    },
    "pt-BR": {
        "language": "Portuguese (Brazil)",
        "voices": [
            {"pt-BR-AntonioNeural": {"Gender": "Male", "Name": "Antonio"}},
            {"pt-BR-FranciscaNeural": {"Gender": "Female", "Name": "Francisca"}},
            {"pt-BR-ThalitaNeural": {"Gender": "Female", "Name": "Thalita"}}
        ]
    },
    "pt-PT": {
        "language": "Portuguese (Portugal)",
        "voices": [
            {"pt-PT-DuarteNeural": {"Gender": "Male", "Name": "Duarte"}},
            {"pt-PT-RaquelNeural": {"Gender": "Female", "Name": "Raquel"}}
        ]
    },
    "ro-RO": {
        "language": "Romanian (Romania)",
        "voices": [
            {"ro-RO-AlinaNeural": {"Gender": "Female", "Name": "Alina"}},
            {"ro-RO-EmilNeural": {"Gender": "Male", "Name": "Emil"}}
        ]
    },
    "ru-RU": {
        "language": "Russian (Russia)",
        "voices": [
            {"ru-RU-DmitryNeural": {"Gender": "Male", "Name": "Dmitry"}},
            {"ru-RU-SvetlanaNeural": {"Gender": "Female", "Name": "Svetlana"}}
        ]
    },
    "si-LK": {
        "language": "Sinhala (Sri Lanka)",
        "voices": [
            {"si-LK-SameeraNeural": {"Gender": "Male", "Name": "Sameera"}},
            {"si-LK-ThiliniNeural": {"Gender": "Female", "Name": "Thilini"}}
        ]
    },
    "sk-SK": {
        "language": "Slovak (Slovakia)",
        "voices": [
            {"sk-SK-LukasNeural": {"Gender": "Male", "Name": "Lukas"}},
            {"sk-SK-ViktoriaNeural": {"Gender": "Female", "Name": "Viktoria"}}
        ]
    },
    "sl-SI": {
        "language": "Slovenian (Slovenia)",
        "voices": [
            {"sl-SI-PetraNeural": {"Gender": "Female", "Name": "Petra"}},
            {"sl-SI-RokNeural": {"Gender": "Male", "Name": "Rok"}}
        ]
    },
    "so-SO": {
        "language": "Somali (Somalia)",
        "voices": [
            {"so-SO-MuuseNeural": {"Gender": "Male", "Name": "Muuse"}},
            {"so-SO-UbaxNeural": {"Gender": "Female", "Name": "Ubax"}}
        ]
    },
    "sq-AL": {
        "language": "Albanian (Albania)",
        "voices": [
            {"sq-AL-AnilaNeural": {"Gender": "Female", "Name": "Anila"}},
            {"sq-AL-IlirNeural": {"Gender": "Male", "Name": "Ilir"}}
        ]
    },
    "sr-RS": {
        "language": "Serbian (Serbia)",
        "voices": [
            {"sr-RS-NicholasNeural": {"Gender": "Male", "Name": "Nicholas"}},
            {"sr-RS-SophieNeural": {"Gender": "Female", "Name": "Sophie"}}
        ]
    },
    "su-ID": {
        "language": "Sundanese (Indonesia)",
        "voices": [
            {"su-ID-JajangNeural": {"Gender": "Male", "Name": "Jajang"}},
            {"su-ID-TutiNeural": {"Gender": "Female", "Name": "Tuti"}}
        ]
    },
    "sv-SE": {
        "language": "Swedish (Sweden)",
        "voices": [
            {"sv-SE-MattiasNeural": {"Gender": "Male", "Name": "Mattias"}},
            {"sv-SE-SofieNeural": {"Gender": "Female", "Name": "Sofie"}}
        ]
    },
    "sw-KE": {
        "language": "Swahili (Kenya)",
        "voices": [
            {"sw-KE-RafikiNeural": {"Gender": "Male", "Name": "Rafiki"}},
            {"sw-KE-ZuriNeural": {"Gender": "Female", "Name": "Zuri"}}
        ]
    },
    "sw-TZ": {
        "language": "Swahili (Tanzania)",
        "voices": [
            {"sw-TZ-DaudiNeural": {"Gender": "Male", "Name": "Daudi"}},
            {"sw-TZ-RehemaNeural": {"Gender": "Female", "Name": "Rehema"}}
        ]
    },
    "ta-IN": {
        "language": "Tamil (India)",
        "voices": [
            {"ta-IN-PallaviNeural": {"Gender": "Female", "Name": "Pallavi"}},
            {"ta-IN-ValluvarNeural": {"Gender": "Male", "Name": "Valluvar"}}
        ]
    },
    "ta-LK": {
        "language": "Tamil (Sri Lanka)",
        "voices": [
            {"ta-LK-KumarNeural": {"Gender": "Male", "Name": "Kumar"}},
            {"ta-LK-SaranyaNeural": {"Gender": "Female", "Name": "Saranya"}}
        ]
    },
    "ta-MY": {
        "language": "Tamil (Malaysia)",
        "voices": [
            {"ta-MY-KaniNeural": {"Gender": "Female", "Name": "Kani"}},
            {"ta-MY-SuryaNeural": {"Gender": "Male", "Name": "Surya"}}
        ]
    },
    "ta-SG": {
        "language": "Tamil (Singapore)",
        "voices": [
            {"ta-SG-AnbuNeural": {"Gender": "Male", "Name": "Anbu"}},
            {"ta-SG-VenbaNeural": {"Gender": "Female", "Name": "Venba"}}
        ]
    },
    "te-IN": {
        "language": "Telugu (India)",
        "voices": [
            {"te-IN-MohanNeural": {"Gender": "Male", "Name": "Mohan"}},
            {"te-IN-ShrutiNeural": {"Gender": "Female", "Name": "Shruti"}}
        ]
    },
    "th-TH": {
        "language": "Thai (Thailand)",
        "voices": [
            {"th-TH-NiwatNeural": {"Gender": "Male", "Name": "Niwat"}},
            {"th-TH-PremwadeeNeural": {"Gender": "Female", "Name": "Premwadee"}}
        ]
    },
    "tr-TR": {
        "language": "Turkish (Turkey)",
        "voices": [
            {"tr-TR-AhmetNeural": {"Gender": "Male", "Name": "Ahmet"}},
            {"tr-TR-EmelNeural": {"Gender": "Female", "Name": "Emel"}}
        ]
    },
    "uk-UA": {
        "language": "Ukrainian (Ukraine)",
        "voices": [
            {"uk-UA-OstapNeural": {"Gender": "Male", "Name": "Ostap"}},
            {"uk-UA-PolinaNeural": {"Gender": "Female", "Name": "Polina"}}
        ]
    },
    "ur-IN": {
        "language": "Urdu (India)",
        "voices": [
            {"ur-IN-GulNeural": {"Gender": "Female", "Name": "Gul"}},
            {"ur-IN-SalmanNeural": {"Gender": "Male", "Name": "Salman"}}
        ]
    },
    "ur-PK": {
        "language": "Urdu (Pakistan)",
        "voices": [
            {"ur-PK-AsadNeural": {"Gender": "Male", "Name": "Asad"}},
            {"ur-PK-UzmaNeural": {"Gender": "Female", "Name": "Uzma"}}
        ]
    },
    "uz-UZ": {
        "language": "Uzbek (Uzbekistan)",
        "voices": [
            {"uz-UZ-MadinaNeural": {"Gender": "Female", "Name": "Madina"}},
            {"uz-UZ-SardorNeural": {"Gender": "Male", "Name": "Sardor"}}
        ]
    },
    "vi-VN": {
        "language": "Vietnamese (Vietnam)",
        "voices": [
            {"vi-VN-HoaiMyNeural": {"Gender": "Female", "Name": "HoaiMy"}},
            {"vi-VN-NamMinhNeural": {"Gender": "Male", "Name": "NamMinh"}}
        ]
    },
    "zu-ZA": {
        "language": "Zulu (South Africa)",
        "voices": [
            {"zu-ZA-ThandoNeural": {"Gender": "Female", "Name": "Thando"}},
            {"zu-ZA-ThembaNeural": {"Gender": "Male", "Name": "Themba"}}
        ]
    }
}

def return_voice_name(name):
    for lang, data in voices.items():
        for voice in data['voices']:
            voice_name = list(voice.keys())[0]
            if voice[voice_name].get("Name") == name:
                return voice_name
    return None
# æ±‰åŒ–æ˜ å°„å­—å…¸
StyleMapping = {
    "cheerful": "æ„‰æ‚¦",
    "angry": "æ„¤æ€’",
    "chat": "èŠå¤©",
    "customerservice": "å®¢æœ",
    "empathetic": "åŒç†å¿ƒ",
    "excited": "å…´å¥‹",
    "friendly": "å‹å¥½",
    "hopeful": "æœ‰å¸Œæœ›çš„",
    "narration-professional": "ä¸“ä¸šå™è¿°",
    "newscast-casual": "æ–°é—»æ’­æŠ¥-ä¼‘é—²",
    "newscast-formal": "æ–°é—»æ’­æŠ¥-æ­£å¼",
    "newscast": "æ–°é—»æ’­æŠ¥",
    "sad": "æ‚²ä¼¤",
    "livecommercial":"å®æ—¶å¹¿å‘Š",
    "story":"æ•…äº‹",
    "shouting": "å–Šå«",
    "terrified": "å®³æ€•",
    "unfriendly": "ä¸å‹å¥½",
    "whispering": "è€³è¯­",
    "whisper": "è€³è¯­",
    "affectionate": "æ’’å¨‡",
    "calm": "å¹³é™",
    "disgruntled": "ä¸æ»¡",
    "embarrassed": "å°´å°¬",
    "fearful": "å®³æ€•",
    "gentle": "æ¸©æŸ”",
    "serious": "ä¸¥è‚ƒ",
    "assistant": "åŠ©æ‰‹",
    "chat-casual": "èŠå¤©-ä¼‘é—²",
    "lyrical": "æŠ’æƒ…",
    "poetry-reading": "è¯—æ­Œæœ—è¯µ",
    "sorry": "æŠ±æ­‰",
    "advertisement-upbeat": "å¹¿å‘Š-ç§¯æ",
    "depressed": "æ²®ä¸§",
    "envious": "å«‰å¦’",
    "documentary-narration": "çºªå½•ç‰‡å™è¿°",
    "narration-relaxed": "å™è¿°-æ”¾æ¾",
    "sports-commentary": "ä½“è‚²è¯„è®º",
    "sports-commentary-excited": "ä½“è‚²è¯„è®º-å…´å¥‹"
}
NameTypeMapping = {
    "å¥³æ€§": "Female",
    "ç”·æ€§": "Male",
    "å„¿ç«¥": "Child",
    "ä¸­æ€§": "Neutral"
}
def translate_styles_to_chinese(style_code):
    return StyleMapping.get(style_code, style_code)

def get_original_style(chinese_style):
    for eng, chi in StyleMapping.items():
        if chi == chinese_style:
            return eng
    return chinese_style

for cn, en in NameTypeMapping.items():
    if items["LangEnCheckBox"].Checked:
        items["NameTypeCombo"].AddItem(en)  # é€‰ä¸­æ—¶æ·»åŠ è‹±æ–‡
    else:
        items["NameTypeCombo"].AddItem(cn)  # æœªé€‰ä¸­æ—¶æ·»åŠ ä¸­æ–‡

Multilinguals = {
    "Multilingual1": {
        "names": [
            "en-US-AndrewMultilingualNeural (Male)", "en-US-AvaMultilingualNeural (Female)", "en-US-BrianMultilingualNeural (Male)", 
            "en-US-EmmaMultilingualNeural (Female)", "en-GB-AdaMultilingualNeural (Female)", "en-GB-OllieMultilingualNeural (Male)", 
            "de-DE-SeraphinaMultilingualNeural (Female)", "de-DE-FlorianMultilingualNeural (Male)", "es-ES-IsidoraMultilingualNeural (Female)", 
            "es-ES-ArabellaMultilingualNeural (Female)", "fr-FR-VivienneMultilingualNeural (Female)", "fr-FR-RemyMultilingualNeural (Male)", 
            "it-IT-IsabellaMultilingualNeural (Female)", "it-IT-MarcelloMultilingualNeural (Male)", "it-IT-AlessioMultilingualNeural (Male)", 
            "ja-JP-MasaruMultilingualNeural (Male)", "pt-BR-ThalitaMultilingualNeural (Female)", "zh-CN-XiaoxiaoMultilingualNeural (Female)", 
            "zh-CN-XiaochenMultilingualNeural (Female)", "zh-CN-XiaoyuMultilingualNeural","zh-CN-YunyiMultilingualNeural (Male)","zh-CN-YunfanMultilingualNeural (Male)",
            "zh-CN-YunxiaoMultilingualNeural (Male)"
        ],
        "languages": {
            "af-ZA", "sq-AL", "am-ET", "ar-EG", "ar-SA", "hy-AM", "az-AZ", "eu-ES", "bn-IN", "bs-BA", "bg-BG", "my-MM", "ca-ES", "zh-HK", 
            "zh-CN", "zh-TW", "hr-HR", "cs-CZ", "da-DK", "nl-BE", "nl-NL", "en-AU", "en-CA", "en-HK", "en-IN", "en-IE", "en-GB", "en-US", 
            "et-EE", "fil-PH", "fi-FI", "fr-BE", "fr-CA", "fr-FR", "fr-CH", "gl-ES", "ka-GE", "de-AT", "de-DE", "de-CH", "el-GR", "he-IL", 
            "hi-IN", "hu-HU", "is-IS", "id-ID", "ga-IE", "it-IT", "ja-JP", "jv-ID", "kn-IN", "kk-KZ", "km-KH", "ko-KR", "lo-LA", "lv-LV", 
            "lt-LT", "mk-MK", "ms-MY", "ml-IN", "mt-MT", "mn-MN", "ne-NP", "nb-NO", "ps-AF", "fa-IR", "pl-PL", "pt-BR", "pt-PT", "ro-RO", 
            "ru-RU", "sr-RS", "si-LK", "sk-SK", "sl-SI", "so-SO", "es-MX", "es-ES", "su-ID", "sw-KE", "sv-SE", "ta-IN", "te-IN", "th-TH", 
            "tr-TR", "uk-UA", "ur-PK", "uz-UZ", "vi-VN", "cy-GB", "zu-ZA"
        }
    },
    "Multilingual2": {
        "names": [
            "en-US-AlloyMultilingualNeural (Male)", "en-US-EchoMultilingualNeural (Male)", "en-US-FableMultilingualNeural (Neutral)", 
            "en-US-OnyxMultilingualNeural (Male)", "en-US-NovaMultilingualNeural (Female)", "en-US-ShimmerMultilingualNeural (Female)", 
            "en-US-AlloyMultilingualNeuralHD (Male)", "en-US-EchoMultilingualNeuralHD (Male)", "en-US-FableMultilingualNeuralHD (Neutral)", 
            "en-US-OnyxMultilingualNeuralHD (Male)", "en-US-NovaMultilingualNeuralHD (Female)", "en-US-ShimmerMultilingualNeuralHD (Female)"
        ],
        "languages": {
            "af-ZA", "ar-EG", "hy-AM", "az-AZ", "be-BY", "bs-BA", "bg-BG", "ca-ES", "zh-CN", "hr-HR", "cs-CZ", "da-DK", "nl-NL", "en-US", 
            "et-EE", "fi-FI", "fr-FR", "gl-ES", "de-DE", "el-GR", "he-IL", "hi-IN", "hu-HU", "is-IS", "id-ID", "it-IT", "ja-JP", "kn-IN", 
            "kk-KZ", "ko-KR", "lv-LV", "lt-LT", "mk-MK", "ms-MY", "mr-IN", "mi-NZ", "ne-NP", "nb-NO", "fa-IR", "pl-PL", "pt-BR", "ro-RO", 
            "ru-RU", "sr-RS", "sk-SK", "sl-SI", "es-ES", "sw-KE", "sv-SE", "fil-PH", "ta-IN", "th-TH", "tr-TR", "uk-UA", "ur-PK", "vi-VN", 
            "cy-GB"
        }
    },
    "Multilingual3": {
        "names": ["en-US-JennyMultilingualNeural (Female)", "en-US-RyanMultilingualNeural (Male)"],
        "languages": {
            "ar-EG", "ar-SA", "ca-ES", "zh-HK", "zh-CN", "zh-TW", "cs-CZ", "da-DK", "nl-BE", "nl-NL", "en-AU", "en-CA", "en-HK", "en-IN", 
            "en-IE", "en-GB", "en-US", "fi-FI", "fr-BE", "fr-CA", "fr-FR", "fr-CH", "de-AT", "de-DE", "de-CH", "hi-IN", "hu-HU", "id-ID", 
            "it-IT", "ja-JP", "ko-KR", "nb-NO", "pl-PL", "pt-BR", "pt-PT", "ru-RU", "es-MX", "es-ES", "sv-SE", "th-TH", "tr-TR"
        }
    }
}

lang_translation = {
    "af-ZA": "å—éè¯­ï¼ˆå—éï¼‰",
    "sq-AL": "é˜¿å°”å·´å°¼äºšè¯­ï¼ˆé˜¿å°”å·´å°¼äºšï¼‰",
    "am-ET": "é˜¿å§†å“ˆæ‹‰è¯­ï¼ˆåŸƒå¡ä¿„æ¯”äºšï¼‰",
    "ar-EG": "é˜¿æ‹‰ä¼¯è¯­ï¼ˆåŸƒåŠï¼‰",
    "ar-SA": "é˜¿æ‹‰ä¼¯è¯­ï¼ˆæ²™ç‰¹é˜¿æ‹‰ä¼¯ï¼‰",
    "hy-AM": "äºšç¾å°¼äºšè¯­ï¼ˆäºšç¾å°¼äºšï¼‰",
    "az-AZ": "é˜¿å¡æ‹œç–†è¯­ï¼ˆé˜¿å¡æ‹œç–†ï¼‰",
    "eu-ES": "å·´æ–¯å…‹è¯­ï¼ˆè¥¿ç­ç‰™ï¼‰",
    "bn-IN": "å­ŸåŠ æ‹‰è¯­ï¼ˆå°åº¦ï¼‰",
    "bs-BA": "æ³¢æ–¯å°¼äºšè¯­ï¼ˆæ³¢æ–¯å°¼äºšå’Œé»‘å¡å“¥ç»´é‚£ï¼‰",
    "bg-BG": "ä¿åŠ åˆ©äºšè¯­ï¼ˆä¿åŠ åˆ©äºšï¼‰",
    "my-MM": "ç¼…ç”¸è¯­ï¼ˆç¼…ç”¸ï¼‰",
    "ca-ES": "åŠ æ³°ç½—å°¼äºšè¯­ï¼ˆè¥¿ç­ç‰™ï¼‰",
    "zh-HK": "ä¸­æ–‡ï¼ˆé¦™æ¸¯ï¼‰",
    "zh-CN": "ä¸­æ–‡ï¼ˆç®€ä½“ï¼Œä¸­å›½ï¼‰",
    "zh-TW": "ä¸­æ–‡ï¼ˆç¹ä½“ï¼Œå°æ¹¾ï¼‰",
    "hr-HR": "å…‹ç½—åœ°äºšè¯­ï¼ˆå…‹ç½—åœ°äºšï¼‰",
    "cs-CZ": "æ·å…‹è¯­ï¼ˆæ·å…‹ï¼‰",
    "da-DK": "ä¸¹éº¦è¯­ï¼ˆä¸¹éº¦ï¼‰",
    "nl-BE": "è·å…°è¯­ï¼ˆæ¯”åˆ©æ—¶ï¼‰",
    "nl-NL": "è·å…°è¯­ï¼ˆè·å…°ï¼‰",
    "en-AU": "è‹±è¯­ï¼ˆæ¾³å¤§åˆ©äºšï¼‰",
    "en-CA": "è‹±è¯­ï¼ˆåŠ æ‹¿å¤§ï¼‰",
    "en-HK": "è‹±è¯­ï¼ˆé¦™æ¸¯ï¼‰",
    "en-IN": "è‹±è¯­ï¼ˆå°åº¦ï¼‰",
    "en-IE": "è‹±è¯­ï¼ˆçˆ±å°”å…°ï¼‰",
    "en-GB": "è‹±è¯­ï¼ˆè‹±å›½ï¼‰",
    "en-US": "è‹±è¯­ï¼ˆç¾å›½ï¼‰",
    "et-EE": "çˆ±æ²™å°¼äºšè¯­ï¼ˆçˆ±æ²™å°¼äºšï¼‰",
    "fil-PH": "è²å¾‹å®¾è¯­ï¼ˆè²å¾‹å®¾ï¼‰",
    "fi-FI": "èŠ¬å…°è¯­ï¼ˆèŠ¬å…°ï¼‰",
    "fr-BE": "æ³•è¯­ï¼ˆæ¯”åˆ©æ—¶ï¼‰",
    "fr-CA": "æ³•è¯­ï¼ˆåŠ æ‹¿å¤§ï¼‰",
    "fr-FR": "æ³•è¯­ï¼ˆæ³•å›½ï¼‰",
    "fr-CH": "æ³•è¯­ï¼ˆç‘å£«ï¼‰",
    "gl-ES": "åŠ åˆ©è¥¿äºšè¯­ï¼ˆè¥¿ç­ç‰™ï¼‰",
    "ka-GE": "æ ¼é²å‰äºšè¯­ï¼ˆæ ¼é²å‰äºšï¼‰",
    "de-AT": "å¾·è¯­ï¼ˆå¥¥åœ°åˆ©ï¼‰",
    "de-DE": "å¾·è¯­ï¼ˆå¾·å›½ï¼‰",
    "de-CH": "å¾·è¯­ï¼ˆç‘å£«ï¼‰",
    "el-GR": "å¸Œè…Šè¯­ï¼ˆå¸Œè…Šï¼‰",
    "he-IL": "å¸Œä¼¯æ¥è¯­ï¼ˆä»¥è‰²åˆ—ï¼‰",
    "hi-IN": "å°åœ°è¯­ï¼ˆå°åº¦ï¼‰",
    "hu-HU": "åŒˆç‰™åˆ©è¯­ï¼ˆåŒˆç‰™åˆ©ï¼‰",
    "is-IS": "å†°å²›è¯­ï¼ˆå†°å²›ï¼‰",
    "id-ID": "å°åº¦å°¼è¥¿äºšè¯­ï¼ˆå°åº¦å°¼è¥¿äºšï¼‰",
    "ga-IE": "çˆ±å°”å…°è¯­ï¼ˆçˆ±å°”å…°ï¼‰",
    "it-IT": "æ„å¤§åˆ©è¯­ï¼ˆæ„å¤§åˆ©ï¼‰",
    "ja-JP": "æ—¥è¯­ï¼ˆæ—¥æœ¬ï¼‰",
    "jv-ID": "çˆªå“‡è¯­ï¼ˆå°åº¦å°¼è¥¿äºšï¼‰",
    "kn-IN": "å¡çº³è¾¾è¯­ï¼ˆå°åº¦ï¼‰",
    "kk-KZ": "å“ˆè¨å…‹è¯­ï¼ˆå“ˆè¨å…‹æ–¯å¦ï¼‰",
    "km-KH": "é«˜æ£‰è¯­ï¼ˆæŸ¬åŸ”å¯¨ï¼‰",
    "ko-KR": "éŸ©è¯­ï¼ˆéŸ©å›½ï¼‰",
    "lo-LA": "è€æŒè¯­ï¼ˆè€æŒï¼‰",
    "lv-LV": "æ‹‰è„±ç»´äºšè¯­ï¼ˆæ‹‰è„±ç»´äºšï¼‰",
    "lt-LT": "ç«‹é™¶å®›è¯­ï¼ˆç«‹é™¶å®›ï¼‰",
    "mk-MK": "é©¬å…¶é¡¿è¯­ï¼ˆåŒ—é©¬å…¶é¡¿ï¼‰",
    "ms-MY": "é©¬æ¥è¯­ï¼ˆé©¬æ¥è¥¿äºšï¼‰",
    "ml-IN": "é©¬æ‹‰é›…æ‹‰å§†è¯­ï¼ˆå°åº¦ï¼‰",
    "mt-MT": "é©¬è€³ä»–è¯­ï¼ˆé©¬è€³ä»–ï¼‰",
    "mn-MN": "è’™å¤è¯­ï¼ˆè’™å¤ï¼‰",
    "ne-NP": "å°¼æ³Šå°”è¯­ï¼ˆå°¼æ³Šå°”ï¼‰",
    "nb-NO": "æŒªå¨è¯­ï¼ˆæŒªå¨ï¼‰",
    "ps-AF": "æ™®ä»€å›¾è¯­ï¼ˆé˜¿å¯Œæ±—ï¼‰",
    "fa-IR": "æ³¢æ–¯è¯­ï¼ˆä¼Šæœ—ï¼‰",
    "pl-PL": "æ³¢å…°è¯­ï¼ˆæ³¢å…°ï¼‰",
    "pt-BR": "è‘¡è„ç‰™è¯­ï¼ˆå·´è¥¿ï¼‰",
    "pt-PT": "è‘¡è„ç‰™è¯­ï¼ˆè‘¡è„ç‰™ï¼‰",
    "ro-RO": "ç½—é©¬å°¼äºšè¯­ï¼ˆç½—é©¬å°¼äºšï¼‰",
    "ru-RU": "ä¿„è¯­ï¼ˆä¿„ç½—æ–¯ï¼‰",
    "sr-RS": "å¡å°”ç»´äºšè¯­ï¼ˆå¡å°”ç»´äºšï¼‰",
    "si-LK": "åƒ§ä¼½ç½—è¯­ï¼ˆæ–¯é‡Œå…°å¡ï¼‰",
    "sk-SK": "æ–¯æ´›ä¼å…‹è¯­ï¼ˆæ–¯æ´›ä¼å…‹ï¼‰",
    "sl-SI": "æ–¯æ´›æ–‡å°¼äºšè¯­ï¼ˆæ–¯æ´›æ–‡å°¼äºšï¼‰",
    "so-SO": "ç´¢é©¬é‡Œè¯­ï¼ˆç´¢é©¬é‡Œï¼‰",
    "es-MX": "è¥¿ç­ç‰™è¯­ï¼ˆå¢¨è¥¿å“¥ï¼‰",
    "es-ES": "è¥¿ç­ç‰™è¯­ï¼ˆè¥¿ç­ç‰™ï¼‰",
    "su-ID": "å·½ä»–è¯­ï¼ˆå°åº¦å°¼è¥¿äºšï¼‰",
    "sw-KE": "æ–¯ç“¦å¸Œé‡Œè¯­ï¼ˆè‚¯å°¼äºšï¼‰",
    "sv-SE": "ç‘å…¸è¯­ï¼ˆç‘å…¸ï¼‰",
    "ta-IN": "æ³°ç±³å°”è¯­ï¼ˆå°åº¦ï¼‰",
    "te-IN": "æ³°å¢å›ºè¯­ï¼ˆå°åº¦ï¼‰",
    "th-TH": "æ³°è¯­ï¼ˆæ³°å›½ï¼‰",
    "tr-TR": "åœŸè€³å…¶è¯­ï¼ˆåœŸè€³å…¶ï¼‰",
    "uk-UA": "ä¹Œå…‹å…°è¯­ï¼ˆä¹Œå…‹å…°ï¼‰",
    "ur-PK": "ä¹Œå°”éƒ½è¯­ï¼ˆå·´åŸºæ–¯å¦ï¼‰",
    "uz-UZ": "ä¹Œå…¹åˆ«å…‹è¯­ï¼ˆä¹Œå…¹åˆ«å…‹æ–¯å¦ï¼‰",
    "vi-VN": "è¶Šå—è¯­ï¼ˆè¶Šå—ï¼‰",
    "cy-GB": "å¨å°”å£«è¯­ï¼ˆè‹±å›½ï¼‰",
    "zu-ZA": "ç¥–é²è¯­ï¼ˆå—éï¼‰"
}

def switch_language(lang):
    """
    æ ¹æ® lang (å¯å– 'cn' æˆ– 'en') åˆ‡æ¢æ‰€æœ‰æ§ä»¶çš„æ–‡æœ¬
    """
    items["NameTypeCombo"].Clear()
    items["minimaxVoiceCombo"].Clear()
    items["minimaxLanguageCombo"].Clear()
    items["minimaxEmotionCombo"].Clear()

    if "MyTabs" in items:
        for index, new_name in enumerate(translations[lang]["Tabs"]):
            items["MyTabs"].SetTabText(index, new_name)

    for item_id, text_value in translations[lang].items():
        # ç¡®ä¿ items[item_id] å­˜åœ¨ï¼Œå¦åˆ™ä¼šæŠ¥ KeyError
        if item_id == "Tabs":
            continue
        if item_id in items:
            items[item_id].Text = text_value
        elif item_id in azure_items:
            azure_items[item_id].Text = text_value
        elif item_id in minimax_items:    
            minimax_items[item_id].Text = text_value
        else:
            print(f"[Warning] items ä¸­ä¸å­˜åœ¨ ID ä¸º {item_id} çš„æ§ä»¶ï¼Œæ— æ³•è®¾ç½®æ–‡æœ¬ï¼")

    for cn, en in NameTypeMapping.items():
        if items["LangEnCheckBox"].Checked:
            items["NameTypeCombo"].AddItem(en)  # é€‰ä¸­æ—¶æ·»åŠ è‹±æ–‡
        else:
            items["NameTypeCombo"].AddItem(cn)  # æœªé€‰ä¸­æ—¶æ·»åŠ ä¸­æ–‡

    for cn, en in emotions:
        if items["LangEnCheckBox"].Checked:
            items["minimaxEmotionCombo"].AddItem(en)  # é€‰ä¸­æ—¶æ·»åŠ è‹±æ–‡
        else:
            items["minimaxEmotionCombo"].AddItem(cn)  # æœªé€‰ä¸­æ—¶æ·»åŠ ä¸­æ–‡
    
    for cn, en in minimax_voices:
        if items["LangEnCheckBox"].Checked:
            items["minimaxVoiceCombo"].AddItem(en)  # é€‰ä¸­æ—¶æ·»åŠ è‹±æ–‡
        else:
            items["minimaxVoiceCombo"].AddItem(cn)  # æœªé€‰ä¸­æ—¶æ·»åŠ ä¸­æ–‡    
    for cn, en in minimax_language:
        if items["LangEnCheckBox"].Checked:
            items["minimaxLanguageCombo"].AddItem(en)  
        else:
            items["minimaxLanguageCombo"].AddItem(cn)     

def on_cn_checkbox_clicked(ev):
    items["LangEnCheckBox"].Checked = not items["LangCnCheckBox"].Checked
    if items["LangEnCheckBox"].Checked:
        switch_language("en")
        print("en")
    else:
        print("cn")
        switch_language("cn")
win.On.LangCnCheckBox.Clicked = on_cn_checkbox_clicked

def on_en_checkbox_clicked(ev):
    items["LangCnCheckBox"].Checked = not items["LangEnCheckBox"].Checked
    if items["LangEnCheckBox"].Checked:
        switch_language("en")
        print("en")
    else:
        print("cn")
        switch_language("cn")
win.On.LangEnCheckBox.Clicked = on_en_checkbox_clicked

def update_name_combo(items, lang, voice_dict):
    items["NameCombo"].Clear()
    selected_type = get_english_name_type(items["NameTypeCombo"].CurrentText)
    matching_voices = []
    for voice in voice_dict[lang]['voices']:
        voice_name = list(voice.keys())[0]
        voice_gender = voice[voice_name]["Gender"]
        if selected_type in voice_gender:
            display_name = voice[voice_name].get("Name", voice_name)
            matching_voices.append(display_name)
    for display_name in matching_voices:
        items["NameCombo"].AddItem(display_name)  

# ä»ä¿å­˜çš„è®¾ç½®ä¸­è®¾ç½® UnuseAPICheckBox çš„çŠ¶æ€
if saved_settings:
    azure_items["UnuseAPICheckBox"].Checked = saved_settings.get("UNUSE_API", default_settings["UNUSE_API"])
    items["LangCnCheckBox"].Checked = saved_settings.get("CN", default_settings["CN"])
    items["LangEnCheckBox"].Checked = saved_settings.get("EN", default_settings["EN"])

if items["LangEnCheckBox"].Checked :
    switch_language("en")
else:
    switch_language("cn")



def get_english_name_type(chinese_name_type):
    return NameTypeMapping.get(chinese_name_type, chinese_name_type)

audio_formats = {
    "8k, .wav": speechsdk.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm,
    "16k, .wav": speechsdk.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm,
    "24k, .wav": speechsdk.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm,
    "48k, .wav": speechsdk.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm,
   # "16k, .mp3": speechsdk.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3,
   # "24k, .mp3": speechsdk.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3,
   # "48k, .mp3": speechsdk.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3
}

for fmt in audio_formats.keys():
    items["OutputFormatCombo"].AddItem(fmt)

# æ ¹æ® UnuseAPICheckBox çš„çŠ¶æ€å®šä¹‰ voice_dict
voice_dict = {}

if azure_items["UnuseAPICheckBox"].Checked:
    voice_dict = edgeTTS_voices
else:
    voice_dict = voices

Language = [voice_dict[locale]['language'] for locale in voice_dict.keys()]

for language in Language:
    items["LanguageCombo"].AddItem(language)

if saved_settings:
    azure_items["ApiKey"].Text = saved_settings.get("API_KEY", default_settings["API_KEY"])
    azure_items["Region"].Text = saved_settings.get("REGION", default_settings["REGION"])
    items["Path"].Text = saved_settings.get("OUTPUT_DIRECTORY", default_settings["OUTPUT_DIRECTORY"])
    items["LanguageCombo"].CurrentIndex = saved_settings.get("LANGUAGE", default_settings["LANGUAGE"])
    items["NameTypeCombo"].CurrentIndex = saved_settings.get("TYPE", default_settings["TYPE"])
    items["NameCombo"].CurrentIndex = saved_settings.get("NAME", default_settings["NAME"])
    items["RateSpinBox"].Value = saved_settings.get("RATE", default_settings["RATE"])
    items["PitchSpinBox"].Value = saved_settings.get("PITCH", default_settings["PITCH"])
    items["VolumeSpinBox"].Value = saved_settings.get("VOLUME", default_settings["VOLUME"])
    items["StyleCombo"].CurrentIndex = saved_settings.get("STYLE", default_settings["STYLE"])
    items["StyleDegreeSpinBox"].Value = saved_settings.get("STYLEDEGREE", default_settings["STYLEDEGREE"])
    items["OutputFormatCombo"].CurrentIndex = saved_settings.get("OUTPUT_FORMATS", default_settings["OUTPUT_FORMATS"])

    minimax_items["minimaxApiKey"].Text = saved_settings.get("minimax_API_KEY", default_settings["minimax_API_KEY"])
    minimax_items["minimaxGroupID"].Text = saved_settings.get("minimax_GROUP_ID", default_settings["minimax_GROUP_ID"])
    minimax_items["intlCheckBox"].Checked = saved_settings.get("minimax_intlCheckBox", default_settings["minimax_intlCheckBox"])
    items["Path"].Text = saved_settings.get("Path", default_settings["Path"])
    items["minimaxModelCombo"].CurrentIndex = saved_settings.get("minimax_Model", default_settings["minimax_Model"])
    items["minimaxVoiceCombo"].CurrentIndex= saved_settings.get("minimax_Voice", default_settings["minimax_Voice"])
    items["minimaxLanguageCombo"].CurrentIndex= saved_settings.get("minimax_Language", default_settings["minimax_Language"])
    items["minimaxSubtitleCheckBox"].Checked = saved_settings.get("minimax_SubtitleCheckBox", default_settings["minimax_SubtitleCheckBox"])
    items["minimaxEmotionCombo"].CurrentIndex = saved_settings.get("minimax_Emotion", default_settings["minimax_Emotion"])
    items["minimaxRateSpinBox"].Value = saved_settings.get("minimax_Rate", default_settings["minimax_Rate"])
    items["minimaxVolumeSpinBox"].Value = saved_settings.get("minimax_Volume", default_settings["minimax_Volume"])
    items["minimaxPitchSpinBox"].Value = saved_settings.get("minimax_Pitch", default_settings["minimax_Pitch"])
    items["minimaxFormatCombo"].SetCurrentText(saved_settings.get("minimax_Format", default_settings["minimax_Format"]))
    
def flagmark():
    global flag
    flag = True
def on_outputformat_combo_current_index_changed(ev):
    flagmark()
win.On.OutputFormatCombo.CurrentIndexChanged = on_outputformat_combo_current_index_changed

def on_multilingual_combo_current_index_changed(ev):
    flagmark()
win.On.MultilingualCombo.CurrentIndexChanged = on_multilingual_combo_current_index_changed

def on_style_combo_current_index_changed(ev):
    flagmark()
win.On.StyleCombo.CurrentIndexChanged = on_style_combo_current_index_changed


# å®šä¹‰ä¸€ä¸ªé€šç”¨çš„æ›´æ–°å‡½æ•°
def handle_value_change(ev, last_update_time, update_interval, from_widget, to_widget, multiplier=1.0):
    current_time = time.time()
    if current_time - last_update_time < update_interval:
        return last_update_time
    flagmark()
    value = round(ev['Value'] * multiplier, 2)
    items[to_widget].Value = value
    return current_time

# å®šä¹‰å…¨å±€å˜é‡
last_updates = {
    "style_degree": 0,
    "rate": 0,
    "pitch": 0,
    "volume": 0
}
update_intervals = {
    "style_degree": 0.1,
    "rate": 0.1,
    "pitch": 0.1,
    "volume": 0.1
}
# é€Ÿç‡ Slider å’Œ SpinBox äº‹ä»¶å¤„ç†
def on_minimax_rate_slider_value_changed(ev):
    last_updates["rate"] = handle_value_change(ev, last_updates["rate"], update_intervals["rate"], "minimaxRateSlider", "minimaxRateSpinBox", 1/100.0)
win.On.minimaxRateSlider.ValueChanged = on_minimax_rate_slider_value_changed

def on_minimax_rate_spinbox_value_changed(ev):
    last_updates["rate"] = handle_value_change(ev, last_updates["rate"], update_intervals["rate"], "minimaxRateSpinBox", "minimaxRateSlider", 100)
win.On.minimaxRateSpinBox.ValueChanged = on_minimax_rate_spinbox_value_changed

# éŸ³è°ƒ Slider å’Œ SpinBox äº‹ä»¶å¤„ç†
def on_minimax_pitch_slider_value_changed(ev):
    last_updates["pitch"] = handle_value_change(ev, last_updates["pitch"], update_intervals["pitch"], "minimaxPitchSlider", "minimaxPitchSpinBox", 1/100.0)
win.On.minimaxPitchSlider.ValueChanged = on_minimax_pitch_slider_value_changed

def on_minimax_pitch_spinbox_value_changed(ev):
    last_updates["pitch"] = handle_value_change(ev, last_updates["pitch"], update_intervals["pitch"], "minimaxPitchSpinBox", "minimaxPitchSlider", 100)
win.On.minimaxPitchSpinBox.ValueChanged = on_minimax_pitch_spinbox_value_changed

# éŸ³é‡ Slider å’Œ SpinBox äº‹ä»¶å¤„ç†
def on_minimax_volume_slider_value_changed(ev):
    last_updates["volume"] = handle_value_change(ev, last_updates["volume"], update_intervals["volume"], "minimaxVolumeSlider", "minimaxVolumeSpinBox", 1/100.0)
win.On.minimaxVolumeSlider.ValueChanged = on_minimax_volume_slider_value_changed

def on_minimax_volume_spinbox_value_changed(ev):
    last_updates["volume"] = handle_value_change(ev, last_updates["volume"], update_intervals["volume"], "minimaxVolumeSpinBox", "minimaxVolumeSlider", 100)
win.On.minimaxVolumeSpinBox.ValueChanged = on_minimax_volume_spinbox_value_changed

# æ ·å¼åº¦ Slider å’Œ SpinBox äº‹ä»¶å¤„ç†
def on_style_degree_slider_value_changed(ev):
    last_updates["style_degree"] = handle_value_change(ev, last_updates["style_degree"], update_intervals["style_degree"], "StyleDegreeSlider", "StyleDegreeSpinBox", 1/100.0)
win.On.StyleDegreeSlider.ValueChanged = on_style_degree_slider_value_changed

def on_style_degree_spinbox_value_changed(ev):
    last_updates["style_degree"] = handle_value_change(ev, last_updates["style_degree"], update_intervals["style_degree"], "StyleDegreeSpinBox", "StyleDegreeSlider", 100)
win.On.StyleDegreeSpinBox.ValueChanged = on_style_degree_spinbox_value_changed

# é€Ÿç‡ Slider å’Œ SpinBox äº‹ä»¶å¤„ç†
def on_rate_slider_value_changed(ev):
    last_updates["rate"] = handle_value_change(ev, last_updates["rate"], update_intervals["rate"], "RateSlider", "RateSpinBox", 1/100.0)
win.On.RateSlider.ValueChanged = on_rate_slider_value_changed

def on_rate_spinbox_value_changed(ev):
    last_updates["rate"] = handle_value_change(ev, last_updates["rate"], update_intervals["rate"], "RateSpinBox", "RateSlider", 100)
win.On.RateSpinBox.ValueChanged = on_rate_spinbox_value_changed

# éŸ³è°ƒ Slider å’Œ SpinBox äº‹ä»¶å¤„ç†
def on_pitch_slider_value_changed(ev):
    last_updates["pitch"] = handle_value_change(ev, last_updates["pitch"], update_intervals["pitch"], "PitchSlider", "PitchSpinBox", 1/100.0)
win.On.PitchSlider.ValueChanged = on_pitch_slider_value_changed

def on_pitch_spinbox_value_changed(ev):
    last_updates["pitch"] = handle_value_change(ev, last_updates["pitch"], update_intervals["pitch"], "PitchSpinBox", "PitchSlider", 100)
win.On.PitchSpinBox.ValueChanged = on_pitch_spinbox_value_changed

# éŸ³é‡ Slider å’Œ SpinBox äº‹ä»¶å¤„ç†
def on_volume_slider_value_changed(ev):
    last_updates["volume"] = handle_value_change(ev, last_updates["volume"], update_intervals["volume"], "VolumeSlider", "VolumeSpinBox", 1/100.0)
win.On.VolumeSlider.ValueChanged = on_volume_slider_value_changed

def on_volume_spinbox_value_changed(ev):
    last_updates["volume"] = handle_value_change(ev, last_updates["volume"], update_intervals["volume"], "VolumeSpinBox", "VolumeSlider", 100)
win.On.VolumeSpinBox.ValueChanged = on_volume_spinbox_value_changed

def on_my_tabs_current_changed(ev):
    items["MyStack"].CurrentIndex = ev["Index"]
win.On.MyTabs.CurrentChanged = on_my_tabs_current_changed

def on_subtitle_text_changed(ev):
    flagmark()
    global stream
    stream = None
win.On.AzureTxt.TextChanged = on_subtitle_text_changed

def on_unuseapi_checkbox_clicked(ev):
    global voice_dict,Language
    items["LanguageCombo"].Clear()
    if azure_items["UnuseAPICheckBox"].Checked:
        toggle_api_checkboxes(False)
        voice_dict = edgeTTS_voices
    else:
        toggle_api_checkboxes(True)
        voice_dict = voices
    Language = [voice_dict[locale]['language'] for locale in voice_dict.keys()]
    for language in Language:
        items["LanguageCombo"].AddItem(language)
    update_name_combo(items, lang, voice_dict)
azure_config_window.On.UnuseAPICheckBox.Clicked = on_unuseapi_checkbox_clicked

def on_language_combo_current_index_changed(ev):
    flagmark()
    global lang
    lang_index = items["LanguageCombo"].CurrentIndex
    if lang_index == 0 and not azure_items["UnuseAPICheckBox"].Checked:
        items["AlphabetButton"].Enabled = True
    else:
        items["AlphabetButton"].Enabled = False
    selected_language = Language[lang_index]
    lang = next(locale for locale, data in voice_dict.items() if data['language'] == selected_language)
    update_name_combo(items, lang, voice_dict)
win.On.LanguageCombo.CurrentIndexChanged = on_language_combo_current_index_changed

def on_name_combo_current_index_changed(ev):
    flagmark()
    items["StyleCombo"].Clear()
    items["StyleCombo"].AddItem('Default')
    items["StyleCombo"].Enabled = False
    items["MultilingualCombo"].Clear()
    items["MultilingualCombo"].AddItem('Default')
    items["MultilingualCombo"].Enabled = False
    if azure_items["UnuseAPICheckBox"].Checked:
        return
    
    selected_voice = return_voice_name(items["NameCombo"].CurrentText)
    
    # æŸ¥æ‰¾å¹¶æ›´æ–°é£æ ¼é€‰é¡¹
    found_voice = False
    valid_styles = False
    for voice_locale, locale_data in voices.items():
        for voice_dict in locale_data["voices"]:
            if selected_voice in voice_dict:
                found_voice = True
                voice_info = voice_dict[selected_voice]
                styles = voice_info.get("Styles", [])  # å®‰å…¨è·å– Styles åˆ—è¡¨ï¼Œé¿å… KeyError
                # è¿‡æ»¤æ‰ç©ºå­—ç¬¦ä¸²
                filtered_styles = [style for style in styles if style.strip()]
                if filtered_styles:
                    valid_styles = True
                    items["StyleCombo"].Enabled = True  # æœ‰æœ‰æ•ˆé£æ ¼æ—¶å¯ç”¨ä¸‹æ‹‰èœå•
                    for style in filtered_styles:
                        if items["LangCnCheckBox"].Checked:
                            items["StyleCombo"].AddItem(StyleMapping.get(style, style))
                        else:
                            items["StyleCombo"].AddItem(style)    
                break  # æ‰¾åˆ°åç»ˆæ­¢å¾ªç¯
        if found_voice:
            break

    if not found_voice or not valid_styles:  # å¦‚æœæ²¡æœ‰æ‰¾åˆ°å£°éŸ³æˆ–æœ‰æ•ˆé£æ ¼ä¸ºç©º
        items["StyleCombo"].Enabled = False  # ç¦ç”¨é£æ ¼é€‰æ‹©

    if "Multilingual" in selected_voice:
        items["MultilingualCombo"].Enabled = True
        for group_name, data in Multilinguals.items():
            cleaned_names = [n.split(' (')[0] for n in data["names"]]
            if selected_voice in cleaned_names:
                print(group_name)
                for language in data["languages"]:
                    if items["LangCnCheckBox"].Checked:
                        items["MultilingualCombo"].AddItem(lang_translation.get(language, language))
                    else:
                        items["MultilingualCombo"].AddItem(language)
                break 
win.On.NameCombo.CurrentIndexChanged = on_name_combo_current_index_changed

def on_name_type_combo_current_index_changed(ev):
    flagmark()
    update_name_combo(items, lang, voice_dict)
win.On.NameTypeCombo.CurrentIndexChanged = on_name_type_combo_current_index_changed


if azure_items["UnuseAPICheckBox"].Checked:
    azure_items["ApiKey"].Enabled = False
    azure_items["Region"].Enabled = False
    items["StyleCombo"].Enabled = False
    items["MultilingualCombo"].Enabled = False
    items["PlayButton"].Enabled = False
    items["BreakButton"].Enabled = False
    items["AlphabetButton"].Enabled = False
    items["StyleDegreeSpinBox"].Enabled = False
    items["StyleDegreeSlider"].Enabled = False
    items["OutputFormatCombo"].Enabled = False

##frame_rate = float(current_project.GetSetting("timelineFrameRate"))

def get_subtitles(timeline):
    subtitles = []
    track_count = timeline.GetTrackCount("subtitle")
    print(f"Subtitle track count: {track_count}")

    for track_index in range(1, track_count + 1):
        track_enabled = timeline.GetIsTrackEnabled("subtitle", track_index)
        if track_enabled:
            subtitleTrackItems = timeline.GetItemListInTrack("subtitle", track_index)
            for item in subtitleTrackItems:
                try:
                    start_frame = item.GetStart()
                    end_frame = item.GetEnd()
                    text = item.GetName()
                    subtitles.append({'start': start_frame, 'end': end_frame, 'text': text})
                except Exception as e:
                    print(f"Error processing item: {e}")

    return subtitles

def get_subtitle_texts(subtitles):
    return "\n".join([subtitle['text'] for subtitle in subtitles])

def frame_to_timecode(frame, framerate):
    total_seconds = frame / framerate
    hours = int(total_seconds // 3600)
    minutes = int((total_seconds % 3600) // 60)
    seconds = int(total_seconds % 60)
    milliseconds = int((total_seconds % 1) * 1000)
    return f"{hours:02}:{minutes:02}:{seconds:02},{milliseconds:03}"

def timecode_to_frames(timecode, frame_rate):
    """
    å°†æ—¶é—´ç è½¬æ¢ä¸ºå¸§æ•°ã€‚
    å‚æ•°ï¼š
    - timecode: æ ¼å¼ä¸º 'hh:mm:ss;ff' æˆ– 'hh:mm:ss:ff' çš„æ—¶é—´ç ã€‚
    - frame_rate: æ—¶é—´çº¿çš„å¸§ç‡ã€‚
    è¿”å›å€¼ï¼š
    - å¯¹åº”æ—¶é—´ç çš„å¸§æ•°ã€‚
    """
    try:
        # æå–æ—¶é—´ç»„ä»¶
        match = re.match(r"^(\d{2}):(\d{2}):(\d{2})([:;])(\d{2,3})$", timecode)
        if not match:
            raise ValueError(f"Invalid timecode format: {timecode}")
        
        hours, minutes, seconds, separator, frames = match.groups()
        hours = int(hours)
        minutes = int(minutes)
        seconds = int(seconds)
        frames = int(frames)
        
        is_drop_frame = separator == ';'
        
        if is_drop_frame:
            # è®¡ç®—åä¹‰å¸§ç‡å’Œä¸¢å¸§æ•°
            if frame_rate in [23.976, 29.97, 59.94, 119.88]:
                nominal_frame_rate = round(frame_rate * 1000 / 1001)
                drop_frames = int(round(nominal_frame_rate / 15))
            else:
                raise ValueError(f"Unsupported drop frame rate: {frame_rate}")

            # æ€»åˆ†é’Ÿæ•°
            total_minutes = hours * 60 + minutes

            # è®¡ç®—æ€»çš„ä¸¢å¸§æ•°
            total_dropped_frames = drop_frames * (total_minutes - total_minutes // 10)

            # è®¡ç®—æ€»å¸§æ•°
            frame_count = ((hours * 3600) + (minutes * 60) + seconds) * nominal_frame_rate + frames
            frame_count -= total_dropped_frames

        else:
            # éä¸¢å¸§æ—¶é—´ç 
            if frame_rate in [23.976, 29.97, 47.952, 59.94, 95.904, 119.88]:
                nominal_frame_rate = round(frame_rate * 1000 / 1001)
            else:
                nominal_frame_rate = frame_rate

            frame_count = ((hours * 3600) + (minutes * 60) + seconds) * nominal_frame_rate + frames

        return frame_count

    except ValueError as e:
        print(f"Error converting timecode to frames: {e}")
        return None


def print_srt(subtitles, framerate):
    for index, subtitle in enumerate(subtitles):
        start_time = frame_to_timecode(subtitle['start'], framerate)
        end_time = frame_to_timecode(subtitle['end'], framerate)
        print(f"{index + 1}\n{start_time} --> {end_time}\n{subtitle['text']}\n")


def on_getsub_button_clicked(ev):
    frame_rate = float(current_project.GetSetting("timelineFrameRate"))
    subtitles = get_subtitles(current_timeline)
    subtitle_texts = get_subtitle_texts(subtitles)
    items["AzureTxt"].Text = subtitle_texts
    items["minimaxText"].Text = subtitle_texts
    print_srt(subtitles,frame_rate)
win.On.GetSubButton.Clicked = on_getsub_button_clicked
win.On.minimaxGetSubButton.Clicked = on_getsub_button_clicked
    
def process_text_with_breaks(parent, text):
    parts = text.split('<break')
    for i, part in enumerate(parts):
        if i == 0:
            handle_phoneme_and_text(parent, part.strip(), is_initial=True)
        else:
            end_idx = part.find('>')
            if end_idx != -1:
                break_tag = '<break' + part[:end_idx + 1]
                remaining_text = part[end_idx + 1:].strip()
                
                break_elem = ET.fromstring(break_tag)
                parent.append(break_elem)
                
                handle_phoneme_and_text(parent, remaining_text)

def handle_phoneme_and_text(parent, text, is_initial=False):
    phoneme_parts = text.split('<phoneme')
    for j, phoneme_part in enumerate(phoneme_parts):
        if j == 0:
            if is_initial:
                if parent.text:
                    parent.text += phoneme_part.strip()
                else:
                    parent.text = phoneme_part.strip()
            else:
                if parent[-1].tail:
                    parent[-1].tail += phoneme_part.strip()
                else:
                    parent[-1].tail = phoneme_part.strip()
        else:
            end_phoneme_idx = phoneme_part.find('</phoneme>')
            if end_phoneme_idx != -1:
                phoneme_end_tag = '</phoneme>'
                phoneme_start_idx = phoneme_part.find('>') + 1
                phoneme_tag = '<phoneme' + phoneme_part[:phoneme_start_idx]
                remaining_text = phoneme_part[phoneme_start_idx:end_phoneme_idx]
                tail_text = phoneme_part[end_phoneme_idx + len(phoneme_end_tag):].strip()
                
                phoneme_elem = ET.fromstring(phoneme_tag + remaining_text + phoneme_end_tag)
                parent.append(phoneme_elem)
                
                if tail_text:
                    if phoneme_elem.tail:
                        phoneme_elem.tail += tail_text
                    else:
                        phoneme_elem.tail = tail_text
            else:
                if parent[-1].tail:
                    parent[-1].tail += phoneme_part.strip()
                else:
                    parent[-1].tail = phoneme_part.strip()

def create_ssml(lang, voice_name, text, rate=None, pitch=None, volume=None, style=None, styledegree=None, multilingual = None):
    speak = ET.Element('speak', xmlns="http://www.w3.org/2001/10/synthesis", attrib={
        "xmlns:mstts": "http://www.w3.org/2001/mstts",
        "xmlns:emo": "http://www.w3.org/2009/10/emotionml",
        "version": "1.0",
        "xml:lang": f"{lang}"
    })
    voice = ET.SubElement(speak, 'voice', name=voice_name)
    if multilingual != None:
        lang_tag = ET.SubElement(voice, 'lang', attrib={"xml:lang": multilingual})
        parent_tag = lang_tag
    else:
        parent_tag = voice
    lines = text.split('\n')
    for line in lines:
        if line.strip():
            paragraph = ET.SubElement(parent_tag, 's')
            if style != "Default":
                express_as_attribs = {'style': style}
                if styledegree is not None and styledegree != 1.0:
                    express_as_attribs['styledegree'] = f"{styledegree:.2f}"
                express_as = ET.SubElement(paragraph, 'mstts:express-as', attrib=express_as_attribs)
                prosody_attrs = {}
                if rate is not None and rate != 1.0:
                    prosody_rate = f"+{(rate-1)*100:.2f}%" if rate > 1 else f"-{(1-rate)*100:.2f}%"
                    prosody_attrs['rate'] = prosody_rate
                if pitch is not None and pitch != 1.0:
                    prosody_pitch = f"+{(pitch-1)*100:.2f}%" if pitch > 1 else f"-{(1-pitch)*100:.2f}%"
                    prosody_attrs['pitch'] = prosody_pitch
                if volume is not None and volume != 1.0:
                    prosody_volume = f"+{(volume-1)*100:.2f}%" if volume > 1 else f"-{(1-volume)*100:.2f}%"
                    prosody_attrs['volume'] = prosody_volume
                if prosody_attrs:
                    prosody = ET.SubElement(express_as, 'prosody', attrib=prosody_attrs)
                    process_text_with_breaks(prosody, line.strip())
                else:
                    process_text_with_breaks(express_as, line.strip())
            else:
                prosody_attrs = {}
                if rate is not None and rate != 1.0:
                    prosody_rate = f"+{(rate-1)*100:.2f}%" if rate > 1 else f"-{(1-rate)*100:.2f}%"
                    prosody_attrs['rate'] = prosody_rate
                if pitch is not None and pitch != 1.0:
                    prosody_pitch = f"+{(pitch-1)*100:.2f}%" if pitch > 1 else f"-{(1-pitch)*100:.2f}%"
                    prosody_attrs['pitch'] = prosody_pitch
                if volume is not None and volume != 1.0:
                    prosody_volume = f"+{(volume-1)*100:.2f}%" if volume > 1 else f"-{(1-volume)*100:.2f}%"
                    prosody_attrs['volume'] = prosody_volume
                if prosody_attrs:
                    prosody = ET.SubElement(paragraph, 'prosody', attrib=prosody_attrs)
                    process_text_with_breaks(prosody, line.strip())
                else:
                    process_text_with_breaks(paragraph, line.strip())
        if multilingual:
            parent_tag.tail = "\n"
    return format_xml(ET.tostring(speak, encoding='unicode'))

def format_xml(xml_string):
    parsed = minidom.parseString(xml_string)
    pretty_xml_as_string = parsed.toprettyxml(indent="", newl="")
    pretty_xml_as_string = ''.join([line for line in pretty_xml_as_string.split('\n') if line.strip()])
    return pretty_xml_as_string


def update_status(status_tuple):
    """
    æ›´æ–°çŠ¶æ€ä¿¡æ¯ï¼š
    å¦‚æœ items["LangEnCheckBox"].Checked ä¸º Trueï¼Œåˆ™é€‰æ‹©è‹±æ–‡ï¼Œ
    å¦åˆ™é€‰æ‹©ä¸­æ–‡ã€‚
    """
    use_english = items["LangEnCheckBox"].Checked
    # å…ƒç»„ç´¢å¼• 0 ä¸ºè‹±æ–‡ï¼Œ1 ä¸ºä¸­æ–‡
    message = status_tuple[0] if use_english else status_tuple[1]
    items["StatusLabel"].Text = message
    items["minimaxStatusLabel"].Text = message
    

def synthesize_speech(service_region, speech_key, lang, voice_name, subtitle, rate, volume, style, style_degree, multilingual,pitch,audio_format, audio_output_config):
    speech_config = speechsdk.SpeechConfig(subscription=speech_key, region=service_region)
    speech_config.set_speech_synthesis_output_format(audio_format)
    ssml = create_ssml(lang=lang, voice_name=voice_name, text=subtitle, rate=rate, volume=volume, style=style, styledegree=style_degree,multilingual= multilingual,pitch=pitch)
    print(ssml)
    
    speech_synthesizer = speechsdk.SpeechSynthesizer(speech_config=speech_config, audio_config=audio_output_config)
    result = speech_synthesizer.speak_ssml_async(ssml).get()
    
    return result

def get_current_subtitle(current_timeline):
    frame_rate = float(current_timeline.GetSetting("timelineFrameRate"))
    current_timecode = current_timeline.GetCurrentTimecode()  
    current_frame = timecode_to_frames(current_timecode, frame_rate)

    track_count = current_timeline.GetTrackCount("subtitle")

    selected_subtitles = []
    for track_index in range(1, track_count + 1):
        items = current_timeline.GetItemListInTrack("subtitle", track_index)
        for item in items:
            start_frame = item.GetStart()
            end_frame = item.GetEnd()
            if start_frame is not None and end_frame is not None and start_frame <= current_frame <= end_frame:
                selected_subtitles.append(item)
    
    for subtitle in selected_subtitles:
        print(f"Start: {frame_to_timecode(subtitle.GetStart(), frame_rate)}")
        print(f"Start: {subtitle.GetStart()}")
        print(f"End: {frame_to_timecode(subtitle.GetEnd(), frame_rate)}")
        print(f"Duration: {subtitle.GetDuration()}")
        print(f"Text: {subtitle.GetName()}")  # å‡è®¾å­—å¹•æ–‡æœ¬æ˜¯é€šè¿‡ GetName() è·å–çš„
        print(subtitle.GetStart())
    if selected_subtitles:
        return selected_subtitles[0].GetName(), selected_subtitles[0].GetStart(), selected_subtitles[0].GetEnd()
    else:
        return None, current_frame, current_frame

def generate_filename(base_path, subtitle, extension):
    if not os.path.exists(base_path):
        os.makedirs(base_path)
    
    # å…ˆæŠŠæ¢è¡Œå»æ‰
    clean_subtitle = subtitle.replace('\n', ' ').replace('\r', ' ')
    # å†ç”¨æ­£åˆ™å»é™¤ Windows ä¸å…è®¸çš„å­—ç¬¦
    clean_subtitle = re.sub(r'[<>:"/\\|?*]', '', clean_subtitle)
    # ä¹Ÿå¯ä»¥æ§åˆ¶ä¸‹é•¿åº¦ï¼Œæ¯”å¦‚åªå–å‰ 15 æˆ– 30 ä¸ªå­—ç¬¦ç­‰
    clean_subtitle = clean_subtitle[:15]

    count = 0
    while True:
        count += 1
        filename = f"{base_path}/{clean_subtitle}#{count}{extension}"
        if not os.path.exists(filename):
            return filename

def edgetts_speech_synthesis( subtitle, voice_name, rate, pitch, volume, filename, start_frame, end_frame):
    update_status(STATUS_MESSAGES.synthesizing)   
    prosody_rate = f"+{int((rate-1)*100)}%" if rate > 1 else f"-{int((1-rate)*100)}%"
    prosody_pitch = f"+{int((pitch-1)*100)}Hz" if pitch > 1 else f"-{int((1-pitch)*100)}Hz"
    prosody_volume = f"+{int((volume-1)*100)}%" if volume > 1 else f"-{int((1-volume)*100)}%"
    print(f"Voice Name: {voice_name}")
    print(f"Prosody Rate: {prosody_rate}")
    print(f"Prosody Pitch: {prosody_pitch}")
    print(f"Prosody Volume: {prosody_volume}")
    try:
        communicate = edge_tts.Communicate(subtitle, voice_name, rate=prosody_rate, volume=prosody_volume,pitch=prosody_pitch)
        communicate.save_sync(filename)
        time.sleep(1)
        add_to_media_pool_and_timeline(start_frame, end_frame, filename)
        update_status(STATUS_MESSAGES.loaded_to_timeline)
    except ValueError as ve:
        print(f"ValueError: {ve}")
        update_status(STATUS_MESSAGES.synthesis_failed)
    except edge_tts.exceptions.HTTPError as he:
        print(f"HTTPError: {he}")
        update_status(STATUS_MESSAGES.synthesis_failed)
    except Exception as e:
        print(f"Unexpected error: {e}")
        update_status(STATUS_MESSAGES.synthesis_failed)

def on_fromsub_button_clicked(ev):
    current_timeline = current_project.GetCurrentTimeline()
    if not current_timeline:
        show_warning_message(STATUS_MESSAGES.create_timeline)
        return
    if items["Path"].Text == '':
        show_warning_message(STATUS_MESSAGES.select_save_path)
        return
    global subtitle,stream,flag
    subtitle,start_frame, end_frame = get_current_subtitle(current_timeline)
    items['AzureTxt'].PlainText = subtitle
    extension = ".mp3" if azure_items["UnuseAPICheckBox"].Checked else items["OutputFormatCombo"].CurrentText.split(", ")[1]
    filename = generate_filename(items["Path"].Text, subtitle, extension)
    #print(filename)
    voice_name = return_voice_name(items["NameCombo"].CurrentText)
    rate = items["RateSpinBox"].Value
    pitch = items["PitchSpinBox"].Value
    volume = items["VolumeSpinBox"].Value
    if azure_items["UnuseAPICheckBox"].Checked:
        edgetts_speech_synthesis( subtitle, voice_name, rate, pitch, volume, filename, start_frame, end_frame)
        return
    if azure_items["ApiKey"].Text == '' or azure_items["Region"].Text == '':
        show_warning_message(STATUS_MESSAGES.enter_api_key)
        update_status(STATUS_MESSAGES.synthesis_failed)
        return
    update_status(STATUS_MESSAGES.synthesizing)
    service_region = azure_items["Region"].Text
    speech_key = azure_items["ApiKey"].Text
    style = get_original_style(items["StyleCombo"].CurrentText)
    style_degree = items["StyleDegreeSpinBox"].Value
    multilingual = items["MultilingualCombo"].CurrentText if items["MultilingualCombo"].CurrentText in lang_translation else next((k for k, v in lang_translation.items() if v == items["MultilingualCombo"].CurrentText), None)
    output_format = items["OutputFormatCombo"].CurrentText
    if output_format in audio_formats:
        audio_format = audio_formats[output_format]
    else:
        show_warning_message(STATUS_MESSAGES.unsupported_audio)
        return

    audio_output_config = speechsdk.audio.AudioOutputConfig(filename=filename)
    
    result = synthesize_speech(service_region, speech_key, lang, voice_name, subtitle, rate,volume, style, style_degree, multilingual,pitch,audio_format, audio_output_config)
    
    if result.reason == speechsdk.ResultReason.SynthesizingAudioCompleted:
        time.sleep(1)
        add_to_media_pool_and_timeline(start_frame, end_frame, filename)
        flag = False
    elif result.reason == speechsdk.ResultReason.Canceled:
        cancellation_details = result.cancellation_details
        update_status(STATUS_MESSAGES.synthesis_failed)
        print("Speech synthesis canceled: {}".format(cancellation_details.reason))
        if cancellation_details.reason == speechsdk.CancellationReason.Error:
            print("Error details: {}".format(cancellation_details.error_details))

win.On.FromSubButton.Clicked = on_fromsub_button_clicked

def on_fromtxt_button_clicked(ev):
    current_timeline = current_project.GetCurrentTimeline()
    if not current_timeline:
        show_warning_message(STATUS_MESSAGES.create_timeline)
        return
    if items["Path"].Text == '':
        show_warning_message(STATUS_MESSAGES.select_save_path)
        return
    global subtitle,stream,flag
    subtitle = items["AzureTxt"].PlainText
    extension = ".mp3" if azure_items["UnuseAPICheckBox"].Checked else items["OutputFormatCombo"].CurrentText.split(", ")[1]
    filename = generate_filename(items["Path"].Text, subtitle, extension)
    #print(filename)
    voice_name = return_voice_name(items["NameCombo"].CurrentText)
    rate = items["RateSpinBox"].Value
    pitch = items["PitchSpinBox"].Value
    volume = items["VolumeSpinBox"].Value
    if azure_items["UnuseAPICheckBox"].Checked:
        frame_rate = float(current_timeline.GetSetting("timelineFrameRate"))
        current_timecode = current_timeline.GetCurrentTimecode()  
        current_frame = timecode_to_frames(current_timecode, frame_rate)
        edgetts_speech_synthesis( subtitle, voice_name, rate, pitch, volume, filename, current_frame, current_timeline.GetEndFrame())
        return
    if azure_items["ApiKey"].Text == '' or azure_items["Region"].Text == '':
        show_warning_message(STATUS_MESSAGES.enter_api_key)
        update_status(STATUS_MESSAGES.synthesis_failed)
        return
    print(f"stream:{stream}")
    if stream and flag:
        stream.save_to_wav_file(filename)
        time.sleep(1)
        frame_rate = float(current_timeline.GetSetting("timelineFrameRate"))
        current_timecode = current_timeline.GetCurrentTimecode()  
        current_frame = timecode_to_frames(current_timecode, frame_rate)
        add_to_media_pool_and_timeline(current_frame, current_timeline.GetEndFrame(), filename)
        flag = False
        stream =None
    elif not stream and flag:
        update_status(STATUS_MESSAGES.synthesizing)
        service_region = azure_items["Region"].Text
        speech_key = azure_items["ApiKey"].Text
        style = get_original_style(items["StyleCombo"].CurrentText)
        style_degree = items["StyleDegreeSpinBox"].Value
        multilingual = items["MultilingualCombo"].CurrentText if items["MultilingualCombo"].CurrentText in lang_translation else next((k for k, v in lang_translation.items() if v == items["MultilingualCombo"].CurrentText), None)
        output_format = items["OutputFormatCombo"].CurrentText
        if output_format in audio_formats:
            audio_format = audio_formats[output_format]
        else:
            show_warning_message(STATUS_MESSAGES.unsupported_audio)
            return

        audio_output_config = speechsdk.audio.AudioOutputConfig(filename=filename)
        
        result = synthesize_speech(service_region, speech_key, lang, voice_name, subtitle, rate,volume, style, style_degree, multilingual,pitch,audio_format, audio_output_config)
        
        if result.reason == speechsdk.ResultReason.SynthesizingAudioCompleted:
            time.sleep(1)
            frame_rate = float(current_timeline.GetSetting("timelineFrameRate"))
            current_timecode = current_timeline.GetCurrentTimecode()  
            current_frame = timecode_to_frames(current_timecode, frame_rate)
            add_to_media_pool_and_timeline(current_frame, current_timeline.GetEndFrame(), filename)
            flag = False
        elif result.reason == speechsdk.ResultReason.Canceled:
            cancellation_details = result.cancellation_details
            update_status(STATUS_MESSAGES.synthesis_failed)
            print("Speech synthesis canceled: {}".format(cancellation_details.reason))
            if cancellation_details.reason == speechsdk.CancellationReason.Error:
                print("Error details: {}".format(cancellation_details.error_details))
    else:
        update_status(STATUS_MESSAGES.media_clip_exists)
    
win.On.FromTxtButton.Clicked = on_fromtxt_button_clicked

def on_play_button_clicked(ev):
    if items["Path"].Text == '':
        show_warning_message(STATUS_MESSAGES.select_save_path)
        return
    if azure_items["ApiKey"].Text == '' or azure_items["Region"].Text == '':
        show_warning_message(STATUS_MESSAGES.enter_api_key)
        return
    update_status(STATUS_MESSAGES.playing)
    items["PlayButton"].Enabled = False
    global subtitle, ssml, stream 
    service_region = azure_items["Region"].Text
    speech_key = azure_items["ApiKey"].Text
    style = get_original_style(items["StyleCombo"].CurrentText)
    style_degree = items["StyleDegreeSpinBox"].Value
    subtitle = items["AzureTxt"].PlainText
    rate = items["RateSpinBox"].Value
    pitch = items["PitchSpinBox"].Value
    volume = items["VolumeSpinBox"].Value
    multilingual = items["MultilingualCombo"].CurrentText if items["MultilingualCombo"].CurrentText in lang_translation else next((k for k, v in lang_translation.items() if v == items["MultilingualCombo"].CurrentText), None)
    voice_name = return_voice_name(items["NameCombo"].CurrentText)
    output_format = items["OutputFormatCombo"].CurrentText
    if output_format in audio_formats:
        audio_format = audio_formats[output_format]
    else:
        show_warning_message(STATUS_MESSAGES.unsupported_audio)
        return

    audio_output_config = speechsdk.audio.AudioOutputConfig(use_default_speaker=True)
    
    result = synthesize_speech(service_region, speech_key, lang, voice_name, subtitle, rate, volume, style, style_degree, multilingual,pitch,audio_format, audio_output_config)
    stream = speechsdk.AudioDataStream(result)
    if result.reason == speechsdk.ResultReason.SynthesizingAudioCompleted:
        flagmark()
        update_status(STATUS_MESSAGES.reset_status)
    elif result.reason == speechsdk.ResultReason.Canceled:
        cancellation_details = result.cancellation_details
        update_status(STATUS_MESSAGES.synthesis_failed)
        print("Speech synthesis canceled: {}".format(cancellation_details.reason))
        if cancellation_details.reason == speechsdk.CancellationReason.Error:
            print("Error details: {}".format(cancellation_details.error_details))
            
    items["PlayButton"].Enabled = True  

win.On.PlayButton.Clicked = on_play_button_clicked

def play_audio_segment(pcm_file, json_file, voice_name, sample_rate=32000, channels=2, sample_width=2):
    try:
        # è¯»å– JSON æ–‡ä»¶
        with open(json_file, 'r', encoding='utf-8') as f:
            voice_data = json.load(f)
        
        # æ£€æŸ¥å£°éŸ³åç§°æ˜¯å¦å­˜åœ¨
        if voice_name not in voice_data:
            raise ValueError(f"éŸ³è‰² '{voice_name}' ä¸å­˜åœ¨äº JSON æ–‡ä»¶ä¸­ã€‚")
        
        # è·å–éŸ³é¢‘ç‰‡æ®µèµ·æ­¢ä½ç½®
        start, end = voice_data[voice_name]["start"], voice_data[voice_name]["end"]
        
        # ä» PCM æ–‡ä»¶ä¸­è¯»å–å¯¹åº”ç‰‡æ®µ
        with open(pcm_file, 'rb') as pcm_in:
            pcm_in.seek(start)
            data = pcm_in.read(end - start + 1)
        
        # å°† PCM æ•°æ®è½¬åŒ–ä¸º WAV æ ¼å¼
        wav_file = f"{voice_name}_temp.wav"
        print(wav_file)
        with wave.open(wav_file, 'wb') as wav_out:
            wav_out.setnchannels(channels)
            wav_out.setsampwidth(sample_width)
            wav_out.setframerate(sample_rate)
            wav_out.writeframes(data)
        
        # ä½¿ç”¨ç³»ç»Ÿå‘½ä»¤æ’­æ”¾éŸ³é¢‘
        if os.name == 'nt':  # Windows ç³»ç»Ÿ
            import winsound
            winsound.PlaySound(wav_file, winsound.SND_FILENAME)

        else:  # Linux/Unix æˆ– macOS
            subprocess.run(['afplay', wav_file], check=True)

        # åˆ é™¤ä¸´æ—¶ WAV æ–‡ä»¶
        time.sleep(1)  # ç­‰å¾…1ç§’é’Ÿ
        os.remove(wav_file)
        print(f"æ’­æ”¾å®Œæˆ: {voice_name}")
    
    except Exception as e:
        os.remove(wav_file)
        print(f"æ’­æ”¾å¤±è´¥: {e}")

def on_minimax_preview_button_click(ev):
    try:
        # è¯·ç¡®ä¿æ–‡ä»¶è·¯å¾„æ­£ç¡®
        pcm_file = os.path.join(script_path, "minimax_voice_data.pcm")  # æ‹¼æ¥å®Œæ•´è·¯å¾„
        json_file = os.path.join(script_path, "minimax_voice_data.json")
        # æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
        if not os.path.exists(pcm_file):
            show_warning_message(STATUS_MESSAGES.download_pcm)
            return
        if not os.path.exists(json_file):
            show_warning_message(STATUS_MESSAGES.download_json)
            return
        voice_name = items["minimaxVoiceCombo"].CurrentText  # ç›®æ ‡éŸ³è‰²
        voice_id = next((cn for cn, en in minimax_voices if voice_name in (cn, en)), "")
        # æ’­æ”¾éŸ³é¢‘
        play_audio_segment(pcm_file, json_file, voice_id)

    except Exception as e:
        print(f"æ’­æ”¾å¤±è´¥: {e}")
win.On.minimaxPreviewButton.Clicked = on_minimax_preview_button_click

def process_minimax_request(text_func, timeline_func):
    """
    é€šç”¨å¤„ç†å‡½æ•°ï¼Œç”¨äº Minimax è¯·æ±‚å’ŒéŸ³é¢‘å¤„ç†
    :param text_func: å‡½æ•°ï¼Œè¿”å›æ–‡æœ¬å†…å®¹
    :param timeline_func: å‡½æ•°ï¼Œè¿”å› (start_frame, end_frame) æ—¶é—´çº¿å¸§ä¿¡æ¯
    """
    # è·å–è¾“å…¥å­—æ®µçš„å€¼
    if minimax_items["minimaxGroupID"].Text == '' or minimax_items["minimaxApiKey"].Text == '':
        show_warning_message(STATUS_MESSAGES.enter_api_key)
        update_status(STATUS_MESSAGES.synthesis_failed)
        return
    group_id = minimax_items["minimaxGroupID"].Text
    api_key = minimax_items["minimaxApiKey"].Text
    model = items["minimaxModelCombo"].CurrentText
    text = text_func()
    if minimax_items["intlCheckBox"].Checked:
        url = f"https://api.minimaxi.chat/v1/t2a_v2?GroupId={group_id}"
    else:
        url = f"https://api.minimax.chat/v1/t2a_v2?GroupId={group_id}"
    
    # è·å– voice_id å’Œ emotion
    voice_name = items["minimaxVoiceCombo"].CurrentText
    voice_id = next((en for cn, en in minimax_voices if voice_name in (cn, en)), "")
    lang_name = items["minimaxLanguageCombo"].CurrentText
    lang_id = next((en for cn, en in minimax_language if lang_name in (cn, en)), "")
    emotion_name = items["minimaxEmotionCombo"].CurrentText
    emotion_value = next((en for cn, en in emotions if emotion_name in (cn, en)), "")
    
    # å…¶ä»–å‚æ•°
    speed = items["minimaxRateSpinBox"].Value
    vol = items["minimaxVolumeSpinBox"].Value
    pitch = items["minimaxPitchSpinBox"].Value
    subtitle_enable = items["minimaxSubtitleCheckBox"].Checked
    sample_rate = 32000
    bitrate = 128000
    channel = 2
    file_format = items["minimaxFormatCombo"].CurrentText

    # æ„å»ºè¯·æ±‚çš„Payload
    payload = {
        "model": model,
        "text": text,
        "stream": False,
        "subtitle_enable":subtitle_enable,
        "language_boost":lang_id,
        "voice_setting": {
            "voice_id": voice_id,
            "speed": speed,
            "vol": vol,
            "pitch": pitch
        },
        "audio_setting": {
            "sample_rate": sample_rate,
            "bitrate": bitrate,
            "format": file_format,
            "channel": channel
        }
    }

    # å¦‚æœ emotion ä¸ä¸ºç©ºï¼Œæ·»åŠ åˆ° voice_setting ä¸­
    if emotion_value not in ["é»˜è®¤", "Default"]:
        payload["voice_setting"]["emotion"] = emotion_value

    # è½¬æ¢ä¸º JSON æ ¼å¼
    payload_json = json.dumps(payload)

    headers = {
        'Authorization': f'Bearer {api_key}',
        'Content-Type': 'application/json'
    }

    print(payload)
    update_status(STATUS_MESSAGES.synthesizing)

    try:
        response = requests.post(url, headers=headers, data=payload_json)
        #print("å“åº”çŠ¶æ€ç :", response.status_code)

        response.raise_for_status()
        parsed_json = response.json()
    
        data = parsed_json.get("data")
        if not data:
            update_status(STATUS_MESSAGES.synthesis_failed)
            print("å“åº”ä¸­æœªåŒ…å« 'data' å­—æ®µ:", parsed_json)
        else:
            # å¤„ç†éŸ³é¢‘æ•°æ®
            audio_data = bytes.fromhex(data.get("audio", ""))
            filename = generate_filename(items["Path"].Text, text, f".{file_format}")
            print(filename)
        
            with open(filename, 'wb') as f:
                f.write(audio_data)
            #print(f"éŸ³é¢‘å·²ä¿å­˜åˆ° {filename}")
        
            if os.path.exists(filename):
                start_frame, end_frame = timeline_func()
                add_to_media_pool_and_timeline(start_frame, end_frame, filename)
                #print(f"æˆåŠŸå°†æ–‡ä»¶æ·»åŠ åˆ°åª’ä½“æ± : {filename}")
            else:
                update_status(STATUS_MESSAGES.audio_save_failed)
                print("éŸ³é¢‘æ–‡ä»¶ä¿å­˜å¤±è´¥")
        
            # ä¸‹è½½å­—å¹•æ–‡ä»¶åŠè½¬æ¢ä¸º SRT
            subtitle_url = data.get("subtitle_file")
            if subtitle_url:
                #print("å­—å¹•æ–‡ä»¶URL:", subtitle_url)
                try:
                    subtitle_response = requests.get(subtitle_url)
                    subtitle_response.raise_for_status()  # æ£€æŸ¥å“åº”çŠ¶æ€
                
                    subtitle_filename = os.path.splitext(filename)[0] + ".json"
                    with open(subtitle_filename, 'wb') as f:
                        f.write(subtitle_response.content)
                    #print(f"å­—å¹•æ–‡ä»¶å·²ä¿å­˜åˆ° {subtitle_filename}")

                    # è¯»å– JSON å¹¶è½¬æ¢ä¸º SRT æ ¼å¼
                    with open(subtitle_filename, 'r', encoding='utf-8') as f:
                        json_data = json.load(f)
                    srt_filename = os.path.splitext(subtitle_filename)[0] + ".srt"
                    json_to_srt(json_data, srt_filename)
                    # æˆåŠŸç”Ÿæˆ SRT åï¼Œåˆ é™¤ JSON æ–‡ä»¶
                    os.remove(subtitle_filename)
                except Exception as e:
                    print(f"å­—å¹•å¤„ç†å‡ºé”™: {e}")
            else:
             print("å“åº”ä¸­æœªåŒ…å« 'subtitle_file' å­—æ®µ")
            
    except requests.exceptions.RequestException as e:
        print(f"è¯·æ±‚å¤±è´¥: {e}")
        update_status(STATUS_MESSAGES.synthesis_failed)
    except json.JSONDecodeError as e:
        update_status(STATUS_MESSAGES.synthesis_failed)
        print(f"JSONè§£æå¤±è´¥: {e}")
    except KeyError as e:
        update_status(STATUS_MESSAGES.synthesis_failed)
        print(f"å“åº”ä¸­ç¼ºå°‘å…³é”®å­—æ®µ: {e}")



def json_to_srt(json_data, srt_path):
    """
    å°†JSONæ ¼å¼çš„å­—å¹•ä¿¡æ¯è½¬æ¢ä¸º .srt æ–‡ä»¶å¹¶ä¿å­˜ã€‚
    """
    srt_output = []
    subtitle_id = 1
    frame_rate = float(current_timeline.GetSetting("timelineFrameRate"))
    for item in json_data:
        text = item["text"]
        # ç§»é™¤å¯èƒ½å‡ºç°çš„ BOM
        if text.startswith("\ufeff"):
            text = text[1:]
        start_time = frame_to_timecode(item["time_begin"] / 1000,1)
        end_time = frame_to_timecode(item["time_end"] / 1000,1)
        srt_output.append(f"{subtitle_id}")
        srt_output.append(f"{start_time} --> {end_time}")
        srt_output.append(text)
        srt_output.append("")
        subtitle_id += 1
    try:
        with open(srt_path, 'w', encoding='utf-8') as file:
            file.write("\n".join(srt_output))
        print(f"SRT æ–‡ä»¶å·²ä¿å­˜ï¼š{srt_path}")
    except Exception as e:
        print(f"ä¿å­˜ SRT æ–‡ä»¶å¤±è´¥: {e}")

# é’ˆå¯¹å­—å¹•çš„å¤„ç†å‡½æ•°
def on_minimax_fromsub_button_clicked(ev):
    project_manager = resolve.GetProjectManager()
    current_project = project_manager.GetCurrentProject()
    current_timeline = current_project.GetCurrentTimeline()
    if not current_timeline:
        show_warning_message(STATUS_MESSAGES.create_timeline)
        return
    if items["Path"].Text == '':
        show_warning_message(STATUS_MESSAGES.select_save_path)
        return
    items["minimaxSubtitleCheckBox"].Checked = False
    process_minimax_request(
        text_func=lambda: get_current_subtitle(current_timeline)[0],
        timeline_func=lambda: get_current_subtitle(current_timeline)[1:]
    )
win.On.minimaxFromSubButton.Clicked = on_minimax_fromsub_button_clicked

# é’ˆå¯¹æ–‡æœ¬æ¡†è¾“å…¥çš„å¤„ç†å‡½æ•°
def on_minimax_fromtxt_button_clicked(ev):
    project_manager = resolve.GetProjectManager()
    current_project = project_manager.GetCurrentProject()
    current_timeline = current_project.GetCurrentTimeline()
    if not current_timeline:
        show_warning_message(STATUS_MESSAGES.create_timeline)
        return
    if items["Path"].Text == '':
        show_warning_message(STATUS_MESSAGES.select_save_path)
        return
    process_minimax_request(
        text_func=lambda: items["minimaxText"].PlainText,
        timeline_func=lambda: (
            # åŠ¨æ€è·å–å½“å‰å¸§å’Œæ—¶é—´çº¿ç»“æŸå¸§
            timecode_to_frames(
                current_timeline.GetCurrentTimecode(),
                float(current_timeline.GetSetting("timelineFrameRate"))
            ),
            current_timeline.GetEndFrame()
        )
    )
win.On.minimaxFromTxtButton.Clicked = on_minimax_fromtxt_button_clicked

def on_break_button_clicked(ev):
    breaktime =  items["BreakSpinBox"].Value
    # æ’å…¥<break>æ ‡å¿—
    items["AzureTxt"].InsertPlainText(f'<break time="{breaktime}ms" />')

win.On.BreakButton.Clicked = on_break_button_clicked

def on_minimax_break_button_clicked(ev):
    breaktime =  items["minimaxBreakSpinBox"].Value/1000
    # æ’å…¥<break>æ ‡å¿—
    items["minimaxText"].InsertPlainText(f'<#{breaktime}#>')

win.On.minimaxBreakButton.Clicked = on_minimax_break_button_clicked

def show_warning_message(status_tuple):
    use_english = items["LangEnCheckBox"].Checked
    # å…ƒç»„ç´¢å¼• 0 ä¸ºè‹±æ–‡ï¼Œ1 ä¸ºä¸­æ–‡
    message = status_tuple[0] if use_english else status_tuple[1]
    msgbox = dispatcher.AddWindow(
        {
            "ID": 'msg',
            "WindowTitle": 'Warning',
            "Geometry": [750, 400, 350, 100],
            "Spacing": 10,
        },
        [
            ui.VGroup(
                [
                    ui.Label({"ID": 'WarningLabel', "Text": message}),
                    ui.HGroup(
                        {
                            "Weight": 0,
                        },
                        [
                            ui.Button({"ID": 'OkButton', "Text": 'OK'}),
                        ]
                    ),
                ]
            ),
        ]
    )

    def on_ok_button_clicked(ev):
        dispatcher.ExitLoop()
    msgbox.On.OkButton.Clicked = on_ok_button_clicked

    msgbox.Show()
    dispatcher.RunLoop()
    msgbox.Hide()
    
def on_alphabet_button_clicked(ev):
    items["AzureTxt"].Copy()
    from pypinyin import pinyin, Style

    def convert_to_pinyin_with_tone(text):
        pinyin_list = pinyin(text, style=Style.TONE3, heteronym=False)
        pinyin_with_tone = []

        for word in pinyin_list:
            if word[0][-1].isdigit():  # å¦‚æœæœ€åä¸€ä¸ªå­—ç¬¦æ˜¯æ•°å­—ï¼ˆå£°è°ƒï¼‰
                pinyin_with_tone.append(f"{word[0][:-1]} {word[0][-1]}")
            else:  # å¦åˆ™ï¼Œè¡¨ç¤ºæ˜¯è½»å£°
                pinyin_with_tone.append(f"{word[0]} 5")
        
        return ' '.join(pinyin_with_tone)

    alphabet = dispatcher.AddWindow(
        {
            "ID": 'Alphabet',
            "WindowTitle": 'å¤šéŸ³å­—',
            "Geometry": [750, 400, 500, 150],
            "Spacing": 10,
        },
        [   
            ui.VGroup(
                [
                    ui.HGroup(
                        {"Weight": 1},
                        [
                            ui.LineEdit({"ID": 'AlphaTxt', "Text": ""}),
                        ]
                    ),
                    ui.HGroup(
                        {"Weight": 0},
                        [
                            ui.Label({"ID": 'msgLabel', "Text": """ä¾‹å¦‚ï¼Œ'li 4 zi 5' è¡¨ç¤º 'ä¾‹å­'ã€‚æ•°å­—ä»£è¡¨æ‹¼éŸ³å£°è°ƒã€‚'5' ä»£è¡¨è½»å£°ã€‚\nè‹¥è¦æ§åˆ¶å„¿åŒ–éŸ³ï¼Œè¯·åœ¨æ‹¼éŸ³çš„å£°è°ƒå‰æ’å…¥ "r"ã€‚ä¾‹å¦‚ï¼Œ"hou r 2 shan 1" ä»£è¡¨â€œçŒ´å„¿å±±â€ã€‚"""}),
                        ]
                    ),
                    ui.HGroup(
                        {
                            "Weight": 0,
                        },
                        [
                            ui.Button({"ID": 'OkButton', "Text": 'OK'}),
                        ]
                    ),
                ]
            ),
        ]
    )

    ahb = alphabet.GetItems()
    ahb["AlphaTxt"].Text =  ahb["AlphaTxt"].Paste()
    original_text = ahb["AlphaTxt"].Text
    convert_test= convert_to_pinyin_with_tone(re.sub(r'[^\u4e00-\u9fa5]', '', original_text))
    ahb["AlphaTxt"].Text = convert_test

    def on_ok_button_clicked(ev):
        replace_text = ahb["AlphaTxt"].Text
        replace_text = '' if replace_text == '' else (original_text if replace_text == convert_test else f"<phoneme alphabet=\"sapi\" ph=\"{ahb['AlphaTxt'].Text}\">{original_text}</phoneme>")
        items["AzureTxt"].InsertPlainText(replace_text)
        dispatcher.ExitLoop()
        
    alphabet.On.OkButton.Clicked = on_ok_button_clicked
    def on_close(ev):
        dispatcher.ExitLoop()
    alphabet.On.Alphabet.Close = on_close
    alphabet.Show()
    dispatcher.RunLoop()
    alphabet.Hide()

win.On.AlphabetButton.Clicked = on_alphabet_button_clicked

def on_reset_button_clicked(ev):
    #items["ApiKey"].Text = default_settings["API_KEY"]
    #items["Path"].Text = default_settings["OUTPUT_DIRECTORY"]
    #items["Region"].Text = default_settings["REGION"]
    items["LanguageCombo"].CurrentIndex = default_settings["LANGUAGE"]
    items["NameTypeCombo"].CurrentIndex = default_settings["TYPE"]
    items["NameCombo"].CurrentIndex = default_settings["NAME"]
    items["RateSpinBox"].Value = default_settings["RATE"]
    items["BreakSpinBox"].Value = default_settings["BREAKTIME"]
    items["PitchSpinBox"].Value = default_settings["PITCH"]
    items["VolumeSpinBox"].Value = default_settings["VOLUME"]
    items["StyleCombo"].CurrentIndex = default_settings["STYLE"]
    items["StyleDegreeSpinBox"].Value = default_settings["STYLEDEGREE"]
    items["OutputFormatCombo"].CurrentIndex = default_settings["OUTPUT_FORMATS"]

win.On.ResetButton.Clicked = on_reset_button_clicked

def on_minimax_reset_button_clicked(ev):
    """
    é‡ç½®æ‰€æœ‰è¾“å…¥æ§ä»¶ä¸ºé»˜è®¤è®¾ç½®ã€‚
    """
    # å°†æ§ä»¶å€¼é‡ç½®ä¸ºé»˜è®¤è®¾ç½®
    #items["minimaxApiKey"].Text = default_settings["minimax_API_KEY"]
    #items["minimaxGroupID"].Text = default_settings["minimax_GROUP_ID"]
    #items["Path"].Text = default_settings["Path"]
    items["minimaxModelCombo"].CurrentIndex = default_settings["minimax_Model"]
    items["minimaxVoiceCombo"].CurrentIndex = default_settings["minimax_Voice"]
    items["minimaxLanguageCombo"].CurrentIndex = default_settings["minimax_Language"]
    items["minimaxEmotionCombo"].CurrentIndex = default_settings["minimax_Emotion"]
    items["minimaxRateSpinBox"].Value = default_settings["minimax_Rate"]
    items["minimaxVolumeSpinBox"].Value = default_settings["minimax_Volume"]
    items["minimaxPitchSpinBox"].Value = default_settings["minimax_Pitch"]
    items["minimaxFormatCombo"].SetCurrentText(default_settings["minimax_Format"])
    items["minimaxBreakSpinBox"].Value = default_settings["minimax_Break"]
    items["minimaxSubtitleCheckBox"].Checked = default_settings["minimax_SubtitleCheckBox"]

# ç»‘å®šé‡ç½®æŒ‰é’®äº‹ä»¶
win.On.minimaxResetButton.Clicked = on_minimax_reset_button_clicked

def on_browse_button_clicked(ev):
    current_path = items["Path"].Text
    selected_path = fusion.RequestDir(current_path)
    if selected_path:
        # åˆ›å»ºä»¥é¡¹ç›®åç§°å‘½åçš„å­ç›®å½•
        project_subdir = os.path.join(selected_path, f"{current_project.GetName()}_TTS")
        try:
            os.makedirs(project_subdir, exist_ok=True)
            items["Path"].Text = str(project_subdir)
            print(f"Directory created: {project_subdir}")
        except Exception as e:
            print(f"Failed to create directory: {e}")
    else:
        print("No directory selected or the request failed.")

win.On.Browse.Clicked = on_browse_button_clicked

def close_and_save(settings_file):
    settings = {
        "API_KEY": azure_items["ApiKey"].Text,
        "REGION": azure_items["Region"].Text,
        "OUTPUT_DIRECTORY": items["Path"].Text,
        "LANGUAGE": items["LanguageCombo"].CurrentIndex,
        "TYPE": items["NameTypeCombo"].CurrentIndex,
        "NAME": items["NameCombo"].CurrentIndex,
        "RATE": items["RateSpinBox"].Value,
        "PITCH": items["PitchSpinBox"].Value,
        "VOLUME": items["VolumeSpinBox"].Value,
        "STYLEDEGREE": items["StyleDegreeSpinBox"].Value,
        "OUTPUT_FORMATS": items["OutputFormatCombo"].CurrentIndex,
        "UNUSE_API":azure_items["UnuseAPICheckBox"].Checked,

        "minimax_API_KEY": minimax_items["minimaxApiKey"].Text,
        "minimax_GROUP_ID": minimax_items["minimaxGroupID"].Text,
        "minimax_intlCheckBox":minimax_items["intlCheckBox"].Checked,
        "Path": items["Path"].Text,
        "minimax_Model": items["minimaxModelCombo"].CurrentIndex,
        #"Text": items["minimaxText"].PlainText,
        "minimax_Voice": items["minimaxVoiceCombo"].CurrentIndex,
        "minimax_Language": items["minimaxLanguageCombo"].CurrentIndex,
        "minimax_SubtitleCheckBox":items["minimaxSubtitleCheckBox"].Checked,
        "minimax_Emotion": items["minimaxEmotionCombo"].CurrentIndex,
        "minimax_Rate": items["minimaxRateSpinBox"].Value,
        "minimax_Volume": items["minimaxVolumeSpinBox"].Value,
        "minimax_Pitch": items["minimaxPitchSpinBox"].Value,
        "minimax_Format": items["minimaxFormatCombo"].CurrentText,
        "minimax_Break":items["minimaxBreakSpinBox"].Value,

        "CN":items["LangCnCheckBox"].Checked,
        "EN":items["LangEnCheckBox"].Checked,
        
    }

    save_settings(settings, settings_file)


def on_open_link_button_clicked(ev):
    if items["LangEnCheckBox"].Checked :
        webbrowser.open("https://ko-fi.com/heiba")
    else :
        webbrowser.open("https://mp.weixin.qq.com/s?__biz=MzUzMTk2MDU5Nw==&mid=2247484626&idx=1&sn=e5eef7e48fbfbf37f208ed9a26c5475a&chksm=fabbc2a8cdcc4bbefcb7f6c72a3754335c25ec9c3e408553ec81c009531732e82cbab923276c#rd")
win.On.OpenLinkButton.Clicked = on_open_link_button_clicked

def on_minimax_register_link_button_clicked(ev):
    if minimax_items["intlCheckBox"].Checked:
        url= "https://intl.minimaxi.com/login"
    else:
        url = "https://platform.minimaxi.com/registration"
        
    webbrowser.open(url)
minimax_config_window.On.minimaxRegisterButton.Clicked = on_minimax_register_link_button_clicked

def on_azure_register_link_button_clicked(ev):
    url = "https://speech.microsoft.com/portal/voicegallery"
    webbrowser.open(url)
azure_config_window.On.AzureRegisterButton.Clicked = on_azure_register_link_button_clicked

def on_show_azure(ev):
    azure_config_window.Show()
win.On.ShowAzure.Clicked = on_show_azure

def on_show_minimax(ev):
    minimax_config_window.Show()
win.On.ShowMiniMax.Clicked = on_show_minimax

# Azureé…ç½®çª—å£æŒ‰é’®äº‹ä»¶
def on_azure_confirm(ev):
    print("Azure API é…ç½®å®Œæˆ")
    azure_config_window.Hide()
azure_config_window.On.AzureConfirm.Clicked = on_azure_confirm

def on_azure_confirm_close(ev):
    azure_config_window.Hide()
azure_config_window.On.AzureConfigWin.Close = on_azure_confirm_close

# MiniMaxé…ç½®çª—å£æŒ‰é’®äº‹ä»¶
def on_minimax_confirm(ev):
    print("MiniMax API é…ç½®å®Œæˆ")
    minimax_config_window.Hide()
minimax_config_window.On.MiniMaxConfirm.Clicked = on_minimax_confirm

def on_minimax_confirm_close(ev):
    minimax_config_window.Hide()
minimax_config_window.On.MiniMaxConfigWin.Close = on_minimax_confirm_close

def on_close(ev):
    close_and_save(settings_file)
    dispatcher.ExitLoop()
win.On.MainWin.Close = on_close



win.Show()
dispatcher.RunLoop()
azure_config_window.Hide()
minimax_config_window.Hide()
win.Hide()
